import{aJ as Q,m as y,z as M,o as T,c as l,d as g,w as b,f as m,g as v,ac as n,e as s,y as z,ah as x,Q as w,j as $,ad as B,h as f}from"./index.7d370b68.js";import{u as I,a as L,Q as S,P as R,T as U}from"./TagList.c47b4c44.js";import{Q as V}from"./QImg.c1878d72.js";import{Q as C}from"./QPage.33970ec2.js";import{_ as D}from"./plugin-vue_export-helper.21dcd24c.js";import"./QChip.73d90e1c.js";import"./QTooltip.bb072c3f.js";import"./position-engine.0d968b18.js";import"./selection.af76a41f.js";const H={class:"container q-mx-auto",style:{"max-width":"900px"}},N={key:0,class:"flex flex-center q-pa-xl"},A={key:2},j={class:"q-mb-lg"},E={class:"text-h3 q-mb-md"},G={key:1,class:"q-mb-lg"},J=["innerHTML"],O=["innerHTML"],Y={class:"q-mt-xl"},F={key:3,class:"text-center q-pa-xl"},K={__name:"BlogDetailPage",setup(W){const _=Q(),u=I(),t=y(()=>u.post);y(()=>{var o;if(!((o=t.value)!=null&&o.content))return!1;const e=t.value.content.toLowerCase();return e.includes("youtube.com")||e.includes("youtu.be")});const k=e=>{const o=[/(?:youtube\.com\/watch\?v=|youtu\.be\/|youtube\.com\/embed\/)([^&\s?#]+)/i,/youtube\.com\/.*[?&]v=([^&\s?#]+)/i];for(const p of o){const r=e.match(p);if(r&&r[1])return r[1]}return null},q=y(()=>{var p;if(!((p=t.value)!=null&&p.content))return"";let{content:e}=t.value;if(e.includes("youtube-embed-wrapper"))return e;e=e.replace(/<a([^>]*href=["']([^"']*(?:youtube\.com\/watch\?v=|youtu\.be\/|youtube\.com\/embed\/)[^"']*)["'][^>]*)>([^<]*)<\/a>/gi,(r,c,i,a)=>{const d=k(i);return d?`<div class="youtube-embed-wrapper"><iframe src="${`https://www.youtube.com/embed/${d}`}" frameborder="0" allowfullscreen allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture"></iframe></div>`:r});const o=/(?:https?:\/\/)?(?:www\.)?(?:youtube\.com\/(?:watch\?v=|embed\/)|youtu\.be\/)([^&\s?#<"'>]+)/gi;return e=e.replace(o,(r,c)=>{const i=e.indexOf(r),a=e.substring(0,i),d=e.substring(i+r.length);return a.includes("<iframe")&&d.includes("</iframe>")||a.includes("<a")&&d.includes("</a>")||a.includes("youtube-embed-wrapper")?r:`<div class="youtube-embed-wrapper"><iframe src="${`https://www.youtube.com/embed/${c}`}" frameborder="0" allowfullscreen allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture"></iframe></div>`}),e=e.replace(/<iframe([^>]*src=["']([^"']*(?:youtube\.com|youtu\.be)[^"']*)["'][^>]*)>[\s\S]*?<\/iframe>/gi,(r,c,i)=>{if(r.includes("youtube-embed-wrapper"))return r;let a=c;return!a.includes("allowfullscreen")&&!a.includes("allow=")&&(a+=' allowfullscreen allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture"'),a.includes("frameborder")||(a+=' frameborder="0"'),`<div class="youtube-embed-wrapper"><iframe${a}></iframe></div>`}),e=e.replace(/<iframe([^>]*src=["']([^"']*(?:youtube\.com|youtu\.be)[^"']*)["'][^>]*)\s*\/>/gi,(r,c,i)=>{if(r.includes("youtube-embed-wrapper"))return r;let a=c;return!a.includes("allowfullscreen")&&!a.includes("allow=")&&(a+=' allowfullscreen allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture"'),a.includes("frameborder")||(a+=' frameborder="0"'),`<div class="youtube-embed-wrapper"><iframe${a}></iframe></div>`}),e});L(()=>{var e;return{title:t.value?`${t.value.title} | Blog | Ruzivoflow`:"Blog Post | Ruzivoflow",meta:{description:{name:"description",content:(e=t.value)!=null&&e.excerpt?t.value.excerpt.replace(/<[^>]*>/g,"").substring(0,160):"Read this blog post on Ruzivoflow"}}}});const h=async()=>{const{slug:e}=_.params;if(e)try{await u.fetchPostBySlug(e)}catch{}};return M(()=>_.params.slug,()=>{u.clearPost(),h()}),T(()=>{h()}),(e,o)=>(l(),g(C,{class:"q-pa-md"},{default:b(()=>[m("div",H,[v(u).loading?(l(),n("div",N,[s(z,{color:"primary",size:"3em"})])):v(u).error?(l(),g(S,{key:1,class:"bg-negative text-white q-mb-md",rounded:""},{avatar:b(()=>[s(x,{name:"error"})]),action:b(()=>[s(w,{flat:"",label:"Go Back",to:{name:"blog-index"}})]),default:b(()=>[$(" "+B(v(u).error)+" ",1)]),_:1})):t.value?(l(),n("article",A,[t.value.featured_image_url?(l(),g(V,{key:0,src:t.value.featured_image_url,alt:t.value.title,class:"q-mb-lg",style:{"max-height":"500px"},loading:"lazy"},null,8,["src","alt"])):f("",!0),m("div",j,[m("h1",E,B(t.value.title),1),s(R,{author:t.value.author,"created-at":t.value.created_at,"published-at":t.value.published_at,category:t.value.category,views:t.value.views},null,8,["author","created-at","published-at","category","views"])]),t.value.tags&&t.value.tags.length>0?(l(),n("div",G,[s(U,{tags:t.value.tags},null,8,["tags"])])):f("",!0),t.value.excerpt?(l(),n("div",{key:2,class:"text-h6 text-grey-7 q-mb-lg",innerHTML:t.value.excerpt},null,8,J)):f("",!0),t.value.content?(l(),n("div",{key:3,class:"post-content q-mb-xl",innerHTML:q.value},null,8,O)):f("",!0),m("div",Y,[s(w,{outline:"",color:"primary",icon:"arrow_back",label:"Back to Blog",to:{name:"blog-index"}})])])):(l(),n("div",F,[s(x,{name:"article",size:"4em",color:"grey-5"}),o[0]||(o[0]=m("div",{class:"text-h6 q-mt-md text-grey-7"},"Post not found",-1)),s(w,{outline:"",color:"primary",label:"Back to Blog",to:{name:"blog-index"},class:"q-mt-md"})]))])]),_:1}))}};var ue=D(K,[["__scopeId","data-v-2a07163d"]]);export{ue as default};
