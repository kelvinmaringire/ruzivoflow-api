import{p as rn,E as Gr,v as le,T as Ws,bl as hu,a3 as Ks,W as fu,X as Go,Y as vu,Z as Fo,r as te,bm as pu,_ as gu,m as Y,z as $e,B as si,bn as Qs,k as Ni,i as Xe,aM as yu,x as li,ah as Ge,V as $n,c as G,d as ye,w as P,e as E,ai as tt,ag as Ue,f as oe,ad as Ce,j as de,R as Qn,ak as Fr,Q as ae,aN as Yi,aL as zi,bg as jo,u as Vo,o as ui,ac as ee,h as ke,am as Ve,ae as mt,af as _t,y as Uo,aa as yn,C as mu,D as Kr,bo as Js,a5 as _u,bd as Eu,a8 as bu,b9 as Cu,aC as Qr,q as vo,a6 as ku,aq as xu,ar as Su,G as Tu,I as Pu,J as pi,K as Au,L as wu,M as Qi,N as Jr,S as wa,U as Zr,bp as Du,bq as Ou,a1 as Mu,br as Iu,bs as Lu,bt as Nu,bu as Ru,bv as Gu,a as Fu,aJ as ju,a0 as Da,g as Vu,av as Uu,al as Bu}from"./index.7d370b68.js";import{a as Qe,b as be,Q as Ut}from"./format.78fa8c6e.js";import{Q as pe}from"./QItemLabel.968a4bb9.js";import{Q as Hu}from"./QPage.33970ec2.js";import{C as St,r as qu,Q as Ji}from"./ClosePopup.65f0d47c.js";import{Q as hr}from"./QTooltip.bb072c3f.js";import{Q as Vt}from"./QChip.73d90e1c.js";import{Q as Bo,d as Ho}from"./date.58a3a886.js";import{u as jr}from"./use-quasar.4d250c70.js";import{_ as Vr}from"./plugin-vue_export-helper.21dcd24c.js";import{g as Oa,s as Ma}from"./touch.9135741d.js";import{c as Yu}from"./selection.af76a41f.js";import"./position-engine.0d968b18.js";var zu=rn({name:"QSlideTransition",props:{appear:Boolean,duration:{type:Number,default:300}},emits:["show","hide"],setup(o,{slots:a,emit:n}){let i=!1,e,t,r=null,s=null,l,u;function d(){e==null||e(),e=null,i=!1,r!==null&&(clearTimeout(r),r=null),s!==null&&(clearTimeout(s),s=null),t==null||t.removeEventListener("transitionend",l),l=null}function h(_,p,C){p!==void 0&&(_.style.height=`${p}px`),_.style.transition=`height ${o.duration}ms cubic-bezier(.25, .8, .50, 1)`,i=!0,e=C}function f(_,p){_.style.overflowY=null,_.style.height=null,_.style.transition=null,d(),p!==u&&n(p)}function g(_,p){let C=0;t=_,i===!0?(d(),C=_.offsetHeight===_.scrollHeight?0:void 0):(u="hide",_.style.overflowY="hidden"),h(_,C,p),r=setTimeout(()=>{r=null,_.style.height=`${_.scrollHeight}px`,l=b=>{s=null,(Object(b)!==b||b.target===_)&&f(_,"show")},_.addEventListener("transitionend",l),s=setTimeout(l,o.duration*1.1)},100)}function y(_,p){let C;t=_,i===!0?d():(u="show",_.style.overflowY="hidden",C=_.scrollHeight),h(_,C,p),r=setTimeout(()=>{r=null,_.style.height=0,l=b=>{s=null,(Object(b)!==b||b.target===_)&&f(_,"hide")},_.addEventListener("transitionend",l),s=setTimeout(l,o.duration*1.1)},100)}return Gr(()=>{i===!0&&d()}),()=>le(Ws,{css:!1,appear:o.appear,onEnter:g,onLeave:y},a.default)}});const un=hu({}),$u=Object.keys(Ks);var wi=rn({name:"QExpansionItem",props:{...Ks,...fu,...Go,icon:String,label:String,labelLines:[Number,String],caption:String,captionLines:[Number,String],dense:Boolean,toggleAriaLabel:String,expandIcon:String,expandedIcon:String,expandIconClass:[Array,String,Object],duration:{},headerInsetLevel:Number,contentInsetLevel:Number,expandSeparator:Boolean,defaultOpened:Boolean,hideExpandIcon:Boolean,expandIconToggle:Boolean,switchToggleSide:Boolean,denseToggle:Boolean,group:String,popup:Boolean,headerStyle:[Array,String,Object],headerClass:[Array,String,Object]},emits:[...vu,"click","afterShow","afterHide"],setup(o,{slots:a,emit:n}){const{proxy:{$q:i}}=si(),e=Fo(o,i),t=te(o.modelValue!==null?o.modelValue:o.defaultOpened),r=te(null),s=pu(),{show:l,hide:u,toggle:d}=gu({showing:t});let h,f;const g=Y(()=>`q-expansion-item q-item-type q-expansion-item--${t.value===!0?"expanded":"collapsed"} q-expansion-item--${o.popup===!0?"popup":"standard"}`),y=Y(()=>{if(o.contentInsetLevel===void 0)return null;const k=i.lang.rtl===!0?"Right":"Left";return{["padding"+k]:o.contentInsetLevel*56+"px"}}),_=Y(()=>o.disable!==!0&&(o.href!==void 0||o.to!==void 0&&o.to!==null&&o.to!=="")),p=Y(()=>{const k={};return $u.forEach(W=>{k[W]=o[W]}),k}),C=Y(()=>_.value===!0||o.expandIconToggle!==!0),b=Y(()=>o.expandedIcon!==void 0&&t.value===!0?o.expandedIcon:o.expandIcon||i.iconSet.expansionItem[o.denseToggle===!0?"denseIcon":"icon"]),m=Y(()=>o.disable!==!0&&(_.value===!0||o.expandIconToggle===!0)),S=Y(()=>({expanded:t.value===!0,detailsId:s.value,toggle:d,show:l,hide:u})),w=Y(()=>{const k=o.toggleAriaLabel!==void 0?o.toggleAriaLabel:i.lang.label[t.value===!0?"collapse":"expand"](o.label);return{role:"button","aria-expanded":t.value===!0?"true":"false","aria-controls":s.value,"aria-label":k}});$e(()=>o.group,k=>{f==null||f(),k!==void 0&&H()});function O(k){_.value!==!0&&d(k),n("click",k)}function I(k){k.keyCode===13&&A(k,!0)}function A(k,W){var ne;W!==!0&&k.qAvoidFocus!==!0&&((ne=r.value)==null||ne.focus()),d(k),$n(k)}function V(){n("afterShow")}function B(){n("afterHide")}function H(){h===void 0&&(h=Qs()),t.value===!0&&(un[o.group]=h);const k=$e(t,ne=>{ne===!0?un[o.group]=h:un[o.group]===h&&delete un[o.group]}),W=$e(()=>un[o.group],(ne,j)=>{j===h&&ne!==void 0&&ne!==h&&u()});f=()=>{k(),W(),un[o.group]===h&&delete un[o.group],f=void 0}}function R(){const k={class:[`q-focusable relative-position cursor-pointer${o.denseToggle===!0&&o.switchToggleSide===!0?" items-end":""}`,o.expandIconClass],side:o.switchToggleSide!==!0,avatar:o.switchToggleSide},W=[le(Ge,{class:"q-expansion-item__toggle-icon"+(o.expandedIcon===void 0&&t.value===!0?" q-expansion-item__toggle-icon--rotated":""),name:b.value})];return m.value===!0&&(Object.assign(k,{tabindex:0,...w.value,onClick:A,onKeyup:I}),W.unshift(le("div",{ref:r,class:"q-expansion-item__toggle-focus q-icon q-focus-helper q-focus-helper--rounded",tabindex:-1}))),le(be,k,()=>W)}function he(){let k;return a.header!==void 0?k=[].concat(a.header(S.value)):(k=[le(be,()=>[le(pe,{lines:o.labelLines},()=>o.label||""),o.caption?le(pe,{lines:o.captionLines,caption:!0},()=>o.caption):null])],o.icon&&k[o.switchToggleSide===!0?"push":"unshift"](le(be,{side:o.switchToggleSide===!0,avatar:o.switchToggleSide!==!0},()=>le(Ge,{name:o.icon})))),o.disable!==!0&&o.hideExpandIcon!==!0&&k[o.switchToggleSide===!0?"unshift":"push"](R()),k}function U(){const k={ref:"item",style:o.headerStyle,class:o.headerClass,dark:e.value,disable:o.disable,dense:o.dense,insetLevel:o.headerInsetLevel};return C.value===!0&&(k.clickable=!0,k.onClick=O,Object.assign(k,_.value===!0?p.value:w.value)),le(Qe,k,he)}function J(){return Xe(le("div",{key:"e-content",class:"q-expansion-item__content relative-position",style:y.value,id:s.value},li(a.default)),[[yu,t.value]])}function T(){const k=[U(),le(zu,{duration:o.duration,onShow:V,onHide:B},J)];return o.expandSeparator===!0&&k.push(le(Ni,{class:"q-expansion-item__border q-expansion-item__border--top absolute-top",dark:e.value}),le(Ni,{class:"q-expansion-item__border q-expansion-item__border--bottom absolute-bottom",dark:e.value})),k}return o.group!==void 0&&H(),Gr(()=>{f==null||f()}),()=>le("div",{class:g.value},[le("div",{class:"q-expansion-item__container relative-position"},T())])}});function Xn(o){return typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?Xn=function(a){return typeof a}:Xn=function(a){return a&&typeof Symbol=="function"&&a.constructor===Symbol&&a!==Symbol.prototype?"symbol":typeof a},Xn(o)}function $(o,a){if(!(o instanceof a))throw new TypeError("Cannot call a class as a function")}function Ia(o,a){for(var n=0;n<a.length;n++){var i=a[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(o,i.key,i)}}function Z(o,a,n){return a&&Ia(o.prototype,a),n&&Ia(o,n),o}function c(o,a,n){return a in o?Object.defineProperty(o,a,{value:n,enumerable:!0,configurable:!0,writable:!0}):o[a]=n,o}function me(o,a){if(typeof a!="function"&&a!==null)throw new TypeError("Super expression must either be null or a function");o.prototype=Object.create(a&&a.prototype,{constructor:{value:o,writable:!0,configurable:!0}}),a&&po(o,a)}function Me(o){return Me=Object.setPrototypeOf?Object.getPrototypeOf:function(n){return n.__proto__||Object.getPrototypeOf(n)},Me(o)}function po(o,a){return po=Object.setPrototypeOf||function(i,e){return i.__proto__=e,i},po(o,a)}function Xu(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function v(o){if(o===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return o}function Wu(o,a){return a&&(typeof a=="object"||typeof a=="function")?a:v(o)}function _e(o){var a=Xu();return function(){var i=Me(o),e;if(a){var t=Me(this).constructor;e=Reflect.construct(i,arguments,t)}else e=i.apply(this,arguments);return Wu(this,e)}}function Ku(o,a){for(;!Object.prototype.hasOwnProperty.call(o,a)&&(o=Me(o),o!==null););return o}function Ie(o,a,n){return typeof Reflect!="undefined"&&Reflect.get?Ie=Reflect.get:Ie=function(e,t,r){var s=Ku(e,t);if(!!s){var l=Object.getOwnPropertyDescriptor(s,t);return l.get?l.get.call(r):l.value}},Ie(o,a,n||o)}function fr(o,a){return Ju(o)||ec(o,a)||Zs(o,a)||nc()}function Jn(o){return Qu(o)||Zu(o)||Zs(o)||tc()}function Qu(o){if(Array.isArray(o))return go(o)}function Ju(o){if(Array.isArray(o))return o}function Zu(o){if(typeof Symbol!="undefined"&&o[Symbol.iterator]!=null||o["@@iterator"]!=null)return Array.from(o)}function ec(o,a){var n=o==null?null:typeof Symbol!="undefined"&&o[Symbol.iterator]||o["@@iterator"];if(n!=null){var i=[],e=!0,t=!1,r,s;try{for(n=n.call(o);!(e=(r=n.next()).done)&&(i.push(r.value),!(a&&i.length===a));e=!0);}catch(l){t=!0,s=l}finally{try{!e&&n.return!=null&&n.return()}finally{if(t)throw s}}return i}}function Zs(o,a){if(!!o){if(typeof o=="string")return go(o,a);var n=Object.prototype.toString.call(o).slice(8,-1);if(n==="Object"&&o.constructor&&(n=o.constructor.name),n==="Map"||n==="Set")return Array.from(o);if(n==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return go(o,a)}}function go(o,a){(a==null||a>o.length)&&(a=o.length);for(var n=0,i=new Array(a);n<a;n++)i[n]=o[n];return i}function tc(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function nc(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function cn(o,a,n){return o==="*"?!0:o.length>0?o.indexOf(a)!==-1:!n}function K(o,a,n){var i;o=o||{},a=a||{};var e=o,t=a;if(n)for(i=0;i<n.length;i++)e[n[i]]=t[n[i]];else for(i in t)e[i]=t[i];return o}function yo(o){return Object.prototype.toString.call(o)==="[object Number]"}function Le(o){return typeof o=="string"}function el(o){return typeof o=="boolean"}function Zn(o){return o==null?!1:Object.prototype.toString.call(o)==="[object Object]"}function ic(o){return Object.prototype.toString.call(o)==="[object Date]"}function En(o){return Object.prototype.toString.call(o)==="[object Function]"}function Er(o){if(Le(o))return""+o;if(el(o))return!!o;if(ic(o))return new Date(o.getTime());if(En(o))return o;if(Array.isArray(o)){for(var a=[],n=0;n<o.length;n++)a.push(Er(o[n]));return a}else if(Zn(o)){var i={};for(var e in o)i[e]=Er(o[e]);return i}else return o}function br(o,a,n,i){var e={},t,r,s={};for(n=n||[],i=i||[],r=0;r<n.length;r++)e[n[r]]=!0;for(r=0;r<i.length;r++)s[i[r]]=!0;var l=Er(o);for(r in a)if(l[r]==null||s[r])l[r]=a[r];else if(e[r])t=[],t.push.apply(t,Array.isArray(l[r])?l[r]:[l[r]]),t.push(a[r]),l[r]=t;else if(Le(a[r])||el(a[r])||En(a[r])||yo(a[r]))l[r]=a[r];else if(Array.isArray(a[r]))t=[],Array.isArray(l[r])&&t.push.apply(t,l[r]),t.push.apply(t,a[r]),l[r]=t;else if(Zn(a[r])){Zn(l[r])||(l[r]={});for(var u in a[r])l[r][u]=a[r][u]}return l}function tl(o,a,n){for(var i=0;i<n.length;i++){var e=n[i][0][n[i][1]].apply(n[i][0],n[i][2]);if(e===a)return e}return o}function rc(o,a,n,i){var e=function(s){var l=s.match(/(\${.*?})/g);if(l!=null)for(var u=0;u<l.length;u++){var d=a[l[u].substring(2,l[u].length-1)]||"";d!=null&&(s=s.replace(l[u],d))}if(l=s.match(/({{.*?}})/g),l!=null)for(var h=0;h<l.length;h++){var f=a[l[h].substring(2,l[h].length-2)]||"";f!=null&&(s=s.replace(l[h],f))}return s},t=function r(s){if(s!=null){if(Le(s))return e(s);if(En(s)&&!i&&(n==null||(s.name||"").indexOf(n)===0))return s(a);if(Array.isArray(s)){for(var l=[],u=0;u<s.length;u++)l.push(r(s[u]));return l}else if(Zn(s)){var d={};for(var h in s)d[h]=r(s[h]);return d}else return s}};return t(o)}function Q(o,a){if(o)for(var n=0;n<o.length;n++)a(o[n]);else return null}function en(o,a){if(o){for(var n=0;n<o.length;n++)if(a(o[n]))return n}return-1}function oc(o,a){var n=[];if(o)for(var i=0;i<o.length;i++)a(o[i])&&n.push(i);return n}function qo(o,a){var n=en(o,a);return n===-1?null:o[n]}function ac(o,a){var n=oc(o,a);return n.map(function(i){return o[i]})}function nl(o,a){var n=null;return o.forEach(function(i){a(i)&&(n=i)}),n}function sc(o){var a=[];return o.forEach(function(n){a.push(n)}),a}function ze(o,a){var n=en(o,a);return n>-1&&o.splice(n,1),n!==-1}function Zi(o){if(Array.fromArray!=null)return Array.from(o);var a=[];return Array.prototype.push.apply(a,o),a}function La(o,a){var n=o.indexOf(a);return n>-1&&o.splice(n,1),n!==-1}function il(o,a,n,i){var e=o[a];return e==null&&(e=[],o[a]=e),e[i?"unshift":"push"](n),e}function gi(o,a,n){return o.indexOf(a)===-1?(n?o.unshift(a):o.push(a),!0):!1}var We=[];for(var yi=0;yi<256;yi++)We[yi]=(yi<16?"0":"")+yi.toString(16);function He(){var o=Math.random()*4294967295|0,a=Math.random()*4294967295|0,n=Math.random()*4294967295|0,i=Math.random()*4294967295|0;return We[o&255]+We[o>>8&255]+We[o>>16&255]+We[o>>24&255]+"-"+We[a&255]+We[a>>8&255]+"-"+We[a>>16&15|64]+We[a>>24&255]+"-"+We[n&63|128]+We[n>>8&255]+"-"+We[n>>16&255]+We[n>>24&255]+We[i&255]+We[i>>8&255]+We[i>>16&255]+We[i>>24&255]}function Cr(o,a,n){var i={x:o.x-a.x,y:o.y-a.y},e=Math.cos(n/360*Math.PI*2),t=Math.sin(n/360*Math.PI*2);return{x:i.x*e-i.y*t+a.x,y:i.y*e+i.x*t+a.y,cr:e,sr:t}}function Yo(o){if(o==null)return null;for(var a=o.replace(/^\s\s*/,""),n=/\s/,i=a.length;n.test(a.charAt(--i)););return a.slice(0,i+1)}function lc(o,a){o=o.length==null||typeof o=="string"?[o]:o;for(var n=0;n<o.length;n++)a(o[n])}function rl(o,a){for(var n=[],i=0;i<o.length;i++)n.push(a(o[i]));return n}function Be(){for(var o=arguments.length,a=new Array(o),n=0;n<o;n++)a[n]=arguments[n];if(typeof console!="undefined")try{var i=arguments[arguments.length-1];console.log(i)}catch{}}function kr(o){return o<0?-1:o>0?1:0}function er(o,a,n){return function(){var i=null;try{a!=null&&(i=a.apply(this,arguments))}catch(e){Be("jsPlumb function failed : "+e)}if(o!=null&&(n==null||i!==n))try{i=o.apply(this,arguments)}catch(e){Be("wrapped function failed : "+e)}return i}}function Na(o,a,n){return o.has(a)||o.set(a,n()),o.get(a)}function ol(o,a){for(var n=o.__proto__;n!=null;){if(n instanceof a)return!0;n=n.__proto__}return!1}function uc(o,a,n,i){if(a.length===0)a.push(o);else{for(var e=i?-1:1,t=0,r=a.length,s=Math.floor((t+r)/2);r>t;){var l=n(o,a[s])*e;l<0?r=s:t=s+1,s=Math.floor((t+r)/2)}a.splice(s,0,o)}}function bn(o,a,n){n=n||o.parentNode;for(var i=n.querySelectorAll(a),e=0;e<i.length;e++)if(i[e]===o)return!0;return!1}function Fi(o,a){o.stopPropagation?o.stopPropagation():o.returnValue=!1,!a&&o.preventDefault&&o.preventDefault()}function Gt(o,a,n,i){if(i&&bn(o,a,n))return o;for(o=o.parentNode;o!=null&&o!==n;){if(bn(o,a))return o;o=o.parentNode}}function ht(o){return o.srcElement||o.target}function cc(o,a,n){a=Yo(a),typeof o.className.baseVal!="undefined"?o.className.baseVal=a:o.className=a;try{var i=o.classList;if(i!=null){for(;i.length>0;)i.remove(i.item(0));for(var e=0;e<n.length;e++)n[e]&&i.add(n[e])}}catch(t){Be("WARN: cannot set class list",t)}}function zo(o){return o.className!=null?typeof o.className.baseVal=="undefined"?o.className:o.className.baseVal:""}function al(o,a,n){var i=a==null?[]:Array.isArray(a)?a:a.split(/\s+/),e=n==null?[]:Array.isArray(n)?n:n.split(/\s+/),t=zo(o),r=t.split(/\s+/),s=function(u,d){for(var h=0;h<d.length;h++)if(u)r.indexOf(d[h])===-1&&r.push(d[h]);else{var f=r.indexOf(d[h]);f!==-1&&r.splice(f,1)}};s(!0,i),s(!1,e),cc(o,r.join(" "),r)}function ji(o){return!Le(o)&&!Array.isArray(o)&&o.length!=null&&o.documentElement==null&&o.nodeType==null}function dc(o){return zo(o)}function pn(o,a){var n=function(e,t){if(e!=null&&t!=null&&t.length>0)if(e.classList){var r=Yo(t).split(/\s+/);Q(r,function(s){e.classList.add(s)})}else al(e,t)};ji(o)?Q(o,function(i){return n(i,a)}):n(o,a)}function hc(o,a){return o.classList?o.classList.contains(a):zo(o).indexOf(a)!==-1}function mo(o,a){var n=function(e,t){if(e!=null&&t!=null&&t.length>0)if(e.classList){var r=Yo(t).split(/\s+/);r.forEach(function(s){e.classList.remove(s)})}else al(e,null,t)};ji(o)?Q(o,function(i){return n(i,a)}):n(o,a)}function fc(o,a){var n=this,i=function(t,r){t!=null&&r!=null&&r.length>0&&(t.classList?t.classList.toggle(r):n.hasClass(t,r)?n.removeClass(t,r):n.addClass(t,r))};ji(o)?Q(o,function(e){return i(e,a)}):i(o,a)}function sl(o,a,n,i){return ll(null,o,a,n,i)}function ll(o,a,n,i,e){var t=o==null?document.createElement(a):document.createElementNS(o,a),r;n=n||{};for(r in n)t.style[r]=n[r];i&&(t.className=i),e=e||{};for(r in e)t.setAttribute(r,""+e[r]);return t}function qn(o){var a=o.getBoundingClientRect(),n=document.body,i=document.documentElement,e=window.pageYOffset||i.scrollTop||n.scrollTop,t=window.pageXOffset||i.scrollLeft||n.scrollLeft,r=i.clientTop||n.clientTop||0,s=i.clientLeft||n.clientLeft||0,l=a.top+e-r,u=a.left+t-s;return{x:Math.round(u),y:Math.round(l)}}function vc(o){return{w:o.offsetWidth,h:o.offsetHeight}}function pc(o){try{return{w:parseFloat(o.width.baseVal.value),h:parseFloat(o.height.baseVal.value)}}catch{return{w:0,h:0}}}function gc(o){try{return{x:parseFloat(o.x.baseVal.value),y:parseFloat(o.y.baseVal.value)}}catch{return{x:0,y:0}}}function tr(o,a){var n=a.getContainer().getBoundingClientRect(),i=o.getBoundingClientRect(),e=a.currentZoom;return{x:(i.left-n.left)/e,y:(i.top-n.top)/e}}function mi(o,a){var n=o.getBoundingClientRect(),i=a.currentZoom;return{w:n.width/i,h:n.height/i}}var Cn;(function(o){o.SVG="SVG",o.HTML="HTML"})(Cn||(Cn={}));function _o(o){return o instanceof SVGElement?Cn.SVG:Cn.HTML}function yc(o){return _o(o)===Cn.SVG}function kn(){for(var o=arguments.length,a=new Array(o),n=0;n<o;n++)a[n]=arguments[n];return a.map(function(i){return"."+i}).join(",")}function mc(){for(var o=arguments.length,a=new Array(o),n=0;n<o;n++)a[n]=arguments[n];return a.join(" ")}function Ur(){for(var o=arguments.length,a=new Array(o),n=0;n<o;n++)a[n]=arguments[n];return a.map(function(i){return"["+i+"]"}).join(",")}var Eo="source",ul="target",bo="block",ei="none",Vi="absolute",Ra="fixed",_c="static",cl="data-jtk-group",Kt="data-jtk-managed",vr="data-jtk-not-draggable",Ga="tabindex",Ec="data-jtk-scope",dl=Ec+"-",hl="checkCondition",bc="checkDropAllowed",$o="jtk-connector",Cc="jtk-connector-outline",kc="jtk-connected",Wn="jtk-endpoint",xc="jtk-endpoint-connected",Sc="jtk-endpoint-full",Xo="jtk-floating-endpoint",Tc="jtk-endpoint-drop-allowed",Pc="jtk-endpoint-drop-forbidden",Ac="jtk-endpoint-anchor",nr="jtk-group-collapsed",_i="jtk-group-expanded",Br="jtk-overlay",wc="anchor:changed",Wo="connection",fl="internal.connection",vl="connection:detach",pl="connection:move",Dc="container:change",Oc="endpoint:replaced",gl="internal.endpoint:unregistered",Ko="internal.connection:detached",yl="element:manage",Mc="group:added",Ic="group:collapse",Lc="group:expand",Nc="group:member:added",Rc="group:member:removed",Gc="group:removed",ml="maxConnections",Fc="group:nested:added",jc="group:nested:removed",_l="element:unmanage",El="zoom",Kn="isDetachAllowed",Vc="beforeDrag",bl="beforeDrop",Cl="beforeDetach",Uc="beforeStartDetach",Oe=Ur(Kt),Bc="Cannot establish connection: source endpoint is full",Hc="Cannot establish connection: target endpoint is full",qc="Cannot establish connection: source does not exist",Yc="Cannot establish connection: target does not exist",zc="connectionOverlays",Fa={"stroke-linejoin":"stroke-linejoin","stroke-dashoffset":"stroke-dashoffset","stroke-linecap":"stroke-linecap"},Ei="stroke-dasharray",eo="dashstyle",$c="fill",Xc="stroke",Wc="stroke-width",Kc="strokeWidth",kl="svg",Co="path",ja={svg:"http://www.w3.org/2000/svg"};function Bt(o,a){for(var n in a)o.setAttribute(n,""+a[n])}function Ht(o,a){return a=a||{},a.version="1.1",a.xmlns=ja.svg,ll(ja.svg,o,null,null,a)}function xl(o){return"position:absolute;left:"+o[0]+"px;top:"+o[1]+"px"}function ko(o,a,n){if(a.setAttribute($c,n.fill?n.fill:ei),a.setAttribute(Xc,n.stroke?n.stroke:ei),n.strokeWidth&&a.setAttribute(Wc,n.strokeWidth),n[eo]&&n[Kc]&&!n[Ei]){var i=n[eo].indexOf(",")===-1?" ":",",e=n[eo].split(i),t="";Q(e,function(s){t+=Math.floor(s*n.strokeWidth)+i}),a.setAttribute(Ei,t)}else n[Ei]&&a.setAttribute(Ei,n[Ei]);for(var r in Fa)n[r]&&a.setAttribute(Fa[r],n[r])}function pr(o,a,n){o.childNodes.length>n?o.insertBefore(a,o.childNodes[n]):o.appendChild(a)}function Te(o,a,n){var i=[o,a];return n&&i.push(n),i.join(":")}var Va="data-jtk-container",Qc="data-jtk-group-content",ir="data-jtk-enabled",to="data-jtk-scope",qt="endpoint",Ot="element",Mt="connection",Sl="div",ot="click",Ft="contextmenu",ft="dblclick",vt="dbltap",Jc="focus",ue="mousedown",Qo="mouseenter",Jo="mouseexit",Ye="mousemove",ce="mouseup",pt="mouseout",gt="mouseover",yt="tap",Zc="touchstart",ed="touchend",td="touchmove",nd="drag:move",Tl="drag:stop",id="drag:start",xr="revert",rd="connection:abort",Ua="connection:drag",Ba=Te(Ot,ot),od=Te(Ot,ft),Ha=Te(Ot,vt),ad=Te(Ot,pt),sd=Te(Ot,gt),ld=Te(Ot,Ye),ud=Te(Ot,ce),cd=Te(Ot,ue),dd=Te(Ot,Ft),qa=Te(Ot,yt),hd=Te(qt,ot),fd=Te(qt,ft);Te(qt,vt);var vd=Te(qt,pt),pd=Te(qt,gt),gd=Te(qt,ce),yd=Te(qt,ue);Te(qt,yt);var md=Te(Mt,ot),_d=Te(Mt,ft),Ed=Te(Mt,vt),bd=Te(Mt,pt),Cd=Te(Mt,gt),kd=Te(Mt,ce),xd=Te(Mt,ue),Sd=Te(Mt,Ft),Td=Te(Mt,yt),Ya="position",Ct=kn($o),dn=kn(Wn),Pd=Ur(cl),Ad=Ur(Qc),Nt=kn(Br),tn;(function(o){o.Circle="Circle",o.Ellipse="Ellipse",o.Triangle="Triangle",o.Diamond="Diamond",o.Rectangle="Rectangle",o.Square="Square"})(tn||(tn={}));var Dt;(function(o){o.Assign="Assign",o.AutoDefault="AutoDefault",o.Bottom="Bottom",o.BottomLeft="BottomLeft",o.BottomRight="BottomRight",o.Center="Center",o.Continuous="Continuous",o.ContinuousBottom="ContinuousBottom",o.ContinuousLeft="ContinuousLeft",o.ContinuousRight="ContinuousRight",o.ContinuousTop="ContinuousTop",o.ContinuousLeftRight="ContinuousLeftRight",o.ContinuousTopBottom="ContinuousTopBottom",o.Left="Left",o.Perimeter="Perimeter",o.Right="Right",o.Top="Top",o.TopLeft="TopLeft",o.TopRight="TopRight"})(Dt||(Dt={}));function wd(){return{d:1/0,x:null,y:null,l:null,x1:null,y1:null,x2:null,y2:null}}function Sr(){return{xmin:1/0,xmax:-1/0,ymin:1/0,ymax:-1/0}}var Zo=function(){function o(a){$(this,o),this.params=a,c(this,"x1",void 0),c(this,"x2",void 0),c(this,"y1",void 0),c(this,"y2",void 0),c(this,"extents",Sr()),c(this,"type",void 0),this.x1=a.x1,this.y1=a.y1,this.x2=a.x2,this.y2=a.y2}return Z(o,[{key:"findClosestPointOnPath",value:function(n,i){return wd()}},{key:"lineIntersection",value:function(n,i,e,t){return[]}},{key:"boxIntersection",value:function(n,i,e,t){var r=[];return r.push.apply(r,this.lineIntersection(n,i,n+e,i)),r.push.apply(r,this.lineIntersection(n+e,i,n+e,i+t)),r.push.apply(r,this.lineIntersection(n+e,i+t,n,i+t)),r.push.apply(r,this.lineIntersection(n,i+t,n,i)),r}},{key:"boundingBoxIntersection",value:function(n){return this.boxIntersection(n.x,n.y,n.w,n.h)}}]),o}(),Pl="undefined",Tr="default",Al="true",Yn="false",mn="*",bi,Ci;function Dd(o,a,n,i,e,t,r){return new Touch({target:o,identifier:He(),pageX:a,pageY:n,screenX:i,screenY:e,clientX:t||i,clientY:r||e})}function Od(){var o=[];return o.push.apply(o,arguments),o.item=function(a){return this[a]},o}function Md(o,a,n,i,e,t,r){return Od(Dd(o,a,n,i,e,t,r))}function ti(o,a,n){n=n||o.parentNode;for(var i=n.querySelectorAll(a),e=0;e<i.length;e++)if(i[e]===o)return!0;return!1}function Ui(o){return o.srcElement||o.target}function xo(o,a,n,i){if(i){var e=o.composedPath?o.composedPath():o.path;if(typeof e!="undefined"&&e.indexOf)return{path:e,end:e.indexOf(n)};var t={path:[],end:-1},r=function s(l){t.path.push(l),l===n?t.end=t.path.length-1:l.parentNode!=null&&s(l.parentNode)};return r(a),t}else return{path:[a],end:1}}function Id(o,a){var n=0,i;for(n=0,i=o.length;n<i&&o[n][0]!==a;n++);n<o.length&&o.splice(n,1)}var Ld=1;function Ri(){return"ontouchstart"in document.documentElement||navigator.maxTouchPoints!=null&&navigator.maxTouchPoints>0}function gr(){return"onmousedown"in document.documentElement}var jt=(bi={},c(bi,ue,Zc),c(bi,ce,ed),c(bi,Ye,td),bi),Nd="page",Rd="screen",Gd="client";function ea(o,a){if(o==null)return{x:0,y:0};var n=wl(o),i=Vd(n,0);return{x:i[a+"X"],y:i[a+"Y"]}}function Pr(o){return ea(o,Nd)}function Fd(o){return ea(o,Rd)}function jd(o){return ea(o,Gd)}function Vd(o,a){return o.item?o.item(a):o[a]}function wl(o){return o.touches&&o.touches.length>0?o.touches:o.changedTouches&&o.changedTouches.length>0?o.changedTouches:o.targetTouches&&o.targetTouches.length>0?o.targetTouches:[o]}function Ud(o){return wl(o).length}function Ar(o,a,n,i,e){if(Ol(o,a,n),i.__tauid=n.__tauid,o.addEventListener)o.addEventListener(a,n,!1,e);else if(o.attachEvent){var t=a+n.__tauid;o["e"+t]=n,o[t]=function(){o["e"+t]&&o["e"+t](window.event)},o.attachEvent("on"+a,o[t])}}function Bi(o,a,n){var i=this;n!=null&&Dl(o,function(e){if(Bd(e,a,n),n.__tauid!=null){if(e.removeEventListener)e.removeEventListener(a,n,!1),Ri()&&jt[a]&&e.removeEventListener(jt[a],n,!1);else if(i.detachEvent){var t=a+n.__tauid;e[t]&&e.detachEvent("on"+a,e[t]),e[t]=null,e["e"+t]=null}}n.__taTouchProxy&&Bi(o,n.__taTouchProxy[1],n.__taTouchProxy[0])})}function Dl(o,a){if(o!=null)for(var n=typeof o=="string"?document.querySelectorAll(o):o.length!=null?o:[o],i=0;i<n.length;i++)a(n[i])}function Ol(o,a,n){var i=Ld++;return o.__ta=o.__ta||{},o.__ta[a]=o.__ta[a]||{},o.__ta[a][i]=n,n.__tauid=i,i}function Bd(o,a,n){if(o.__ta&&o.__ta[a]&&delete o.__ta[a][n.__tauid],n.__taExtra){for(var i=0;i<n.__taExtra.length;i++)Bi(o,n.__taExtra[i][0],n.__taExtra[i][1]);n.__taExtra.length=0}n.__taUnstore&&n.__taUnstore()}var Hd=/:not\(([^)]+)\)/;function wr(o,a,n,i){if(o==null)return n;var e=o.split(","),t=[],r=[];Q(e,function(l){var u=l.match(Hd);u!=null?r.push(u[1]):t.push(l)}),r.length>0&&t.length===0&&t.push(mn);var s=function l(u){l.__tauid=n.__tauid;var d=Ui(u),h=!1,f=d,g=xo(u,d,a,o!=null);if(g.end!=-1)for(var y=0;!h&&y<g.end;y++){f=g.path[y];for(var _=0;_<r.length;_++)if(ti(f,r[_],a))return;for(var p=0;!h&&p<t.length;p++)if(ti(f,t[p],a)){n.apply(f,[u,f]),h=!0;break}}};return qd(n,i,s),s}function qd(o,a,n){o.__taExtra=o.__taExtra||[],o.__taExtra.push([a,n])}var yr=function(a,n,i,e,t){if(Ri()&&jt[n]){var r=wr(e,a,i,jt[n]);Ar(a,jt[n],r,i,t)}n===Jc&&a.getAttribute(Ga)==null&&a.setAttribute(Ga,"1"),Ar(a,n,wr(e,a,i,n),i,t)},no=(Ci={},c(Ci,yt,{touches:1,taps:1}),c(Ci,vt,{touches:1,taps:2}),c(Ci,Ft,{touches:2,taps:1}),Ci);function za(o,a,n,i){for(var e in n.__tamee[o])n.__tamee[o].hasOwnProperty(e)&&n.__tamee[o][e].apply(i,[a])}var Yd=function(){function o(){$(this,o)}return Z(o,null,[{key:"generate",value:function(n,i){return function(e,t,r,s){if(t==Ft&&gr())yr(e,t,r,s);else{if(e.__taTapHandler==null){var l=e.__taTapHandler={tap:[],dbltap:[],down:!1,taps:0,downSelectors:[]},u=function(y){for(var _=Ui(y),p=xo(y,_,e,s!=null),C=!1,b=0;b<p.end;b++){if(C)return;_=p.path[b];for(var m=0;m<l.downSelectors.length;m++)if(l.downSelectors[m]==null||ti(_,l.downSelectors[m],e)){l.down=!0,setTimeout(h,n),setTimeout(f,i),C=!0;break}}},d=function(y){if(l.down){var _=Ui(y),p,C;l.taps++;var b=Ud(y);for(var m in no)if(no.hasOwnProperty(m)){var S=no[m];if(S.touches===b&&(S.taps===1||S.taps===l.taps))for(var w=0;w<l[m].length;w++){C=xo(y,_,e,l[m][w][1]!=null);for(var O=0;O<C.end;O++)if(p=C.path[O],l[m][w][1]==null||ti(p,l[m][w][1],e)){l[m][w][0].apply(p,[y,p]);break}}}}},h=function(){l.down=!1},f=function(){l.taps=0};e.__taTapHandler.downHandler=u,e.__taTapHandler.upHandler=d,yr(e,ue,u),yr(e,ce,d)}e.__taTapHandler.downSelectors.push(s),e.__taTapHandler[t].push([r,s]),r.__taUnstore=function(){e.__taTapHandler!=null&&(ze(e.__taTapHandler.downSelectors,function(g){return g===s}),Id(e.__taTapHandler[t],r),e.__taTapHandler.downSelectors.length===0&&(Bi(e,ue,e.__taTapHandler.downHandler),Bi(e,ce,e.__taTapHandler.upHandler),delete e.__taTapHandler))}}}}}]),o}(),zd=function(){function o(){$(this,o)}return Z(o,null,[{key:"generate",value:function(){var n=[];return function(i,e,t,r){if(!i.__tamee){i.__tamee={over:!1,mouseenter:[],mouseexit:[]};var s=function(d){var h=Ui(d);(r==null&&h==i&&!i.__tamee.over||ti(h,r,i)&&(h.__tamee==null||!h.__tamee.over))&&(za(Qo,d,i,h),h.__tamee=h.__tamee||{},h.__tamee.over=!0,n.push(h))},l=function(d){for(var h=Ui(d),f=0;f<n.length;f++)h==n[f]&&!ti(d.relatedTarget||d.toElement,"*",h)&&(h.__tamee.over=!1,n.splice(f,1),za(Jo,d,i,h))};Ar(i,gt,wr(r,i,s,gt),s),Ar(i,pt,wr(r,i,l,pt),l)}t.__taUnstore=function(){delete i.__tamee[e][t.__tauid]},Ol(i,e,t),i.__tamee[e][t.__tauid]=t}}}]),o}(),ta=function(){function o(a){$(this,o),c(this,"clickThreshold",void 0),c(this,"dblClickThreshold",void 0),c(this,"tapHandler",void 0),c(this,"mouseEnterExitHandler",void 0),a=a||{},this.clickThreshold=a.clickThreshold||250,this.dblClickThreshold=a.dblClickThreshold||450,this.mouseEnterExitHandler=zd.generate(),this.tapHandler=Yd.generate(this.clickThreshold,this.dblClickThreshold)}return Z(o,[{key:"_doBind",value:function(n,i,e,t,r){if(e!=null){var s=n;i===yt||i===vt||i===Ft?this.tapHandler(s,i,e,t,r):i===Qo||i==Jo?this.mouseEnterExitHandler(s,i,e,t,r):yr(s,i,e,t,r)}}},{key:"on",value:function(n,i,e,t,r){var s=t==null?null:e,l=t==null?e:t;return this._doBind(n,i,l,s,r),this}},{key:"off",value:function(n,i,e){return Bi(n,i,e),this}},{key:"trigger",value:function(n,i,e,t,r){var s=gr()&&(typeof MouseEvent=="undefined"||e==null||e.constructor===MouseEvent),l=Ri()&&!gr()&&jt[i]?jt[i]:i,u=!(Ri()&&!gr()&&jt[i]),d=Pr(e),h=Fd(e),f=jd(e);return Dl(n,function(g){var y;e=e||{screenX:h.x,screenY:h.y,clientX:f.x,clientY:f.y};var _=function(S){t&&(S.payload=t)},p={TouchEvent:function(S){var w=Md(g,d.x,d.y,h.x,h.y,f.x,f.y),O=S.initTouchEvent||S.initEvent;O(l,!0,!0,window,null,h.x,h.y,f.x,f.y,!1,!1,!1,!1,w,w,w,1,0)},MouseEvents:function(S){S.initMouseEvent(l,!0,!0,window,r==null?1:r,h.x,h.y,f.x,f.y,!1,!1,!1,!1,1,g)}},C=!u&&!s&&Ri()&&jt[i],b=C?"TouchEvent":"MouseEvents";y=document.createEvent(b),p[b](y),_(y),g.dispatchEvent(y)}),this}}]),o}(),$d=[null,[1,-1],[1,1],[-1,1],[-1,-1]],Xd=[null,[-1,-1],[-1,1],[1,1],[1,-1]],hn=2*Math.PI;function ni(o,a){return a.x===o.x?a.y>o.y?1/0:-1/0:a.y===o.y?a.x>o.x?0:-0:(a.y-o.y)/(a.x-o.x)}function Wd(o,a){return-1/ni(o,a)}function So(o,a){return Math.sqrt(Math.pow(a.y-o.y,2)+Math.pow(a.x-o.x,2))}function na(o,a){return a.x>o.x||a.x==o.x?a.y>o.y?2:1:a.y>o.y?3:4}function Kd(o,a){var n=ni(o,a),i=Math.atan(n),e=na(o,a);return(e==4||e==3)&&(i+=Math.PI),i<0&&(i+=2*Math.PI),i}function Ml(o,a){var n=o.x,i=o.x+o.w,e=o.y,t=o.y+o.h,r=a.x,s=a.x+a.w,l=a.y,u=a.y+a.h;return n<=r&&r<=i&&e<=l&&l<=t||n<=s&&s<=i&&e<=l&&l<=t||n<=r&&r<=i&&e<=u&&u<=t||n<=s&&r<=i&&e<=u&&u<=t||r<=n&&n<=s&&l<=e&&e<=u||r<=i&&i<=s&&l<=e&&e<=u||r<=n&&n<=s&&l<=t&&t<=u||r<=i&&n<=s&&l<=t&&t<=u}function gn(o,a,n){var i=ni(o,a),e=na(o,a),t=n>0?$d[e]:Xd[e],r=Math.atan(i),s=Math.abs(n*Math.sin(r))*t[1],l=Math.abs(n*Math.cos(r))*t[0];return{x:o.x+l,y:o.y+s}}function Qd(o,a,n){var i=ni(o,a),e=Math.atan(-1/i),t=n/2*Math.sin(e),r=n/2*Math.cos(e);return[{x:a.x+r,y:a.y+t},{x:a.x-r,y:a.y-t}]}function Jd(o,a,n,i){n=n==null?a.thresholdX==null?a.w/2:a.thresholdX:n,i=i==null?a.thresholdY==null?a.h/2:a.thresholdY:i;var e=Math.floor(o.x/a.w),t=a.w*e,r=t+a.w,s=Math.abs(o.x-t)<=n?t:Math.abs(r-o.x)<=n?r:o.x,l=Math.floor(o.y/a.h),u=a.h*l,d=u+a.h,h=Math.abs(o.y-u)<=i?u:Math.abs(d-o.y)<=i?d:o.y;return{x:s,y:h}}function Zd(o,a,n){if(bn(a,n,o))return a;for(var i=a.parentNode;i!=null&&i!==o;){if(bn(i,n,o))return i;i=i.parentNode}}function eh(o){return typeof o=="function"?(o._katavorioId=He(),o._katavorioId):o}function $a(o,a,n){var i=a.parentNode,e=o.getSize(i),t=o.getSize(a),r=n.x,s=r+t.w,l=n.y,u=l+t.h;return s>0&&r<e.w&&u>0&&l<e.h}function th(o,a,n){for(var i=null,e=a.getAttribute("katavorio-draggable"),t=e!=null?"[katavorio-draggable='"+e+"'] ":"",r=0;r<o.length;r++)if(i=Zd(a,n,t+o[r].selector),i!=null){if(o[r].filter){var s=bn(n,o[r].filter,i),l=o[r].filterExclude===!0;if(l&&!s||s)return null}return[o[r],i]}return null}var Il="start",Ll="beforeStart",Nl="drag",nh="drop",ih="over",rh="out",Rl="stop",Gl="katavorio-draggable",oh=Gl,ah=10,sh=10,io=function(){return!0},lh=function(){return!1},Di={delegatedDraggable:"katavorio-delegated-draggable",draggable:oh,drag:"katavorio-drag",selected:"katavorio-drag-selected",noSelect:"katavorio-drag-no-select",ghostProxy:"katavorio-ghost-proxy",clonedDrag:"katavorio-clone-drag"},Tt;(function(o){o.absolutePosition="absolutePosition",o.transform="transform",o.xyAttributes="xyAttributes"})(Tt||(Tt={}));var ia=new Map;ia.set(Tt.absolutePosition,function(o,a){o.style.left="".concat(a.x,"px"),o.style.top="".concat(a.y,"px")});ia.set(Tt.xyAttributes,function(o,a){o.setAttribute("x","".concat(a.x)),o.setAttribute("y","".concat(a.y))});var ra=new Map;ra.set(Tt.absolutePosition,function(o){return{x:o.offsetLeft,y:o.offsetTop}});ra.set(Tt.xyAttributes,function(o){return{x:parseFloat(o.getAttribute("x")),y:parseFloat(o.getAttribute("y"))}});var oa=new Map;oa.set(Tt.absolutePosition,function(o,a){o.style.width="".concat(a.w,"px"),o.style.height="".concat(a.h,"px")});oa.set(Tt.xyAttributes,function(o,a){o.setAttribute("width","".concat(a.w)),o.setAttribute("height","".concat(a.h))});var aa=new Map;aa.set(Tt.absolutePosition,function(o){return{w:o.offsetWidth,h:o.offsetHeight}});aa.set(Tt.xyAttributes,function(o){return{w:parseFloat(o.getAttribute("width")),h:parseFloat(o.getAttribute("height"))}});var ro=[Rl,Il,Nl,nh,ih,rh,Ll],uh=function(){},In=function(a,n){if(a!=null){a=!Le(a)&&a.tagName==null&&a.length!=null?a:[a];for(var i=0;i<a.length;i++)n.apply(a[i],[a[i]])}},ch=function(a,n,i){var e=a.srcElement||a.target;return!bn(e,i.getInputFilterSelector(),n)},dh=function(){function o(a,n){$(this,o),this.el=a,this.manager=n,c(this,"_class",void 0),c(this,"uuid",He()),c(this,"enabled",!0),c(this,"scopes",[]),c(this,"eventManager",void 0),this.eventManager=n.eventManager}return Z(o,[{key:"setEnabled",value:function(n){this.enabled=n}},{key:"isEnabled",value:function(){return this.enabled}},{key:"toggleEnabled",value:function(){this.enabled=!this.enabled}},{key:"addScope",value:function(n){var i={};In(this.scopes,function(t){i[t]=!0}),In(n?n.split(/\s+/):[],function(t){i[t]=!0}),this.scopes.length=0;for(var e in i)this.scopes.push(e)}},{key:"removeScope",value:function(n){var i={};In(this.scopes,function(t){i[t]=!0}),In(n?n.split(/\s+/):[],function(t){delete i[t]}),this.scopes.length=0;for(var e in i)this.scopes.push(e)}},{key:"toggleScope",value:function(n){var i={};In(this.scopes,function(t){i[t]=!0}),In(n?n.split(/\s+/):[],function(t){i[t]?delete i[t]:i[t]=!0}),this.scopes.length=0;for(var e in i)this.scopes.push(e)}}]),o}();function hh(o){return{w:o.parentNode.offsetWidth+o.parentNode.scrollLeft,h:o.parentNode.offsetHeight+o.parentNode.scrollTop}}var Gi;(function(o){o.notNegative="notNegative",o.parent="parent",o.parentEnclosed="parentEnclosed"})(Gi||(Gi={}));var fh=function(o){me(n,o);var a=_e(n);function n(i,e,t){var r;if($(this,n),r=a.call(this,i,t),c(v(r),"_class",void 0),c(v(r),"rightButtonCanDrag",void 0),c(v(r),"consumeStartEvent",void 0),c(v(r),"clone",void 0),c(v(r),"scroll",void 0),c(v(r),"trackScroll",void 0),c(v(r),"_downAt",void 0),c(v(r),"_posAtDown",void 0),c(v(r),"_pagePosAtDown",void 0),c(v(r),"_pageDelta",{x:0,y:0}),c(v(r),"_moving",void 0),c(v(r),"_lastPosition",void 0),c(v(r),"_lastScrollValues",{x:0,y:0}),c(v(r),"_initialScroll",{x:0,y:0}),c(v(r),"_size",void 0),c(v(r),"_currentParentPosition",void 0),c(v(r),"_ghostParentPosition",void 0),c(v(r),"_dragEl",void 0),c(v(r),"_multipleDrop",void 0),c(v(r),"_ghostProxyOffsets",void 0),c(v(r),"_ghostDx",void 0),c(v(r),"_ghostDy",void 0),c(v(r),"_isConstrained",!1),c(v(r),"_ghostProxyParent",void 0),c(v(r),"_useGhostProxy",void 0),c(v(r),"_ghostProxyFunction",void 0),c(v(r),"_activeSelectorParams",void 0),c(v(r),"_availableSelectors",[]),c(v(r),"_canDrag",void 0),c(v(r),"_consumeFilteredEvents",void 0),c(v(r),"_parent",void 0),c(v(r),"_ignoreZoom",void 0),c(v(r),"_filters",{}),c(v(r),"_constrainRect",void 0),c(v(r),"_elementToDrag",void 0),c(v(r),"downListener",void 0),c(v(r),"moveListener",void 0),c(v(r),"upListener",void 0),c(v(r),"scrollTracker",void 0),c(v(r),"listeners",{start:[],drag:[],stop:[],over:[],out:[],beforeStart:[],revert:[]}),r._class=r.manager.css.draggable,pn(r.el,r._class),r.downListener=r._downListener.bind(v(r)),r.upListener=r._upListener.bind(v(r)),r.moveListener=r._moveListener.bind(v(r)),r.rightButtonCanDrag=e.rightButtonCanDrag===!0,r.consumeStartEvent=e.consumeStartEvent!==!1,r._dragEl=r.el,r.clone=e.clone===!0,r.scroll=e.scroll===!0,r.trackScroll=e.trackScroll!==!1,r._multipleDrop=e.multipleDrop!==!1,r._canDrag=e.canDrag||io,r._consumeFilteredEvents=e.consumeFilteredEvents,r._parent=e.parent,r._ignoreZoom=e.ignoreZoom===!0,r._ghostProxyParent=e.ghostProxyParent,r.trackScroll&&(r.scrollTracker=r._trackScroll.bind(v(r)),document.addEventListener("scroll",r.scrollTracker)),e.ghostProxy===!0?r._useGhostProxy=io:e.ghostProxy&&typeof e.ghostProxy=="function"?r._useGhostProxy=e.ghostProxy:r._useGhostProxy=function(l,u){return r._activeSelectorParams&&r._activeSelectorParams.useGhostProxy?r._activeSelectorParams.useGhostProxy(l,u):!1},e.makeGhostProxy?r._ghostProxyFunction=e.makeGhostProxy:r._ghostProxyFunction=function(l){return r._activeSelectorParams&&r._activeSelectorParams.makeGhostProxy?r._activeSelectorParams.makeGhostProxy(l):l.cloneNode(!0)},e.selector){var s=r.el.getAttribute(Gl);s==null&&(s=""+new Date().getTime(),r.el.setAttribute("katavorio-draggable",s)),r._availableSelectors.push(e)}return r.eventManager.on(r.el,ue,r.downListener),r}return Z(n,[{key:"_trackScroll",value:function(e){if(this._moving){var t={x:document.documentElement.scrollLeft,y:document.documentElement.scrollTop},r=t.x-this._lastScrollValues.x,s=t.y-this._lastScrollValues.y,l={x:r+this._lastPosition.x,y:s+this._lastPosition.y},u=l.x-this._downAt.x,d=l.y-this._downAt.y,h=this._ignoreZoom?1:this.manager.getZoom();this._dragEl&&this._dragEl.parentNode&&(u+=this._dragEl.parentNode.scrollLeft-this._initialScroll.x,d+=this._dragEl.parentNode.scrollTop-this._initialScroll.y),u/=h,d/=h,this.moveBy(u,d,e),this._lastPosition=l,this._lastScrollValues=t}}},{key:"on",value:function(e,t){this.listeners[e]&&this.listeners[e].push(t)}},{key:"off",value:function(e,t){if(this.listeners[e]){for(var r=[],s=0;s<this.listeners[e].length;s++)this.listeners[e][s]!==t&&r.push(this.listeners[e][s]);this.listeners[e]=r}}},{key:"_upListener",value:function(e){this._downAt&&(this._downAt=null,this.eventManager.off(document,Ye,this.moveListener),this.eventManager.off(document,ce,this.upListener),mo(document.body,Di.noSelect),this.unmark(e),this.stop(e),this._moving=!1,this.clone?(this._dragEl&&this._dragEl.parentNode&&this._dragEl.parentNode.removeChild(this._dragEl),this._dragEl=null):this._activeSelectorParams&&this._activeSelectorParams.revertFunction&&this._activeSelectorParams.revertFunction(this._dragEl,this.manager.getPosition(this._dragEl))===!0&&(this.manager.setPosition(this._dragEl,this._posAtDown),this._dispatch(xr,this._dragEl)))}},{key:"_downListener",value:function(e){if(!e.defaultPrevented){var t=this.rightButtonCanDrag||e.which!==3&&e.button!==2;if(t&&this.isEnabled()&&this._canDrag()){var r=this._testFilter(e)&&ch(e,this.el,this.manager);if(r){this._activeSelectorParams=null,this._elementToDrag=null,this._availableSelectors.length===0&&console.log("JSPLUMB: no available drag selectors");var s=e.target||e.srcElement,l=th(this._availableSelectors,this.el,s);if(l!=null&&(this._activeSelectorParams=l[0],this._elementToDrag=l[1]),this._activeSelectorParams==null||this._elementToDrag==null)return;var u=this._activeSelectorParams.dragInit?this._activeSelectorParams.dragInit(this._elementToDrag,e):null;if(u!=null&&(this._elementToDrag=u),this.clone)if(this._dragEl=this._elementToDrag.cloneNode(!0),pn(this._dragEl,Di.clonedDrag),this._dragEl.setAttribute("id",null),this._dragEl.style.position="absolute",this._parent!=null){var d=this.manager.getPosition(this.el);this._dragEl.style.left=d.x+"px",this._dragEl.style.top=d.y+"px",this._parent.appendChild(this._dragEl)}else{var h=qn(this._elementToDrag);this._dragEl.style.left=h.x+"px",this._dragEl.style.top=h.y+"px",document.body.appendChild(this._dragEl)}else this._dragEl=this._elementToDrag;this.consumeStartEvent&&Fi(e),this._downAt=Pr(e),this._dragEl&&this._dragEl.parentNode&&(this._initialScroll={x:this._dragEl.parentNode.scrollLeft,y:this._dragEl.parentNode.scrollTop}),this._posAtDown=this.manager.getPosition(this._dragEl),this._pagePosAtDown=qn(this._dragEl),this._pageDelta={x:this._pagePosAtDown.x-this._posAtDown.x,y:this._pagePosAtDown.y-this._posAtDown.y},this._size=this.manager.getSize(this._dragEl),this.eventManager.on(document,Ye,this.moveListener),this.eventManager.on(document,ce,this.upListener),pn(document.body,Di.noSelect),this._dispatch(Ll,{el:this.el,pos:this._posAtDown,e,drag:this,size:this._size})}else this._consumeFilteredEvents&&Fi(e)}}}},{key:"_moveListener",value:function(e){if(this._downAt){if(!this._moving){var t=this._dispatch(Il,{el:this.el,pos:this._posAtDown,e,drag:this,size:this._size});if(t!==!1){if(!this._downAt)return;this.mark(t),this._moving=!0}else this.abort()}if(this._downAt){var r=Pr(e),s=r.x-this._downAt.x,l=r.y-this._downAt.y,u=this._ignoreZoom?1:this.manager.getZoom();this._lastPosition={x:r.x,y:r.y},this._lastScrollValues={x:document.documentElement.scrollLeft,y:document.documentElement.scrollTop},this._dragEl&&this._dragEl.parentNode&&(s+=this._dragEl.parentNode.scrollLeft-this._initialScroll.x,l+=this._dragEl.parentNode.scrollTop-this._initialScroll.y),s/=u,l/=u,this.moveBy(s,l,e)}}}},{key:"getDragDelta",value:function(){return this._posAtDown!=null&&this._downAt!=null?{x:this._downAt.x-this._posAtDown.x,y:this._downAt.y-this._posAtDown.y}:{x:0,y:0}}},{key:"mark",value:function(e){this._posAtDown=this.manager.getPosition(this._dragEl),this._pagePosAtDown=qn(this._dragEl),this._pageDelta={x:this._pagePosAtDown.x-this._posAtDown.x,y:this._pagePosAtDown.y-this._posAtDown.y},this._size=this.manager.getSize(this._dragEl),pn(this._dragEl,this.manager.css.drag),this._constrainRect=hh(this._dragEl),this._ghostDx=0,this._ghostDy=0}},{key:"unmark",value:function(e){this._isConstrained&&this._useGhostProxy(this._elementToDrag,this._dragEl)?(this._ghostProxyOffsets={x:this._dragEl.offsetLeft-this._ghostDx,y:this._dragEl.offsetTop-this._ghostDy},this._dragEl.parentNode.removeChild(this._dragEl),this._dragEl=this._elementToDrag):this._ghostProxyOffsets=null,mo(this._dragEl,this.manager.css.drag),this._isConstrained=!1}},{key:"moveBy",value:function(e,t,r){var s=this.toGrid({x:this._posAtDown.x+e,y:this._posAtDown.y+t}),l=this._doConstrain(s,this._dragEl,this._constrainRect,this._size,r);if(l!=null){if(this._useGhostProxy(this.el,this._dragEl))if(s.x!==l.x||s.y!==l.y){if(!this._isConstrained){var u=this._ghostProxyFunction(this._elementToDrag);pn(u,Di.ghostProxy),this._ghostProxyParent?(this._ghostProxyParent.appendChild(u),this._currentParentPosition=qn(this._elementToDrag.parentNode),this._ghostParentPosition=qn(this._ghostProxyParent),this._ghostDx=this._currentParentPosition.x-this._ghostParentPosition.x,this._ghostDy=this._currentParentPosition.y-this._ghostParentPosition.y):this._elementToDrag.parentNode.appendChild(u),this._dragEl=u,this._isConstrained=!0}l=s}else this._isConstrained&&(this._dragEl.parentNode.removeChild(this._dragEl),this._dragEl=this._elementToDrag,this._isConstrained=!1,this._currentParentPosition=null,this._ghostParentPosition=null,this._ghostDx=0,this._ghostDy=0);this.manager.setPosition(this._dragEl,{x:l.x+this._ghostDx,y:l.y+this._ghostDy}),this._dispatch(Nl,{el:this.el,pos:l,e:r,drag:this,size:this._size,originalPos:this._posAtDown})}}},{key:"abort",value:function(){this._downAt!=null&&this._upListener()}},{key:"getDragElement",value:function(e){return e?this._elementToDrag||this.el:this._dragEl||this.el}},{key:"stop",value:function(e,t){if(t||this._moving){var r=[],s=this.manager.getPosition(this._dragEl);r.push([this._dragEl,s,this,this._size]),this._dispatch(Rl,{el:this._dragEl,pos:this._ghostProxyOffsets||s,finalPos:s,e,drag:this,selection:r,size:this._size,originalPos:{x:this._posAtDown.x,y:this._posAtDown.y}})}else this._moving||this._activeSelectorParams.dragAbort&&this._activeSelectorParams.dragAbort(this._elementToDrag)}},{key:"_dispatch",value:function(e,t){var r=null;if(this._activeSelectorParams&&this._activeSelectorParams[e])r=this._activeSelectorParams[e](t);else if(this.listeners[e])for(var s=0;s<this.listeners[e].length;s++)try{var l=this.listeners[e][s](t);l!=null&&(r=l)}catch{}return r}},{key:"resolveGrid",value:function(){var e={grid:null,thresholdX:ah/2,thresholdY:sh/2};return this._activeSelectorParams!=null&&this._activeSelectorParams.grid!=null&&(e.grid=this._activeSelectorParams.grid,this._activeSelectorParams.snapThreshold!=null&&(e.thresholdX=this._activeSelectorParams.snapThreshold,e.thresholdY=this._activeSelectorParams.snapThreshold)),e}},{key:"toGrid",value:function(e){var t=this.resolveGrid(),r=t.grid,s=t.thresholdX,l=t.thresholdY;if(r==null)return e;var u=r?r.w/2:s,d=r?r.h/2:l;return Jd(e,r,u,d)}},{key:"setUseGhostProxy",value:function(e){this._useGhostProxy=e?io:lh}},{key:"_doConstrain",value:function(e,t,r,s,l){return this._activeSelectorParams!=null&&this._activeSelectorParams.constrainFunction&&typeof this._activeSelectorParams.constrainFunction=="function"?this._activeSelectorParams.constrainFunction(e,t,r,s,l):e}},{key:"_testFilter",value:function(e){for(var t in this._filters){var r=this._filters[t],s=r[0](e);if(r[1]&&(s=!s),!s)return!1}return!0}},{key:"addFilter",value:function(e,t){var r=this;if(e){var s=eh(e);this._filters[s]=[function(l){var u=l.srcElement||l.target,d;return Le(e)?d=bn(u,e,r.el):typeof e=="function"&&(d=e(l,r.el)),d},t!==!1]}}},{key:"removeFilter",value:function(e){var t=typeof e=="function"?e._katavorioId:e;delete this._filters[t]}},{key:"clearAllFilters",value:function(){this._filters={}}},{key:"addSelector",value:function(e,t){e.selector&&(t?this._availableSelectors.unshift(e):this._availableSelectors.push(e))}},{key:"destroy",value:function(){this.eventManager.off(this.el,ue,this.downListener),this.eventManager.off(document,Ye,this.moveListener),this.eventManager.off(document,ce,this.upListener),this.downListener=null,this.upListener=null,this.moveListener=null,this.scrollTracker!=null&&document.removeEventListener("scroll",this.scrollTracker)}}]),n}(dh),vh=["input","textarea","select","button","option"],ph=vh.join(","),gh=function(){function o(a){$(this,o),c(this,"eventManager",void 0),c(this,"zoom",1),c(this,"css",{}),c(this,"inputFilterSelector",void 0),c(this,"positioningStrategy",void 0),c(this,"_positionSetter",void 0),c(this,"_positionGetter",void 0),c(this,"_sizeSetter",void 0),c(this,"_sizeGetter",void 0),a=a||{},this.inputFilterSelector=a.inputFilterSelector||ph,this.eventManager=new ta,this.zoom=a.zoom||1,this.positioningStrategy=a.positioningStrategy||Tt.absolutePosition,this._positionGetter=ra.get(this.positioningStrategy),this._positionSetter=ia.get(this.positioningStrategy),this._sizeGetter=aa.get(this.positioningStrategy),this._sizeSetter=oa.get(this.positioningStrategy);var n=a.css||{};K(this.css,n)}return Z(o,[{key:"getPosition",value:function(n){return this._positionGetter(n)}},{key:"setPosition",value:function(n,i){this._positionSetter(n,i)}},{key:"getSize",value:function(n){return this._sizeGetter(n)}},{key:"getZoom",value:function(){return this.zoom}},{key:"setZoom",value:function(n){this.zoom=n}},{key:"_prepareParams",value:function(n){n=n||{};var i={events:{}},e;for(e in n)i[e]=n[e];for(e=0;e<ro.length;e++)i.events[ro[e]]=n[ro[e]]||uh;return i}},{key:"getInputFilterSelector",value:function(){return this.inputFilterSelector}},{key:"setInputFilterSelector",value:function(n){return this.inputFilterSelector=n,this}},{key:"draggable",value:function(n,i){if(n._katavorioDrag==null){var e=this._prepareParams(i),t=new fh(n,e,this);return pn(n,Di.delegatedDraggable),n._katavorioDrag=t,t}else return n._katavorioDrag}},{key:"destroyDraggable",value:function(n){n._katavorioDrag&&(n._katavorioDrag.destroy(),delete n._katavorioDrag)}}]),o}(),mr="jtk-drag-selected",yh=function(){function o(a){$(this,o),this.instance=a,c(this,"_dragSelection",[]),c(this,"_dragSizes",new Map),c(this,"_dragElements",new Map),c(this,"_dragElementStartPositions",new Map),c(this,"_dragElementPositions",new Map),c(this,"__activeSet",void 0)}return Z(o,[{key:"_activeSet",get:function(){return this.__activeSet==null?this._dragSelection:this.__activeSet}},{key:"length",get:function(){return this._dragSelection.length}},{key:"filterActiveSet",value:function(n){var i=this;this.__activeSet=[],Q(this._dragSelection,function(e){n(e)&&i.__activeSet.push(e)})}},{key:"clear",value:function(){var n=this;this.reset(),Q(this._dragSelection,function(i){return n.instance.removeClass(i.jel,mr)}),this._dragSelection.length=0}},{key:"reset",value:function(){this._dragElementStartPositions.clear(),this._dragElementPositions.clear(),this._dragSizes.clear(),this._dragElements.clear(),this.__activeSet=null}},{key:"initialisePositions",value:function(){var n=this;Q(this._activeSet,function(i){var e=n.instance.viewport.getPosition(i.id),t={x:parseInt(""+i.jel.offsetLeft,10),y:parseInt(""+i.jel.offsetTop,10)};n._dragElementStartPositions.set(i.id,t),n._dragElementPositions.set(i.id,t),n._dragSizes.set(i.id,{w:e.w,h:e.h})})}},{key:"updatePositions",value:function(n,i,e){var t=this,r=n.x-i.x,s=n.y-i.y;Q(this._activeSet,function(l){var u=t._dragElementStartPositions.get(l.id);if(u){var d=u.x+r,h=u.y+s,f=t._dragSizes.get(l.id),g={x:d,y:h,w:f.w,h:f.h};if(l.jel._jsPlumbParentGroup&&l.jel._jsPlumbParentGroup.constrain){var y={w:l.jel.parentNode.offsetWidth+l.jel.parentNode.scrollLeft,h:l.jel.parentNode.offsetHeight+l.jel.parentNode.scrollTop};g.x=Math.max(g.x,0),g.y=Math.max(g.y,0),g.x=Math.min(g.x,y.w-f.w),g.y=Math.min(g.y,y.h-f.h)}t._dragElementPositions.set(l.id,{x:d,y:h}),l.jel.style.left=g.x+"px",l.jel.style.top=g.y+"px",e(l.jel,l.id,f,g)}})}},{key:"each",value:function(n){var i=this;Q(this._activeSet,function(e){var t=i._dragSizes.get(e.id),r=i._dragElementPositions.get(e.id),s=i._dragElementStartPositions.get(e.id);n(e.jel,e.id,r,t,s)})}},{key:"add",value:function(n,i){var e=n;i=i||this.instance.getId(e);var t=en(this._dragSelection,function(r){return r.id===i});t===-1&&(this.instance.addClass(n,mr),this._dragSelection.push({id:i,jel:e}))}},{key:"remove",value:function(n){var i=this,e=n;this._dragSelection=this._dragSelection.filter(function(t){var r=t.jel!==e;return r||i.instance.removeClass(t.jel,mr),r})}},{key:"toggle",value:function(n){var i=n,e=en(this._dragSelection,function(t){return t.jel===i});e!==-1?this.remove(i):this.add(n)}}]),o}(),mh="jtk-delegated-draggable",_h="jtk-draggable",Eh="jtk-drag",bh="jtk-ghost-proxy",Qt="jtk-drag-active",Ch="jtk-dragged",Jt="jtk-drag-hover",kh=function(){function o(a,n,i){var e=this;$(this,o),this.instance=a,this.dragSelection=n,c(this,"collicat",void 0),c(this,"drag",void 0),c(this,"_draggables",{}),c(this,"_dlist",[]),c(this,"_elementsWithEndpoints",{}),c(this,"_draggablesForElements",{}),c(this,"handlers",[]),c(this,"_trackScroll",void 0),c(this,"_filtersToAdd",[]),this.collicat=new gh({zoom:this.instance.currentZoom,css:{noSelect:this.instance.dragSelectClass,delegatedDraggable:mh,draggable:_h,drag:Eh,selected:mr,active:Qt,hover:Jt,ghostProxy:bh}}),this.instance.bind(El,function(t){e.collicat.setZoom(t)}),i=i||{},this._trackScroll=i.trackScroll!==!1}return Z(o,[{key:"addHandler",value:function(n,i){var e=this,t=K({selector:n.selector},i||{});t.start=er(t.start,function(l){return n.onStart(l)},!1),t.drag=er(t.drag,function(l){return n.onDrag(l)}),t.stop=er(t.stop,function(l){return n.onStop(l)});var r=(n.onBeforeStart||function(l){}).bind(n);if(t.beforeStart=er(t.beforeStart,function(l){return r(l)}),t.dragInit=function(l,u){return n.onDragInit(l,u)},t.dragAbort=function(l){return n.onDragAbort(l)},n.useGhostProxy&&(t.useGhostProxy=n.useGhostProxy,t.makeGhostProxy=n.makeGhostProxy),t.constrainFunction==null&&t.containment!=null)switch(t.containment){case Gi.notNegative:{t.constrainFunction=function(l,u,d,h){return{x:Math.max(0,Math.min(l.x)),y:Math.max(0,Math.min(l.y))}};break}case Gi.parent:{var s=t.containmentPadding||5;t.constrainFunction=function(l,u,d,h){var f=l.x<0?0:l.x>d.w-s?d.w-s:l.x,g=l.y<0?0:l.y>d.h-s?d.h-s:l.y;return{x:f,y:g}};break}case Gi.parentEnclosed:{t.constrainFunction=function(l,u,d,h){var f=l.x<0?0:l.x+h.w>d.w?d.w-h.w:l.x,g=l.y<0?0:l.y+h.h>d.h?d.h-h.h:l.y;return{x:f,y:g}};break}}this.drag==null?(t.trackScroll=this._trackScroll,this.drag=this.collicat.draggable(this.instance.getContainer(),t),Q(this._filtersToAdd,function(l){return e.drag.addFilter(l[0],l[1])}),this.drag.on(xr,function(l){e.instance.revalidate(l)})):this.drag.addSelector(t),this.handlers.push({handler:n,options:t}),n.init(this.drag)}},{key:"addSelector",value:function(n,i){this.drag&&this.drag.addSelector(n,i)}},{key:"addFilter",value:function(n,i){this.drag==null?this._filtersToAdd.push([n,i===!0]):this.drag.addFilter(n,i)}},{key:"removeFilter",value:function(n){this.drag!=null&&this.drag.removeFilter(n)}},{key:"setFilters",value:function(n){var i=this;Q(n,function(e){i.drag.addFilter(e[0],e[1])})}},{key:"reset",value:function(){var n=[];if(Q(this.handlers,function(t){t.handler.reset()}),this.handlers.length=0,this.drag!=null){var i=this.drag._filters;for(var e in i)n.push([e,i[e][1]]);this.collicat.destroyDraggable(this.instance.getContainer())}return delete this.drag,n}},{key:"setOption",value:function(n,i){var e=qo(this.handlers,function(t){return t.handler===n});e!=null&&K(e.options,i||{})}}]),o}();function xh(o,a){return Le(a)?{id:a,active:!0}:{id:a.id,active:a.active}}function Sh(o,a){var n=nl(o.members,function(i){return i.el===a});return n!==null?n.active===!0:!1}function Th(o){for(var a=[],n=o._jsPlumbParentGroup;n!=null;)a.push(n.el),n=n.group;return a}var To=function(){function o(a,n){$(this,o),this.instance=a,this._dragSelection=n,c(this,"selector","> "+Oe+":not("+kn(Br)+")"),c(this,"_dragOffset",null),c(this,"_groupLocations",[]),c(this,"_intersectingGroups",[]),c(this,"_currentDragParentGroup",null),c(this,"_dragGroupByElementIdMap",{}),c(this,"_dragGroupMap",{}),c(this,"_currentDragGroup",null),c(this,"_currentDragGroupOffsets",new Map),c(this,"_currentDragGroupSizes",new Map),c(this,"_currentDragGroupOriginalPositions",new Map),c(this,"_dragPayload",null),c(this,"drag",void 0),c(this,"originalPosition",void 0)}return Z(o,[{key:"onDragInit",value:function(n){return null}},{key:"onDragAbort",value:function(n){return null}},{key:"getDropGroup",value:function(){var n=null;if(this._intersectingGroups.length>0){var i=this._intersectingGroups[0].groupLoc.group,e=this._intersectingGroups[0].intersectingElement,t=e._jsPlumbParentGroup;t!==i&&(t==null||!t.overrideDrop(e,i))&&(n=this._intersectingGroups[0])}return n}},{key:"onStop",value:function(n){var i,e=this,t=n.drag.getDragElement(),r=this.getDropGroup(),s=[];s.push({el:t,id:this.instance.getId(t),pos:n.finalPos,originalGroup:t._jsPlumbParentGroup,redrawResult:null,originalPos:n.originalPos,reverted:!1,dropGroup:r!=null?r.groupLoc.group:null});function l(y,_,p,C,b){var m=p.x,S=p.y;if(y._jsPlumbParentGroup&&y._jsPlumbParentGroup.constrain){var w={w:y.parentNode.offsetWidth+y.parentNode.scrollLeft,h:y.parentNode.offsetHeight+y.parentNode.scrollTop};m=Math.max(m,0),S=Math.max(S,0),m=Math.min(m,w.w-C.w),S=Math.min(S,w.h-C.h),p.x=m,p.y=S}s.push({el:y,id:_,pos:p,originalPos:b,originalGroup:y._jsPlumbParentGroup,redrawResult:null,reverted:!1,dropGroup:r==null?void 0:r.groupLoc.group})}if(this._dragSelection.each(function(y,_,p,C,b){y!==n.el&&l(y,_,{x:p.x,y:p.y},C,b)}),(i=this._currentDragGroup)===null||i===void 0||i.members.forEach(function(y){if(y.el!==n.el){var _=e._currentDragGroupOffsets.get(y.elId),p=e._currentDragGroupSizes.get(y.elId),C={x:n.finalPos.x+_[0].x,y:n.finalPos.y+_[0].y};l(y.el,y.elId,C,p,e._currentDragGroupOriginalPositions.get(y.elId))}}),Q(s,function(y){var _=y.originalGroup!=null,p=_&&$a(e.instance,y.el,y.pos),C={x:0,y:0};if(_&&!p){if(r==null){var b=e._pruneOrOrphan(y,!0,!0);b.pos!=null?y.pos=b.pos.pos:!b.pruned&&y.originalGroup.revert&&(y.pos=y.originalPos,y.reverted=!0)}}else _&&p&&(C=e._computeOffsetByParentGroup(y.originalGroup));r!=null&&!p?e.instance.groupManager.addToGroup(r.groupLoc.group,!1,y.el):y.dropGroup=null,y.reverted&&e.instance.setPosition(y.el,y.pos),y.redrawResult=e.instance.setElementPosition(y.el,y.pos.x+C.x,y.pos.y+C.y),e.instance.removeClass(y.el,Ch),e.instance.select({source:y.el}).removeClass(e.instance.elementDraggingClass+" "+e.instance.sourceElementDraggingClass,!0),e.instance.select({target:y.el}).removeClass(e.instance.elementDraggingClass+" "+e.instance.targetElementDraggingClass,!0)}),s[0].originalGroup!=null){var u=t._jsPlumbParentGroup;if(u!==s[0].originalGroup){var d=n.drag.getDragElement(!0);if(s[0].originalGroup.ghost){var h=this.instance.getPosition(this.instance.getGroupContentArea(u)),f=this.instance.getPosition(this.instance.getGroupContentArea(s[0].originalGroup)),g={x:f.x+n.pos.x-h.x,y:f.y+n.pos.y-h.y};d.style.left=g.x+"px",d.style.top=g.y+"px",this.instance.revalidate(d)}}}this.instance.fire(Tl,{elements:s,e:n.e,el:t,payload:this._dragPayload}),this._cleanup()}},{key:"_cleanup",value:function(){var n=this;Q(this._groupLocations,function(i){n.instance.removeClass(i.el,Qt),n.instance.removeClass(i.el,Jt)}),this._currentDragParentGroup=null,this._groupLocations.length=0,this.instance.hoverSuspended=!1,this._dragOffset=null,this._dragSelection.reset(),this._dragPayload=null,this._currentDragGroupOffsets.clear(),this._currentDragGroupSizes.clear(),this._currentDragGroupOriginalPositions.clear(),this._currentDragGroup=null}},{key:"reset",value:function(){}},{key:"init",value:function(n){this.drag=n}},{key:"onDrag",value:function(n){var i=this,e=n.drag.getDragElement(),t=this.instance.getId(e),r=n.pos,s=this.instance.viewport.getPosition(t),l={x:r.x,y:r.y};this._intersectingGroups.length=0,this._dragOffset!=null&&(l.x+=this._dragOffset.x,l.y+=this._dragOffset.y);var u=function(f,g,y){if(y){var _=new Set;Q(i._groupLocations,function(p){!_.has(p.group.id)&&Ml(g,p.r)?(p.group!==i._currentDragParentGroup&&i.instance.addClass(p.el,Jt),i._intersectingGroups.push({groupLoc:p,intersectingElement:n.drag.getDragElement(!0),d:0}),Q(i.instance.groupManager.getAncestors(p.group),function(C){return _.add(C.id)})):i.instance.removeClass(p.el,Jt)})}i.instance.setElementPosition(f,g.x,g.y),i.instance.fire(nd,{el:f,e:n.e,pos:{x:g.x,y:g.y},originalPosition:i.originalPosition,payload:i._dragPayload})},d={x:l.x,y:l.y,w:s.w,h:s.h};u(e,d,!0),this._dragSelection.updatePositions(r,this.originalPosition,function(h,f,g,y){u(h,y,!1)}),this._currentDragGroupOffsets.forEach(function(h,f){var g=i._currentDragGroupSizes.get(f),y={x:d.x+h[0].x,y:d.y+h[0].y,w:g.w,h:g.h};h[1].style.left=y.x+"px",h[1].style.top=y.y+"px",u(h[1],y,!1)})}},{key:"_computeOffsetByParentGroup",value:function(n){var i=this.instance.getPosition(n.el),e=n.contentArea;if(e!==n.el){var t=this.instance.getPosition(e);i.x+=t.x,i.y+=t.y}if(n.el._jsPlumbParentGroup){var r=this._computeOffsetByParentGroup(n.el._jsPlumbParentGroup);i.x+=r.x,i.y+=r.y}return i}},{key:"onStart",value:function(n){var i=this,e=n.drag.getDragElement(),t=this.instance.getPosition(e);this.originalPosition={x:n.pos.x,y:n.pos.y},e._jsPlumbParentGroup&&(this._dragOffset=this._computeOffsetByParentGroup(e._jsPlumbParentGroup),this._currentDragParentGroup=e._jsPlumbParentGroup);var r=!0,s=e.getAttribute(vr);if((this.instance.elementsDraggable===!1||s!=null&&s!==Yn)&&(r=!1),r){this._groupLocations.length=0,this._intersectingGroups.length=0,this.instance.hoverSuspended=!0;var l=n.drag.getDragElement(!0),u=l.querySelectorAll(Oe),d=Th(l),h=[];Array.prototype.push.apply(h,u),Array.prototype.push.apply(h,d),this._dragSelection.filterActiveSet(function(_){return h.indexOf(_.jel)===-1}),this._dragSelection.initialisePositions();var f=function(p,C,b){if(!p._isJsPlumbGroup||i.instance.allowNestedGroups){var m=!p._jsPlumbParentGroup,S=m||p._jsPlumbParentGroup.dropOverride!==!0,w=!m&&(p._jsPlumbParentGroup.ghost||p._jsPlumbParentGroup.constrain!==!0);(m||S&&w)&&(Q(i.instance.groupManager.getGroups(),function(O){var I=p._jsPlumbGroup;if(O.droppable!==!1&&O.enabled!==!1&&p._jsPlumbGroup!==O&&!i.instance.groupManager.isDescendant(O,I)){var A=O.el,V=i.instance.getId(A),B=i.instance.viewport.getPosition(V),H={x:B.x,y:B.y,w:B.w,h:B.h},R={el:A,r:H,group:O};i._groupLocations.push(R),O!==i._currentDragParentGroup&&i.instance.addClass(A,Qt)}}),i._groupLocations.sort(function(O,I){return i.instance.groupManager.isDescendant(O.group,I.group)?-1:i.instance.groupManager.isAncestor(I.group,O.group)?1:0}))}return i.instance.select({source:p}).addClass(i.instance.elementDraggingClass+" "+i.instance.sourceElementDraggingClass,!0),i.instance.select({target:p}).addClass(i.instance.elementDraggingClass+" "+i.instance.targetElementDraggingClass,!0),i.instance.fire(id,{el:p,e:n.e,originalPosition:i.originalPosition,pos:i.originalPosition,dragGroup:C,dragGroupMemberSpec:b})},g=this.instance.getId(e);this._currentDragGroup=this._dragGroupByElementIdMap[g],this._currentDragGroup&&!Sh(this._currentDragGroup,e)&&(this._currentDragGroup=null);var y=f(e);if(y===!1)return this._cleanup(),!1;this._dragPayload=y,this._currentDragGroup!=null&&(this._currentDragGroupOffsets.clear(),this._currentDragGroupSizes.clear(),this._currentDragGroup.members.forEach(function(_){var p=i.instance.viewport.getPosition(_.elId);i._currentDragGroupOffsets.set(_.elId,[{x:p.x-t.x,y:p.y-t.y},_.el]),i._currentDragGroupSizes.set(_.elId,p),i._currentDragGroupOriginalPositions.set(_.elId,{x:p.x,y:p.y}),f(_.el,i._currentDragGroup,_)}))}return r}},{key:"addToDragGroup",value:function(n){var i=this,e=xh(this.instance,n),t=this._dragGroupMap[e.id];t==null&&(t={id:e.id,members:new Set},this._dragGroupMap[e.id]=t);for(var r=arguments.length,s=new Array(r>1?r-1:0),l=1;l<r;l++)s[l-1]=arguments[l];this.removeFromDragGroup.apply(this,s),Q(s,function(u){var d=i.instance.getId(u);t.members.add({elId:d,el:u,active:e.active}),i._dragGroupByElementIdMap[d]=t})}},{key:"removeFromDragGroup",value:function(){for(var n=this,i=arguments.length,e=new Array(i),t=0;t<i;t++)e[t]=arguments[t];Q(e,function(r){var s=n.instance.getId(r),l=n._dragGroupByElementIdMap[s];if(l!=null){var u=new Set;l.members.forEach(function(d){d.el!==r&&u.add(d)}),l.members=u,delete n._dragGroupByElementIdMap[s]}})}},{key:"setDragGroupState",value:function(n){for(var i=this,e=arguments.length,t=new Array(e>1?e-1:0),r=1;r<e;r++)t[r-1]=arguments[r];var s=t.map(function(l){return i.instance.getId(l)});Q(s,function(l){var u=i._dragGroupByElementIdMap[l];if(u!=null){var d=nl(u.members,function(h){return h.elId===l});d!=null&&(d.active=n)}})}},{key:"clearDragGroup",value:function(n){var i=this,e=this._dragGroupMap[n];e!=null&&(e.members.forEach(function(t){delete i._dragGroupByElementIdMap[t.elId]}),e.members.clear())}},{key:"_pruneOrOrphan",value:function(n,i,e){var t=n.el,r={pruned:!1,pos:null};if(e||!$a(this.instance,t,n.pos)){var s=t._jsPlumbParentGroup;s.prune?(t._isJsPlumbGroup?this.instance.removeGroup(t._jsPlumbGroup):s.remove(n.el,!0),r.pruned=!0):s.orphan&&(r.pos=this.instance.groupManager.orphan(n.el,i),t._isJsPlumbGroup?s.removeGroup(t._jsPlumbGroup):s.remove(n.el))}return r}}]),o}(),Xa={},Wa={},Ka={},Zt={get:function(a,n,i){var e=Xa[n];if(e)return new e(a,i);throw{message:"jsPlumb: unknown endpoint type '"+n+"'"}},clone:function(a){var n=Ka[a.type];return Zt.get(a.endpoint,a.type,n.getParams(a))},compute:function(a,n,i,e){var t=Wa[a.type];if(t!=null)return t(a,n,i,e);Be("jsPlumb: cannot find endpoint calculator for endpoint of type ",a.type)},registerHandler:function(a){Ka[a.type]=a,Xa[a.type]=a.cls,Wa[a.type]=a.compute}},ci=function(){function o(a,n){$(this,o),this.endpoint=a,c(this,"typeId",void 0),c(this,"x",void 0),c(this,"y",void 0),c(this,"w",void 0),c(this,"h",void 0),c(this,"computedValue",void 0),c(this,"bounds",Sr()),c(this,"classes",[]),c(this,"instance",void 0),c(this,"type",void 0),n=n||{},this.instance=a.instance,a.cssClass&&this.classes.push(a.cssClass),n.cssClass&&this.classes.push(n.cssClass)}return Z(o,[{key:"addClass",value:function(n){this.classes.push(n),this.instance.addEndpointClass(this.endpoint,n)}},{key:"removeClass",value:function(n){this.classes=this.classes.filter(function(i){return i!==n}),this.instance.removeEndpointClass(this.endpoint,n)}},{key:"compute",value:function(n,i,e){this.computedValue=Zt.compute(this,n,i,e),this.bounds.xmin=this.x,this.bounds.ymin=this.y,this.bounds.xmax=this.x+this.w,this.bounds.ymax=this.y+this.h}},{key:"setVisible",value:function(n){this.instance.setEndpointVisible(this.endpoint,n)}}]),o}(),Ln,Nn,Rn,ii;(function(o){o.top="top",o.left="left",o.right="right",o.bottom="bottom"})(ii||(ii={}));var Re=ii.top,et=ii.left,Ke=ii.right,at=ii.bottom,Ph=[et,Ke],Ah=[Re,at],wh=function(){function o(a,n,i){$(this,o),this.instance=a,this.element=n,c(this,"isFloating",!0),c(this,"isContinuous",void 0),c(this,"isDynamic",void 0),c(this,"locations",[]),c(this,"currentLocation",0),c(this,"locked",!1),c(this,"cssClass",""),c(this,"timestamp",null),c(this,"type","Floating"),c(this,"id",He()),c(this,"orientation",[0,0]),c(this,"size",void 0),this.size=a.viewport.getPosition(i),this.locations.push({x:.5,y:.5,ox:this.orientation[0],oy:this.orientation[1],offx:0,offy:0,iox:this.orientation[0],ioy:this.orientation[1],cls:""})}return Z(o,[{key:"_updateOrientationInRouter",value:function(){this.instance.router.setAnchorOrientation(this,[this.locations[0].ox,this.locations[0].oy])}},{key:"over",value:function(n){this.orientation=this.instance.router.getEndpointOrientation(n),this.locations[0].ox=this.orientation[0],this.locations[0].oy=this.orientation[1],this._updateOrientationInRouter()}},{key:"out",value:function(){this.orientation=null,this.locations[0].ox=this.locations[0].iox,this.locations[0].oy=this.locations[0].ioy,this._updateOrientationInRouter()}}]),o}(),Qa=(Ln={},c(Ln,Re,at),c(Ln,Ke,et),c(Ln,et,Ke),c(Ln,at,Re),Ln),Fl=(Nn={},c(Nn,Re,Ke),c(Nn,Ke,at),c(Nn,et,Re),c(Nn,at,et),Nn),jl=(Rn={},c(Rn,Re,et),c(Rn,Ke,Re),c(Rn,et,at),c(Rn,at,Ke),Rn);function Dh(o){return o.faces.length===0?Re:o.faces[0]}function Oi(o,a){return o.faces.indexOf(a)!==-1}function Oh(o,a){return(o.clockwise?Fl:jl)[a]}function Mh(o,a){return(o.clockwise?jl:Fl)[a]}function Ja(o,a){return o.lockedAxis==null?o.lockedFace==null?Oi(o,a)===!0:o.lockedFace===a:o.lockedAxis.indexOf(a)!==-1}function Ih(o,a){if(Oi(o,a))return a;if(Oi(o,Qa[a]))return Qa[a];var n=Oh(o,a);if(Oi(o,n))return n;var i=Mh(o,a);return Oi(o,i)?i:a}var Za={x:.5,y:0,ox:0,oy:-1,offx:0,offy:0},es={x:.5,y:1,ox:0,oy:1,offx:0,offy:0},ts={x:0,y:.5,ox:-1,oy:0,offx:0,offy:0},ns={x:1,y:.5,ox:1,oy:0,offx:0,offy:0},Lh={x:0,y:0,ox:0,oy:-1,offx:0,offy:0},Nh={x:1,y:0,ox:1,oy:-1,offx:0,offy:0},Rh={x:0,y:1,ox:0,oy:1,offx:0,offy:0},Gh={x:1,y:1,ox:0,oy:1,offx:0,offy:0},Fh={x:.5,y:.5,ox:0,oy:0,offx:0,offy:0},Vl={Top:[Za],Bottom:[es],Left:[ts],Right:[ns],TopLeft:[Lh],TopRight:[Nh],BottomLeft:[Rh],BottomRight:[Gh],Center:[Fh],AutoDefault:[Za,ts,es,ns]},jh={Continuous:{faces:[Re,et,at,Ke]},ContinuousTop:{faces:[Re]},ContinuousRight:{faces:[Ke]},ContinuousBottom:{faces:[at]},ContinuousLeft:{faces:[et]},ContinuousLeftRight:{faces:[et,Ke]},ContinuousTopBottom:{faces:[Re,at]}};function is(o,a){if(a=a||{},o===Dt.Perimeter)return $h(a);var n=Vl[o];if(n!=null)return Dr(o,rl(n,function(i){return K({iox:i.ox,ioy:i.oy},i)}),a);if(n=jh[o],n!=null)return Bh(o,n.faces,a);throw{message:"jsPlumb: unknown anchor type '"+o+"'"}}function Dr(o,a,n){return{type:o,locations:a,currentLocation:0,locked:!1,id:He(),isFloating:!1,isContinuous:!1,isDynamic:a.length>1,timestamp:null,cssClass:n.cssClass||""}}function Vh(o,a,n){return new wh(o,a,n)}var Uh="currentFace";function Bh(o,a,n){var i={type:o,locations:[],currentLocation:0,locked:!1,id:He(),cssClass:n.cssClass||"",isFloating:!1,isContinuous:!0,timestamp:null,faces:n.faces||a,lockedFace:null,lockedAxis:null,clockwise:n.clockwise!==!1,__currentFace:null};return Object.defineProperty(i,Uh,{get:function(){return this.__currentFace},set:function(t){this.__currentFace=Ih(this,t)}}),i}function rs(o){return o.length<7&&o.every(yo)||o.length===7&&o.slice(0,5).every(yo)&&Le(o[6])}function Mi(o){if(Le(o))return is(o,null);if(Array.isArray(o))if(rs(o)){var a=o;return Dr(null,[{x:a[0],y:a[1],ox:a[2],oy:a[3],offx:a[4]==null?0:a[4],offy:a[5]==null?0:a[5],iox:a[2],ioy:a[3],cls:a[6]||""}],{cssClass:a[6]||""})}else{var n=rl(o,function(e){if(Le(e)){var t=Vl[e];return t!=null?K({iox:t[0].ox,ioy:t[0].oy,cls:""},t[0]):null}else if(rs(e))return{x:e[0],y:e[1],ox:e[2],oy:e[3],offx:e[4]==null?0:e[4],offy:e[5]==null?0:e[5],iox:e[2],ioy:e[3],cls:e[6]||""}}).filter(function(e){return e!=null});return Dr("Dynamic",n,{})}else{var i=o;return is(i.type,i.options)}}function Ul(o){for(var a=.5,n=Math.PI*2/o,i=[],e=0,t=0;t<o;t++){var r=a+a*Math.sin(e),s=a+a*Math.cos(e);i.push({x:r,y:s,ox:0,oy:0,offx:0,offy:0,iox:0,ioy:0,cls:""}),e+=n}return i}function Hh(o,a){for(var n=a/o.length,i=[],e=function(s,l,u,d,h,f,g){n=a*h;for(var y=(u-s)/n,_=(d-l)/n,p=0;p<n;p++)i.push({x:s+y*p,y:l+_*p,ox:f==null?0:f,oy:g==null?0:g,offx:0,offy:0,iox:0,ioy:0,cls:""})},t=0;t<o.length;t++)e.apply(null,o[t]);return i}function sa(o,a){for(var n=[],i=0;i<o.length;i++)n.push([o[i][0],o[i][1],o[i][2],o[i][3],1/o.length,o[i][4],o[i][5]]);return Hh(n,a)}function Bl(o){return sa([[0,0,1,0,0,-1],[1,0,1,1,1,0],[1,1,0,1,0,1],[0,1,0,0,-1,0]],o)}function qh(o){return sa([[.5,0,1,.5],[1,.5,.5,1],[.5,1,0,.5],[0,.5,.5,0]],o)}function Yh(o){return sa([[.5,0,1,1],[1,1,0,1],[0,1,.5,0]],o)}function zh(o,a){for(var n=[],i=a/180*Math.PI,e=0;e<o.length;e++){var t=o[e].x-.5,r=o[e].y-.5;n.push({x:.5+(t*Math.cos(i)-r*Math.sin(i)),y:.5+(t*Math.sin(i)+r*Math.cos(i)),ox:o[e].ox,oy:o[e].oy,offx:0,offy:0,iox:0,ioy:0,cls:""})}return n}var nn=new Map;nn.set(tn.Circle,Ul);nn.set(tn.Ellipse,Ul);nn.set(tn.Rectangle,Bl);nn.set(tn.Square,Bl);nn.set(tn.Diamond,qh);nn.set(tn.Triangle,Yh);function $h(o){o=o||{};var a=o.anchorCount||60,n=o.shape;if(!n)throw new Error("no shape supplied to Perimeter Anchor type");if(!nn.has(n))throw new Error("Shape ["+n+"] is unknown by Perimeter Anchor type");var i=nn.get(n)(a);o.rotation&&(i=zh(i,o.rotation));var e=Dr(Dt.Perimeter,i,o),t=K(e,{shape:n});return t}var os=function(){function o(a,n){var i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1;$(this,o),this.selector=a,this.def=n,this.exclude=i,c(this,"id",void 0),c(this,"redrop",void 0),this.id=He(),this.redrop=n.def.redrop||Hl}return Z(o,[{key:"setEnabled",value:function(n){this.def.enabled=n}},{key:"isEnabled",value:function(){return this.def.enabled!==!1}}]),o}(),Hl="strict",Xh="any",Wh="anySource",Kh="anyTarget",Qh="anySourceOrTarget";function Jh(o,a,n,i,e,t){var r=Vh(t,i,e),s={paintStyle:o.getPaintStyle(),preparedAnchor:r,element:i,scope:o.scope,cssClass:[Xo,o.cssClass].join(" ")};a!=null&&(ol(a,ci)?s.existingEndpoint=a:s.endpoint=a);var l=t._internal_newEndpoint(s);return t._paintEndpoint(l,{}),l}function Zh(o,a,n,i,e){for(var t=o.target||o.srcElement,r=!1,s=i.getSelector(a,n),l=0;l<s.length;l++)if(s[l]===t){r=!0;break}return e?!r:r}var ef=kn(Qt,Jt),as="sourceSelectorEndpoint",ss=function(){function o(a){$(this,o),this.instance=a,c(this,"jpc",void 0),c(this,"existingJpc",void 0),c(this,"_originalAnchorSpec",void 0),c(this,"ep",void 0),c(this,"endpointRepresentation",void 0),c(this,"canvasElement",void 0),c(this,"_activeDefinition",void 0),c(this,"placeholderInfo",{id:null,element:null}),c(this,"floatingIndex",void 0),c(this,"floatingId",void 0),c(this,"floatingElement",void 0),c(this,"floatingEndpoint",void 0),c(this,"floatingAnchor",void 0),c(this,"_stopped",void 0),c(this,"inPlaceCopy",void 0),c(this,"endpointDropTargets",[]),c(this,"currentDropTarget",null),c(this,"payload",void 0),c(this,"floatingConnections",{}),c(this,"_forceReattach",void 0),c(this,"_forceDetach",void 0),c(this,"mousedownHandler",void 0),c(this,"mouseupHandler",void 0),c(this,"selector",kn(Wn));var n=a.getContainer();this.mousedownHandler=this._mousedownHandler.bind(this),this.mouseupHandler=this._mouseupHandler.bind(this),a.on(n,ue,Oe,this.mousedownHandler),a.on(n,ce,[Oe,kn(Wn)].join(","),this.mouseupHandler)}return Z(o,[{key:"_resolveDragParent",value:function(n,i){var e=this.instance.getContainer(),t=Gt(i,Oe,e,!0);if(n.parentSelector!=null){var r=Gt(i,n.parentSelector,e,!0);return r!=null&&(t=Gt(r.parentNode,Oe,e,!1)),r||t}else return t}},{key:"_mousedownHandler",value:function(n){var i,e;if(!(n.which===3||n.button===2)){var t=n.target||n.srcElement;if(e=this._getSourceDefinition(n),!(e!=null&&(i=this._resolveDragParent(e.def.def,t),i==null||i.getAttribute(ir)===Yn))&&e){var r=n.currentTarget,s;if(t.getAttribute(ir)!==Yn){if(Fi(n),this._activeDefinition=e,s=e.def.def,s.canAcceptNewConnection!=null&&!s.canAcceptNewConnection(i,n))return!1;var l=ks(n,i,this.instance.currentZoom),u={element:i};if(K(u,s),u.isTemporarySource=!0,s.scope)u.scope=s.scope;else{var d=t.getAttribute(to);d!=null&&(u.scope=d)}var h=s.parameterExtractor?s.parameterExtractor(i,t,n):{};if(u=br(u,h),u.maxConnections!=null&&u.maxConnections>=0){var f=this.instance.select({source:i}).length;if(f>=u.maxConnections)return Fi(n),s.onMaxConnections&&s.onMaxConnections({element:i,maxConnections:u.maxConnections},n),n.stopImmediatePropagation&&n.stopImmediatePropagation(),!1}if(s.anchorPositionFinder){var g=s.anchorPositionFinder(i,l,s,n);g!=null&&(u.anchor=g)}this._originalAnchorSpec=u.anchor||(this.instance.areDefaultAnchorsSet()?this.instance.defaults.anchors[0]:this.instance.defaults.anchor);var y=this.instance.router.prepareAnchor(this._originalAnchorSpec),_=[l.x,l.y,0,0];if(y.locations.length>0)_[2]=y.locations[0].ox,_[3]=y.locations[0].oy;else if(y.isContinuous){var p=l.x<.5?l.x:1-l.x,C=l.y<.5?l.y:1-l.y;_[2]=p<C?l.x<.5?-1:1:0,_[3]=C<p?l.y<.5?-1:1:0}u.anchor=_,u.deleteOnEmpty=!0,this.ep=this.instance._internal_newEndpoint(u);var b={};if(s.extract){for(var m in s.extract){var S=t.getAttribute(m);S&&(b[s.extract[m]]=S)}this.ep.mergeParameters(b)}if(u.uniqueEndpoint){var w=this.ep.elementId,O=this.instance.getManagedData(w,as,e.id);O==null?(this.instance.setManagedData(w,as,e.id,this.ep),this.ep.deleteOnEmpty=!1):this.ep.finalEndpoint=O}r._jsPlumbOrphanedEndpoints=r._jsPlumbOrphanedEndpoints||[],r._jsPlumbOrphanedEndpoints.push(this.ep),this.instance.trigger(this.ep.endpoint.canvas,ue,n,b)}}}}},{key:"_mouseupHandler",value:function(n){var i=n.currentTarget||n.srcElement;i._jsPlumbOrphanedEndpoints&&(lc(i._jsPlumbOrphanedEndpoints,this.instance._maybePruneEndpoint.bind(this.instance)),i._jsPlumbOrphanedEndpoints.length=0),this._activeDefinition=null}},{key:"onDragInit",value:function(n){var i=tr(n,this.instance),e=mi(n,this.instance);return this._makeDraggablePlaceholder(i,e),this.placeholderInfo.element.jtk=n.jtk,this.placeholderInfo.element}},{key:"onDragAbort",value:function(n){this._cleanupDraggablePlaceholder()}},{key:"_makeDraggablePlaceholder",value:function(n,i){this.placeholderInfo=this.placeholderInfo||{};var e=sl(Sl,{position:"absolute"});this.instance._appendElementToContainer(e);var t=this.instance.getId(e);return this.instance.setPosition(e,n),e.style.width=i.w+"px",e.style.height=i.h+"px",this.instance.manage(e),this.placeholderInfo.id=t,this.placeholderInfo.element=e,e}},{key:"_cleanupDraggablePlaceholder",value:function(){this.placeholderInfo.element&&(this.instance.unmanage(this.placeholderInfo.element,!0),delete this.placeholderInfo.element,delete this.placeholderInfo.id)}},{key:"reset",value:function(){var n=this.instance.getContainer();this.instance.off(n,ce,this.mouseupHandler),this.instance.off(n,ue,this.mousedownHandler)}},{key:"init",value:function(n){}},{key:"startNewConnectionDrag",value:function(n,i){this.jpc=this.instance._newConnection({sourceEndpoint:this.ep,targetEndpoint:this.floatingEndpoint,source:this.ep.element,target:this.placeholderInfo.element,paintStyle:this.ep.connectorStyle,hoverPaintStyle:this.ep.connectorHoverStyle,connector:this.ep.connector,overlays:this.ep.connectorOverlays,type:this.ep.edgeType,cssClass:this.ep.connectorClass,hoverClass:this.ep.connectorHoverClass,scope:n,data:i}),this.jpc.pending=!0,this.jpc.addClass(this.instance.draggingClass),this.ep.addClass(this.instance.draggingClass),this.instance.fire(Ua,this.jpc)}},{key:"startExistingConnectionDrag",value:function(){this.existingJpc=!0,this.instance.setHover(this.jpc,!1);var n=this.jpc.endpoints[0].id===this.ep.id?0:1;this.ep.detachFromConnection(this.jpc,null,!0),this.floatingEndpoint.addConnection(this.jpc),this.instance.fire(Ua,this.jpc),this.instance.sourceOrTargetChanged(this.jpc.endpoints[n].elementId,this.placeholderInfo.id,this.jpc,this.placeholderInfo.element,n),this.jpc.suspendedEndpoint=this.jpc.endpoints[n],this.jpc.suspendedElement=this.jpc.endpoints[n].element,this.jpc.suspendedElementId=this.jpc.endpoints[n].elementId,this.jpc.suspendedElementType=n===0?Eo:ul,this.instance.setHover(this.jpc.suspendedEndpoint,!1),this.floatingEndpoint.referenceEndpoint=this.jpc.suspendedEndpoint,this.floatingEndpoint.mergeParameters(this.jpc.suspendedEndpoint.parameters),this.jpc.endpoints[n]=this.floatingEndpoint,this.jpc.addClass(this.instance.draggingClass),this.floatingId=this.placeholderInfo.id,this.floatingIndex=n,this.instance._refreshEndpoint(this.ep)}},{key:"_shouldStartDrag",value:function(){var n=!0;this.ep.enabled||(n=!1),this.jpc==null&&!this.ep.isSource&&!this.ep.isTemporarySource&&(n=!1),this.ep.isSource&&this.ep.isFull()&&!(this.jpc!=null&&this.ep.dragAllowedWhenFull)&&(n=!1),this.jpc!=null&&!this.jpc.isDetachable(this.ep)&&(this.ep.isFull()?n=!1:this.jpc=null);var i={},e=this.instance.checkCondition(this.jpc==null?Vc:Uc,{endpoint:this.ep,source:this.ep.element,sourceId:this.ep.elementId,connection:this.jpc});return e===!1?n=!1:Xn(e)==="object"?(i=e,K(i,this.payload||{})):i=this.payload||{},[n,i]}},{key:"_createFloatingEndpoint",value:function(n){var i=this.ep.endpoint;if(this.ep.edgeType!=null){var e=this.instance._deriveEndpointAndAnchorSpec(this.ep.edgeType);i=e.endpoints[1]}this.floatingEndpoint=Jh(this.ep,i,n,this.placeholderInfo.element,this.placeholderInfo.id,this.instance),this.floatingAnchor=this.floatingEndpoint._anchor,this.floatingEndpoint.deleteOnEmpty=!0,this.floatingElement=this.floatingEndpoint.endpoint.canvas,this.floatingId=this.instance.getId(this.floatingElement)}},{key:"_populateTargets",value:function(n,i){var e=this,t=this.jpc&&this.jpc.endpoints[0]===this.ep,r,s=this.instance.getContainer().querySelectorAll([".",Wn,"[",dl,this.ep.scope,"]:not(.",Xo,")"].join(""));if(Q(s,function(h){if((e.jpc!=null||h!==n)&&h!==e.floatingElement&&(e.jpc!=null||!h.jtk.endpoint.isFull())&&(t&&h.jtk.endpoint.isSource||!t&&h.jtk.endpoint.isTarget)){var f=tr(h,e.instance),g=mi(h,e.instance);r={x:f.x,y:f.y,w:g.w,h:g.h},e.endpointDropTargets.push({el:h,targetEl:h,r,endpoint:h.jtk.endpoint,def:null}),e.instance.addClass(h,Qt)}}),t){var l=qo(this.instance.sourceSelectors,function(h){return h.isEnabled()&&(h.def.def.scope==null||h.def.def.scope===e.ep.scope)});if(l!=null){var u=this._findTargetZones(l);Q(u,function(h){if(h.getAttribute(ir)!==Yn){var f=h.getAttribute(to);if(f!=null&&f!==e.ep.scope)return;var g={r:null,el:h};g.targetEl=Gt(h,Oe,e.instance.getContainer(),!0);var y=tr(g.el,e.instance),_=mi(g.el,e.instance);g.r={x:y.x,y:y.y,w:_.w,h:_.h},l.def.def.rank!=null&&(g.rank=l.def.def.rank),g.def=l.def,e.endpointDropTargets.push(g),e.instance.addClass(g.targetEl,Qt)}})}}else{var d=ac(this.instance.targetSelectors,function(h){return h.isEnabled()});d.forEach(function(h){var f=e._findTargetZones(h);Q(f,function(g){if(g.getAttribute(ir)!==Yn){var y=g.getAttribute(to);if(y!=null&&y!==e.ep.scope)return;var _={r:null,el:g};if(h.def.def.parentSelector!=null&&(_.targetEl=Gt(g,h.def.def.parentSelector,e.instance.getContainer(),!0)),_.targetEl==null&&(_.targetEl=Gt(g,Oe,e.instance.getContainer(),!0)),(h.def.def.allowLoopback===!1||e._activeDefinition&&e._activeDefinition.def.def.allowLoopback===!1)&&_.targetEl===e.ep.element||h.def.def.canAcceptNewConnection!=null&&!h.def.def.canAcceptNewConnection(_.targetEl,i))return;var p=h.def.def.maxConnections;if(p!=null&&p!==-1&&e.instance.select({target:_.targetEl}).length>=p)return;var C=tr(g,e.instance),b=mi(g,e.instance);_.r={x:C.x,y:C.y,w:b.w,h:b.h},_.def=h.def,h.def.def.rank!=null&&(_.rank=h.def.def.rank),e.endpointDropTargets.push(_),e.instance.addClass(_.targetEl,Qt)}})})}this.endpointDropTargets.sort(function(h,f){if(h.targetEl._isJsPlumbGroup&&!f.targetEl._isJsPlumbGroup)return 1;if(!h.targetEl._isJsPlumbGroup&&f.targetEl._isJsPlumbGroup)return-1;if(h.targetEl._isJsPlumbGroup&&f.targetEl._isJsPlumbGroup){if(e.instance.groupManager.isAncestor(h.targetEl._jsPlumbGroup,f.targetEl._jsPlumbGroup))return-1;if(e.instance.groupManager.isAncestor(f.targetEl._jsPlumbGroup,h.targetEl._jsPlumbGroup))return 1}else if(h.rank!=null&&f.rank!=null){if(h.rank>f.rank)return-1;if(h.rank<f.rank)return 1}else return 0})}},{key:"_findTargetZones",value:function(n){var i;if(n.redrop===Xh){var e=this.instance.targetSelectors.map(function(r){return r.selector});e.push.apply(e,Jn(this.instance.sourceSelectors.map(function(r){return r.selector}))),e.push(Oe),i=e.join(",")}else if(n.redrop===Hl)i=n.selector;else if(n.redrop===Wh)i=this.instance.sourceSelectors.map(function(r){return r.selector}).join(",");else if(n.redrop===Kh)i=this.instance.targetSelectors.map(function(r){return r.selector}).join(",");else if(n.redrop===Qh){var t=this.instance.targetSelectors.map(function(r){return r.selector});t.push.apply(t,Jn(this.instance.sourceSelectors.map(function(r){return r.selector}))),i=t.join(",")}return this.instance.getContainer().querySelectorAll(i)}},{key:"onStart",value:function(n){this.endpointDropTargets.length=0,this.currentDropTarget=null,this._stopped=!1;var i=n.drag.getDragElement();if(this.ep=i.jtk.endpoint,!this.ep)return!1;this.endpointRepresentation=this.ep.endpoint,this.canvasElement=this.endpointRepresentation.canvas,this.jpc=this.ep.connectorSelector();var e=this._shouldStartDrag(),t=fr(e,2),r=t[0],s=t[1];if(r===!1)return this._stopped=!0,!1;this.instance.setHover(this.ep,!1),this.instance.isConnectionBeingDragged=!0,this.jpc&&!this.ep.isFull()&&this.ep.isSource&&(this.jpc=null),this._createFloatingEndpoint(this.canvasElement),this._populateTargets(this.canvasElement,n.e),this.jpc==null?this.startNewConnectionDrag(this.ep.scope,s):this.startExistingConnectionDrag(),this._registerFloatingConnection(this.placeholderInfo,this.jpc),this.instance.currentlyDragging=!0}},{key:"onBeforeStart",value:function(n){this.payload=n.e.payload||{}}},{key:"onDrag",value:function(n){if(this._stopped)return!0;if(this.placeholderInfo.element){var i=mi(this.floatingElement,this.instance);this.instance.setElementPosition(this.placeholderInfo.element,n.pos.x,n.pos.y);for(var e={x:n.pos.x,y:n.pos.y,w:i.w,h:i.h},t,r,s,l=0;l<this.endpointDropTargets.length;l++)if(Ml(e,this.endpointDropTargets[l].r)){t=this.endpointDropTargets[l];break}if(t!==this.currentDropTarget&&this.currentDropTarget!=null&&(r=this._getFloatingAnchorIndex(),this.instance.removeClass(this.currentDropTarget.el,Jt),this.currentDropTarget.endpoint&&(this.currentDropTarget.endpoint.endpoint.removeClass(this.instance.endpointDropAllowedClass),this.currentDropTarget.endpoint.endpoint.removeClass(this.instance.endpointDropForbiddenClass)),this.floatingAnchor.out()),t!=null&&(this.instance.addClass(t.el,Jt),r=this._getFloatingAnchorIndex(),t.endpoint!=null))if(s=t.endpoint.isSource&&r===0||t.endpoint.isTarget&&r!==0||this.jpc.suspendedEndpoint&&t.endpoint.referenceEndpoint&&t.endpoint.referenceEndpoint.id===this.jpc.suspendedEndpoint.id,s){var u=this.instance.checkCondition(bc,{sourceEndpoint:this.jpc.endpoints[r],targetEndpoint:t.endpoint.endpoint,connection:this.jpc});u?(t.endpoint.endpoint.addClass(this.instance.endpointDropAllowedClass),t.endpoint.endpoint.removeClass(this.instance.endpointDropForbiddenClass)):(t.endpoint.endpoint.removeClass(this.instance.endpointDropAllowedClass),t.endpoint.endpoint.addClass(this.instance.endpointDropForbiddenClass)),this.floatingAnchor.over(t.endpoint),this.instance._paintConnection(this.jpc)}else t=null;this.currentDropTarget=t}}},{key:"_maybeCleanup",value:function(n){n._mtNew&&n.connections.length===0?this.instance.deleteEndpoint(n):delete n._mtNew}},{key:"_reattachOrDiscard",value:function(n){var i=this.jpc.suspendedEndpoint!=null,e=this._getFloatingAnchorIndex();return i&&this._shouldReattach()?(e===0?(this.jpc.source=this.jpc.suspendedElement,this.jpc.sourceId=this.jpc.suspendedElementId):(this.jpc.target=this.jpc.suspendedElement,this.jpc.targetId=this.jpc.suspendedElementId),this._doForceReattach(e),!0):(this._discard(e,n),!1)}},{key:"onStop",value:function(n){var i=this,e=n.e;this.instance.isConnectionBeingDragged=!1,this.instance.currentlyDragging=!1;var t=mc(Jt,Qt),r=this.instance.getContainer().querySelectorAll(ef);if(Q(r,function(f){i.instance.removeClass(f,t)}),this.jpc&&this.jpc.endpoints!=null){var s=this.jpc.suspendedEndpoint!=null,l=this._getFloatingAnchorIndex(),u=this.jpc.suspendedEndpoint,d;if(this.currentDropTarget!=null)if(d=this._getDropEndpoint(n,this.jpc),d==null)this._reattachOrDiscard(n.e);else if(u&&u.id===d.id)this._doForceReattach(l);else if(!d.enabled)this._reattachOrDiscard(n.e);else if(d.isFull())d.fire(ml,{endpoint:this,connection:this.jpc,maxConnections:this.instance.defaults.maxConnections},e),this._reattachOrDiscard(n.e);else{l===0?(this.jpc.source=d.element,this.jpc.sourceId=d.elementId):(this.jpc.target=d.element,this.jpc.targetId=d.elementId);var h=!0;s&&this.jpc.suspendedEndpoint.id!==d.id&&(!this.jpc.isDetachAllowed(this.jpc)||!this.jpc.endpoints[l].isDetachAllowed(this.jpc)||!this.jpc.suspendedEndpoint.isDetachAllowed(this.jpc)||!this.instance.checkCondition("beforeDetach",this.jpc))&&(h=!1),h=h&&d.isDropAllowed(this.jpc.sourceId,this.jpc.targetId,this.jpc.scope,this.jpc,d),h?this._drop(d,l,e,h):this._reattachOrDiscard(n.e)}else this._reattachOrDiscard(n.e);this.instance._refreshEndpoint(this.ep),this.ep.removeClass(this.instance.draggingClass),this._cleanupDraggablePlaceholder(),this.jpc.removeClass(this.instance.draggingClass),delete this.jpc.suspendedEndpoint,delete this.jpc.suspendedElement,delete this.jpc.suspendedElementType,delete this.jpc.suspendedElementId,delete this.jpc.suspendedIndex,delete this.floatingId,delete this.floatingIndex,delete this.floatingElement,delete this.floatingEndpoint,delete this.floatingAnchor,delete this.jpc.pending,d!=null&&this._maybeCleanup(d)}}},{key:"_getSourceDefinition",value:function(n){for(var i,e=this.instance.getContainer(),t=0;t<this.instance.sourceSelectors.length;t++)if(i=this.instance.sourceSelectors[t],i.isEnabled()){var r=Zh(n,e,i.selector,this.instance,i.exclude);if(r!==!1)return i}}},{key:"_getDropEndpoint",value:function(n,i){var e;if(this.currentDropTarget.endpoint==null){var t=this.currentDropTarget.def,r=n.e.target||n.e.srcElement;if(t==null)return null;var s=this.currentDropTarget.targetEl,l=ks(n.e,s,this.instance.currentZoom),u=this.instance._deriveEndpointAndAnchorSpec(i.getType().join(" "),!0),d=u.endpoints?K(n,{endpoint:t.def.endpoint||u.endpoints[1],cssClass:t.def.cssClass||"",source:t.def.source===!0,target:t.def.target===!0}):n,h=this.instance.validAnchorsSpec(u.anchors)?u.anchors:this.instance.areDefaultAnchorsSet()?this.instance.defaults.anchors:null,f=t.def.anchor,g=t.def.anchorPositionFinder?t.def.anchorPositionFinder(s,l,t.def,n.e):null,y=g!=null?g:f!=null?f:h!=null&&h[1]!=null?h[1]:null;y!=null&&(d=K(d,{anchor:y})),t.def.portId!=null&&(d.portId=t.def.portId);var _=t.def.parameterExtractor?t.def.parameterExtractor(this.currentDropTarget.el,r,n.e):{};if(d=br(d,_),d.element=s,e=this.instance._internal_newEndpoint(d),e._mtNew=!0,e.deleteOnEmpty=!0,t.def.parameters&&e.mergeParameters(t.def.parameters),t.def.extract){var p={};for(var C in t.def.extract){var b=this.currentDropTarget.el.getAttribute(C);b&&(p[t.def.extract[C]]=b)}e.mergeParameters(p)}}else e=this.currentDropTarget.endpoint;return e&&(e.removeClass(this.instance.endpointDropAllowedClass),e.removeClass(this.instance.endpointDropForbiddenClass)),e}},{key:"_doForceReattach",value:function(n){this.floatingEndpoint.detachFromConnection(this.jpc,null,!0),this.jpc.endpoints[n]=this.jpc.suspendedEndpoint,this.instance.setHover(this.jpc,!1),this.jpc._forceDetach=!0,this.jpc.suspendedEndpoint.addConnection(this.jpc),this.instance.sourceOrTargetChanged(this.floatingId,this.jpc.suspendedEndpoint.elementId,this.jpc,this.jpc.suspendedEndpoint.element,n),this.instance.deleteEndpoint(this.floatingEndpoint),this.instance.repaint(this.jpc.source),delete this.jpc._forceDetach}},{key:"_shouldReattach",value:function(){if(this.jpc.isReattach()||this.jpc._forceReattach)return!0;var n=this.jpc.suspendedEndpoint,i=this.jpc.suspendedElementType==Eo?1:0,e=this.jpc.endpoints[i];return!tl(!0,!1,[[n,Kn,[this.jpc]],[e,Kn,[this.jpc]],[this.jpc,Kn,[this.jpc]],[this.instance,hl,[Cl,this.jpc]]])}},{key:"_discard",value:function(n,i){this.jpc.pending?this.instance.fire(rd,this.jpc,i):(n===0?(this.jpc.source=this.jpc.suspendedEndpoint.element,this.jpc.sourceId=this.jpc.suspendedEndpoint.elementId):(this.jpc.target=this.jpc.suspendedEndpoint.element,this.jpc.targetId=this.jpc.suspendedEndpoint.elementId),this.jpc.endpoints[n]=this.jpc.suspendedEndpoint),this.floatingEndpoint&&this.floatingEndpoint.detachFromConnection(this.jpc),this.instance.deleteConnection(this.jpc,{originalEvent:i,force:!0})}},{key:"_drop",value:function(n,i,e,t){if(this.jpc.endpoints[i].detachFromConnection(this.jpc),this.jpc.suspendedEndpoint&&this.jpc.suspendedEndpoint.detachFromConnection(this.jpc),this.jpc.endpoints[i]=n,n.addConnection(this.jpc),this.jpc.suspendedEndpoint){var r=this.jpc.suspendedEndpoint.elementId;this.instance.fireMoveEvent({index:i,originalSourceId:i===0?r:this.jpc.sourceId,newSourceId:i===0?n.elementId:this.jpc.sourceId,originalTargetId:i===1?r:this.jpc.targetId,newTargetId:i===1?n.elementId:this.jpc.targetId,originalEndpoint:this.jpc.suspendedEndpoint,connection:this.jpc,newEndpoint:n},e)}if(i===1?this.instance.sourceOrTargetChanged(this.floatingId,this.jpc.targetId,this.jpc,this.jpc.target,1):this.instance.sourceOrTargetChanged(this.floatingId,this.jpc.sourceId,this.jpc,this.jpc.source,0),this.jpc.endpoints[0].finalEndpoint){var s=this.jpc.endpoints[0];s.detachFromConnection(this.jpc),this.jpc.endpoints[0]=this.jpc.endpoints[0].finalEndpoint,this.jpc.endpoints[0].addConnection(this.jpc)}Zn(t)&&this.jpc.mergeData(t),this._originalAnchorSpec&&(this.jpc.endpoints[0].setAnchor(this._originalAnchorSpec),this._originalAnchorSpec=null),this.instance._finaliseConnection(this.jpc,null,e),this.instance.setHover(this.jpc,!1),this.instance.revalidate(this.jpc.endpoints[0].element)}},{key:"_registerFloatingConnection",value:function(n,i){this.floatingConnections[n.id]=i}},{key:"_getFloatingAnchorIndex",value:function(){return this.floatingIndex==null?1:this.floatingIndex}}]),o}(),ls=function(o){me(n,o);var a=_e(n);function n(i,e){var t;return $(this,n),t=a.call(this,i,e),t.instance=i,t.dragSelection=e,c(v(t),"selector",[">",Pd,Oe].join(" ")),c(v(t),"doRevalidate",void 0),t.doRevalidate=t._revalidate.bind(v(t)),t}return Z(n,[{key:"reset",value:function(){this.drag.off(xr,this.doRevalidate)}},{key:"_revalidate",value:function(e){this.instance.revalidate(e)}},{key:"init",value:function(e){this.drag=e,e.on(xr,this.doRevalidate)}},{key:"useGhostProxy",value:function(e,t){var r=t._jsPlumbParentGroup;return r==null?!1:r.ghost===!0}},{key:"makeGhostProxy",value:function(e){var t=e,r=t.cloneNode(!0);return r._jsPlumbParentGroup=t._jsPlumbParentGroup,r}}]),n}(To),la=function(){function o(a,n){$(this,o),this.instance=a,this.overlay=n,c(this,"htmlElementOverlay",void 0),this.htmlElementOverlay=n}return Z(o,null,[{key:"getElement",value:function(n,i,e){if(n.canvas==null){if(e&&i){n.canvas=e(i);var t=n.instance.overlayClass+" "+(n.cssClass?n.cssClass:"");n.instance.addClass(n.canvas,t)}else n.canvas=sl(Sl,{},n.instance.overlayClass+" "+(n.cssClass?n.cssClass:""));n.instance.setAttribute(n.canvas,"jtk-overlay-id",n.id);for(var r in n.attributes)n.instance.setAttribute(n.canvas,r,n.attributes[r]);n.canvas.style.position=Vi,n.instance._appendElement(n.canvas,n.instance.getContainer()),n.instance.getId(n.canvas);var s="translate(-50%, -50%)";n.canvas.style.webkitTransform=s,n.canvas.style.mozTransform=s,n.canvas.style.msTransform=s,n.canvas.style.oTransform=s,n.canvas.style.transform=s,n.isVisible()||(n.canvas.style.display=ei),n.canvas.jtk={overlay:n}}return n.canvas}},{key:"destroy",value:function(n){n.canvas&&n.canvas.parentNode&&n.canvas.parentNode.removeChild(n.canvas),delete n.canvas,delete n.cachedDimensions}},{key:"_getDimensions",value:function(n,i){return(n.cachedDimensions==null||i)&&(n.cachedDimensions={w:1,h:1}),n.cachedDimensions}}]),o}(),$i=function(){function o(){$(this,o),c(this,"_listeners",{}),c(this,"eventsSuspended",!1),c(this,"tick",!1),c(this,"eventsToDieOn",{ready:!0}),c(this,"queue",[])}return Z(o,[{key:"fire",value:function(n,i,e){var t=null;if(this.tick)this.queue.unshift(arguments);else{if(this.tick=!0,!this.eventsSuspended&&this._listeners[n]){var r=this._listeners[n].length,s=0,l=!1;if(!this.shouldFireEvent||this.shouldFireEvent(n,i,e))for(;!l&&s<r&&t!==!1;){if(this.eventsToDieOn[n])this._listeners[n][s](i,e);else try{t=this._listeners[n][s](i,e)}catch(u){Be("jsPlumb: fire failed for event "+n+" : "+(u.message||u))}s++,(this._listeners==null||this._listeners[n]==null)&&(l=!0)}}this.tick=!1,this._drain()}return t}},{key:"_drain",value:function(){var n=this.queue.pop();n&&this.fire.apply(this,n)}},{key:"unbind",value:function(n,i){if(arguments.length===0)this._listeners={};else if(arguments.length===1){if(typeof n=="string")delete this._listeners[n];else if(n.__jsPlumb){var e;for(var t in n.__jsPlumb)e=n.__jsPlumb[t],La(this._listeners[e]||[],n)}}else arguments.length===2&&La(this._listeners[n]||[],i);return this}},{key:"getListener",value:function(n){return this._listeners[n]||[]}},{key:"isSuspendEvents",value:function(){return this.eventsSuspended}},{key:"setSuspendEvents",value:function(n){this.eventsSuspended=n}},{key:"bind",value:function(n,i,e){var t=this,r=function(u){il(t._listeners,u,i,e),i.__jsPlumb=i.__jsPlumb||{},i.__jsPlumb[He()]=u};if(typeof n=="string")r(n);else if(n.length!=null)for(var s=0;s<n.length;s++)r(n[s]);return this}},{key:"silently",value:function(n){this.setSuspendEvents(!0);try{n()}catch(i){Be("Cannot execute silent function "+i)}this.setSuspendEvents(!1)}}]),o}();(function(o){me(n,o);var a=_e(n);function n(){return $(this,n),a.apply(this,arguments)}return Z(n,[{key:"shouldFireEvent",value:function(e,t,r){return!0}}]),n})($i);function Po(o){var a=null;return Le(o)?a={type:o,options:{}}:a=o,a.options.id=a.options.id||He(),a}var Hr=function(o){me(n,o);var a=_e(n);function n(i,e,t){var r;$(this,n),r=a.call(this),r.instance=i,r.component=e,c(v(r),"id",void 0),c(v(r),"type",void 0),c(v(r),"cssClass",void 0),c(v(r),"visible",!0),c(v(r),"location",void 0),c(v(r),"events",void 0),c(v(r),"attributes",void 0),t=t||{},r.id=t.id||He(),r.cssClass=t.cssClass||"",r.setLocation(t.location),r.events=t.events||{},r.attributes=t.attributes||{};for(var s in r.events)r.bind(s,r.events[s]);return r}return Z(n,[{key:"setLocation",value:function(e){var t=this.location==null?.5:this.location;if(e!=null)try{var r=typeof e=="string"?parseFloat(e):e;isNaN(r)||(t=r)}catch{}this.location=t}},{key:"shouldFireEvent",value:function(e,t,r){return!0}},{key:"setVisible",value:function(e){this.visible=e,this.instance.setOverlayVisible(this,e)}},{key:"isVisible",value:function(){return this.visible}}]),n}($i),us={},xn={get:function(a,n,i,e){var t=us[n];if(t)return new t(a,i,e);throw{message:"jsPlumb: unknown overlay type '"+n+"'"}},register:function(a,n){us[a]=n}},Sn=function(o){me(n,o);var a=_e(n);function n(i,e,t){var r;return $(this,n),r=a.call(this,i,e,t),r.instance=i,r.component=e,c(v(r),"label",void 0),c(v(r),"labelText",void 0),c(v(r),"type",n.type),c(v(r),"cachedDimensions",void 0),t=t||{label:""},r.setLabel(t.label),r}return Z(n,[{key:"getLabel",value:function(){return En(this.label)?this.label(this):this.labelText}},{key:"setLabel",value:function(e){this.label=e,this.labelText=null,this.instance.updateLabel(this)}},{key:"getDimensions",value:function(){return{w:1,h:1}}},{key:"updateFrom",value:function(e){e.label!=null&&this.setLabel(e.label),e.location!=null&&(this.setLocation(e.location),this.instance.updateLabel(this))}}]),n}(Hr);c(Sn,"type","Label");function zt(o){return o.type===Sn.type}xn.register(Sn.type,Sn);function rr(o){return o==null?null:o.split(" ").filter(function(a){return a!=null&&a.length>0})}function cs(o,a,n){for(var i in a)o[i]=n}var tf="connector",nf="override",rf="cssClass",ds="__default",of="anchor",af="anchors",Ii="__label",sf="jtk-default-label",ql="overlay",lf="labelLocation",hs="add",fs="remove";function Gn(o,a){if(o.getDefaultType){var n=o.getTypeDescriptor(),i={},e=o.getDefaultType(),t=K({},e);cs(i,e,ds),o._types.forEach(function(r){if(r!==ds){var s=o.instance.getType(r,n);if(s!=null){var l=new Set([tf,of,af]);if(s.mergeStrategy===nf)for(var u in s)l.add(u);t=br(t,s,[rf],sc(l)),cs(i,s,r)}}}),a&&(t=rc(t,a,"_")),o.applyType(t,i)}}function oo(o,a){var n=o.instance.getType(a,o.getTypeDescriptor());n!=null&&n.cssClass&&o.removeClass(n.cssClass)}function vs(o){if(o.paintStyle&&o.hoverPaintStyle){var a={};K(a,o.paintStyle),K(a,o.hoverPaintStyle),o.hoverPaintStyle=a}}function uf(o,a){var n={cssClass:a.cssClass,id:Ii,component:o},i=K(n,a);return new Sn(o.instance,o,i)}function cf(o,a){var n=null;if(Le(a))n=xn.get(o.instance,a,o,{});else if(a.type!=null&&a.options!=null){var i=a,e=K({},i.options);n=xn.get(o.instance,i.type,o,e)}else n=a;return n.id=n.id||He(),o.cacheTypeItem(ql,n,n.id),o.overlays[n.id]=n,n}var Yl=function(o){me(n,o);var a=_e(n);function n(i,e){var t;if($(this,n),t=a.call(this),t.instance=i,c(v(t),"defaultLabelLocation",.5),c(v(t),"overlays",{}),c(v(t),"overlayPositions",{}),c(v(t),"overlayPlacements",{}),c(v(t),"clone",void 0),c(v(t),"deleted",void 0),c(v(t),"segment",void 0),c(v(t),"x",void 0),c(v(t),"y",void 0),c(v(t),"w",void 0),c(v(t),"h",void 0),c(v(t),"id",void 0),c(v(t),"visible",!0),c(v(t),"typeId",void 0),c(v(t),"params",{}),c(v(t),"paintStyle",void 0),c(v(t),"hoverPaintStyle",void 0),c(v(t),"paintStyleInUse",void 0),c(v(t),"_hover",!1),c(v(t),"lastPaintedAt",void 0),c(v(t),"data",void 0),c(v(t),"_defaultType",void 0),c(v(t),"events",void 0),c(v(t),"parameters",void 0),c(v(t),"_types",void 0),c(v(t),"_typeCache",void 0),c(v(t),"cssClass",void 0),c(v(t),"hoverClass",void 0),c(v(t),"beforeDetach",void 0),c(v(t),"beforeDrop",void 0),e=e||{},t.cssClass=e.cssClass||"",t.hoverClass=e.hoverClass||i.defaults.hoverClass,t.beforeDetach=e.beforeDetach,t.beforeDrop=e.beforeDrop,t._types=new Set,t._typeCache={},t.parameters=Er(e.parameters||{}),t.id=e.id||t.getIdPrefix()+new Date().getTime(),t._defaultType={parameters:t.parameters,scope:e.scope||t.instance.defaultScope,overlays:{}},e.events)for(var r in e.events)t.bind(r,e.events[r]);t.clone=function(){var g=Object.create(t.constructor.prototype);return t.constructor.apply(g,[i,e]),g},t.overlays={},t.overlayPositions={};var s=e.overlays||[],l={},u=t.getDefaultOverlayKey();if(u){var d=t.instance.defaults[u];d&&s.push.apply(s,Jn(d));for(var h=0;h<s.length;h++){var f=Po(s[h]);l[f.options.id]=f}}return t._defaultType.overlays=l,e.label&&(t.getDefaultType().overlays[Ii]={type:Sn.type,options:{label:e.label,location:e.labelLocation||t.defaultLabelLocation,id:Ii,cssClass:sf}}),t}return Z(n,[{key:"isDetachAllowed",value:function(e){var t=!0;if(this.beforeDetach)try{t=this.beforeDetach(e)}catch(r){Be("jsPlumb: beforeDetach callback failed",r)}return t}},{key:"isDropAllowed",value:function(e,t,r,s,l){var u,d={sourceId:e,targetId:t,scope:r,connection:s,dropEndpoint:l};if(this.beforeDrop)try{u=this.beforeDrop(d)}catch(h){Be("jsPlumb: beforeDrop callback failed",h)}else u=this.instance.checkCondition(bl,d);return u}},{key:"getDefaultType",value:function(){return this._defaultType}},{key:"appendToDefaultType",value:function(e){for(var t in e)this._defaultType[t]=e[t]}},{key:"getId",value:function(){return this.id}},{key:"cacheTypeItem",value:function(e,t,r){this._typeCache[r]=this._typeCache[r]||{},this._typeCache[r][e]=t}},{key:"getCachedTypeItem",value:function(e,t){return this._typeCache[t]?this._typeCache[t][e]:null}},{key:"setType",value:function(e,t){this.clearTypes(),(rr(e)||[]).forEach(this._types.add,this._types),Gn(this,t)}},{key:"getType",value:function(){return Array.from(this._types.keys())}},{key:"reapplyTypes",value:function(e){Gn(this,e)}},{key:"hasType",value:function(e){return this._types.has(e)}},{key:"addType",value:function(e,t){var r=rr(e),s=!1;if(r!=null){for(var l=0,u=r.length;l<u;l++)this._types.has(r[l])||(this._types.add(r[l]),s=!0);s&&Gn(this,t)}}},{key:"removeType",value:function(e,t){var r=this,s=rr(e),l=!1,u=function(g){return r._types.has(g)?(oo(r,g),r._types.delete(g),!0):!1};if(s!=null){for(var d=0,h=s.length;d<h;d++)l=u(s[d])||l;l&&Gn(this,t)}}},{key:"clearTypes",value:function(e){var t=this;this._types.forEach(function(r){oo(t,r)}),this._types.clear(),Gn(this,e)}},{key:"toggleType",value:function(e,t){var r=rr(e);if(r!=null){for(var s=0,l=r.length;s<l;s++)this._types.has(r[s])?(oo(this,r[s]),this._types.delete(r[s])):this._types.add(r[s]);Gn(this,t)}}},{key:"applyType",value:function(e,t){if(this.setPaintStyle(e.paintStyle),this.setHoverPaintStyle(e.hoverPaintStyle),this.mergeParameters(e.parameters),this.paintStyleInUse=this.getPaintStyle(),e.overlays){var r={},s;for(s in e.overlays){var l=this.overlays[e.overlays[s].options.id];if(l)l.updateFrom(e.overlays[s].options),r[e.overlays[s].options.id]=!0,this.instance.reattachOverlay(l,this);else{var u=this.getCachedTypeItem(ql,e.overlays[s].options.id);u!=null?(this.instance.reattachOverlay(u,this),u.setVisible(!0),u.updateFrom(e.overlays[s].options),this.overlays[u.id]=u):u=this.addOverlay(e.overlays[s]),r[u.id]=!0}}for(s in this.overlays)r[this.overlays[s].id]==null&&this.removeOverlay(this.overlays[s].id,!0)}}},{key:"setPaintStyle",value:function(e){this.paintStyle=e,this.paintStyleInUse=this.paintStyle,vs(this)}},{key:"getPaintStyle",value:function(){return this.paintStyle}},{key:"setHoverPaintStyle",value:function(e){this.hoverPaintStyle=e,vs(this)}},{key:"getHoverPaintStyle",value:function(){return this.hoverPaintStyle}},{key:"destroy",value:function(){for(var e in this.overlays)this.instance.destroyOverlay(this.overlays[e]);this.overlays={},this.overlayPositions={},this.unbind(),this.clone=null}},{key:"isHover",value:function(){return this._hover}},{key:"mergeParameters",value:function(e){e!=null&&K(this.parameters,e)}},{key:"setVisible",value:function(e){this.visible=e,e?this.showOverlays():this.hideOverlays()}},{key:"isVisible",value:function(){return this.visible}},{key:"setAbsoluteOverlayPosition",value:function(e,t){this.overlayPositions[e.id]=t}},{key:"getAbsoluteOverlayPosition",value:function(e){return this.overlayPositions?this.overlayPositions[e.id]:null}},{key:"_clazzManip",value:function(e,t){for(var r in this.overlays)e===hs?this.instance.addOverlayClass(this.overlays[r],t):e===fs&&this.instance.removeOverlayClass(this.overlays[r],t)}},{key:"addClass",value:function(e,t){var r=(this.cssClass||"").split(" ");r.push(e),this.cssClass=r.join(" "),this._clazzManip(hs,e)}},{key:"removeClass",value:function(e,t){var r=(this.cssClass||"").split(" ");this.cssClass=r.filter(function(s){return s!==e}).join(" "),this._clazzManip(fs,e)}},{key:"getClass",value:function(){return this.cssClass}},{key:"shouldFireEvent",value:function(e,t,r){return!0}},{key:"getData",value:function(){return this.data}},{key:"setData",value:function(e){this.data=e||{}}},{key:"mergeData",value:function(e){this.data=K(this.data,e)}},{key:"addOverlay",value:function(e){var t=cf(this,e);if(this.getData&&t.type===Sn.type&&!Le(e)){var r=this.getData(),s=e.options;if(r){var l=s.labelLocationAttribute||lf,u=r[l];u&&(t.location=u)}}return t}},{key:"getOverlay",value:function(e){return this.overlays[e]}},{key:"getOverlays",value:function(){return this.overlays}},{key:"hideOverlay",value:function(e){var t=this.getOverlay(e);t&&t.setVisible(!1)}},{key:"hideOverlays",value:function(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];t=t||[];for(var s in this.overlays)(t.length===0||t.indexOf(s)!==-1)&&this.overlays[s].setVisible(!1)}},{key:"showOverlay",value:function(e){var t=this.getOverlay(e);t&&t.setVisible(!0)}},{key:"showOverlays",value:function(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];t=t||[];for(var s in this.overlays)(t.length===0||t.indexOf(s)!==-1)&&this.overlays[s].setVisible(!0)}},{key:"removeAllOverlays",value:function(){for(var e in this.overlays)this.instance.destroyOverlay(this.overlays[e]);this.overlays={},this.overlayPositions=null,this.overlayPlacements={}}},{key:"removeOverlay",value:function(e,t){var r=this.overlays[e];r&&(r.setVisible(!1),t||this.instance.destroyOverlay(r),delete this.overlays[e],this.overlayPositions&&delete this.overlayPositions[e],this.overlayPlacements&&delete this.overlayPlacements[e])}},{key:"removeOverlays",value:function(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];for(var s=0,l=t.length;s<l;s++)this.removeOverlay(arguments[s])}},{key:"getLabel",value:function(){var e=this.getLabelOverlay();return e!=null?e.getLabel():null}},{key:"getLabelOverlay",value:function(){return this.getOverlay(Ii)}},{key:"setLabel",value:function(e){var t=this.getLabelOverlay();if(t)if(Le(e)||En(e))t.setLabel(e);else{var s=e;s.label&&t.setLabel(s.label),s.location&&(t.location=s.location)}else{var r=Le(e)||En(e)?{label:e}:e;t=uf(this,r),this.overlays[Ii]=t}}}]),n}($i),df=["connectorStyle","connectorHoverStyle","connectorOverlays","connector","connectionType","connectorClass","connectorHoverClass"],zn=function(o){me(n,o);var a=_e(n);function n(i,e){var t;$(this,n),t=a.call(this,i,e),t.instance=i,c(v(t),"connections",[]),c(v(t),"endpoint",void 0),c(v(t),"element",void 0),c(v(t),"elementId",void 0),c(v(t),"dragAllowedWhenFull",!0),c(v(t),"timestamp",void 0),c(v(t),"portId",void 0),c(v(t),"maxConnections",void 0),c(v(t),"proxiedBy",void 0),c(v(t),"connectorClass",void 0),c(v(t),"connectorHoverClass",void 0),c(v(t),"finalEndpoint",void 0),c(v(t),"enabled",!0),c(v(t),"isSource",void 0),c(v(t),"isTarget",void 0),c(v(t),"isTemporarySource",void 0),c(v(t),"connectionCost",1),c(v(t),"connectionsDirected",void 0),c(v(t),"connectionsDetachable",void 0),c(v(t),"reattachConnections",void 0),c(v(t),"currentAnchorClass",void 0),c(v(t),"referenceEndpoint",void 0),c(v(t),"edgeType",void 0),c(v(t),"connector",void 0),c(v(t),"connectorOverlays",void 0),c(v(t),"connectorStyle",void 0),c(v(t),"connectorHoverStyle",void 0),c(v(t),"deleteOnEmpty",void 0),c(v(t),"uuid",void 0),c(v(t),"scope",void 0),c(v(t),"_anchor",void 0),c(v(t),"defaultLabelLocation",[.5,.5]),t.appendToDefaultType({edgeType:e.edgeType,maxConnections:e.maxConnections==null?t.instance.defaults.maxConnections:e.maxConnections,paintStyle:e.paintStyle||t.instance.defaults.endpointStyle,hoverPaintStyle:e.hoverPaintStyle||t.instance.defaults.endpointHoverStyle,connectorStyle:e.connectorStyle,connectorHoverStyle:e.connectorHoverStyle,connectorClass:e.connectorClass,connectorHoverClass:e.connectorHoverClass,connectorOverlays:e.connectorOverlays,connector:e.connector}),t.enabled=e.enabled!==!1,t.visible=!0,t.element=e.element,t.uuid=e.uuid,t.portId=e.portId,t.elementId=e.elementId,t.connectionCost=e.connectionCost==null?1:e.connectionCost,t.connectionsDirected=e.connectionsDirected,t.currentAnchorClass="",t.events={},t.connectorOverlays=e.connectorOverlays,t.connectorStyle=e.connectorStyle,t.connectorHoverStyle=e.connectorHoverStyle,t.connector=e.connector,t.edgeType=e.edgeType,t.connectorClass=e.connectorClass,t.connectorHoverClass=e.connectorHoverClass,t.deleteOnEmpty=e.deleteOnEmpty===!0,t.isSource=e.source||!1,t.isTemporarySource=e.isTemporarySource||!1,t.isTarget=e.target||!1,t.connections=e.connections||[],t.scope=e.scope||i.defaultScope,t.timestamp=null,t.reattachConnections=e.reattachConnections||i.defaults.reattachConnections,t.connectionsDetachable=i.defaults.connectionsDetachable,e.connectionsDetachable===!1&&(t.connectionsDetachable=!1),t.dragAllowedWhenFull=e.dragAllowedWhenFull!==!1,e.onMaxConnections&&t.bind(ml,e.onMaxConnections);var r=e.endpoint||e.existingEndpoint||i.defaults.endpoint;if(t.setEndpoint(r),e.preparedAnchor!=null)t.setPreparedAnchor(e.preparedAnchor);else{var s=e.anchor?e.anchor:e.anchors?e.anchors:i.defaults.anchor||Dt.Top;t.setAnchor(s)}var l=[Tr,e.type||""].join(" ");return t.addType(l,e.data),t}return Z(n,[{key:"getIdPrefix",value:function(){return"_jsplumb_e"}},{key:"getTypeDescriptor",value:function(){return"endpoint"}},{key:"getXY",value:function(){return{x:this.endpoint.x,y:this.endpoint.y}}},{key:"getDefaultOverlayKey",value:function(){return"endpointOverlays"}},{key:"_updateAnchorClass",value:function(){var e=this._anchor&&this._anchor.cssClass;if(e!=null&&e.length>0){var t=this.instance.endpointAnchorClassPrefix+"-"+this.currentAnchorClass;this.currentAnchorClass=e;var r=this.instance.endpointAnchorClassPrefix+(this.currentAnchorClass?"-"+this.currentAnchorClass:"");t!==r&&(this.removeClass(t),this.addClass(r),this.instance.removeClass(this.element,t),this.instance.addClass(this.element,r))}}},{key:"setPreparedAnchor",value:function(e){return this.instance.router.setAnchor(this,e),this._updateAnchorClass(),this}},{key:"_anchorLocationChanged",value:function(e){this.fire(wc,{endpoint:this,anchor:e}),this._updateAnchorClass()}},{key:"setAnchor",value:function(e){var t=this.instance.router.prepareAnchor(e);return this.setPreparedAnchor(t),this}},{key:"addConnection",value:function(e){this.connections.push(e),this.instance._refreshEndpoint(this)}},{key:"detachFromConnection",value:function(e,t,r){t=t==null?this.connections.indexOf(e):t,t>=0&&(this.connections.splice(t,1),this.instance._refreshEndpoint(this)),!r&&this.deleteOnEmpty&&this.connections.length===0&&this.instance.deleteEndpoint(this)}},{key:"deleteEveryConnection",value:function(e){for(var t=this.connections.length,r=0;r<t;r++)this.instance.deleteConnection(this.connections[0],e)}},{key:"detachFrom",value:function(e){for(var t=[],r=0;r<this.connections.length;r++)(this.connections[r].endpoints[1]===e||this.connections[r].endpoints[0]===e)&&t.push(this.connections[r]);for(var s=0,l=t.length;s<l;s++)this.instance.deleteConnection(t[0]);return this}},{key:"setVisible",value:function(e,t,r){if(Ie(Me(n.prototype),"setVisible",this).call(this,e),this.endpoint.setVisible(e),e?this.showOverlays():this.hideOverlays(),!t){for(var s=0;s<this.connections.length;s++)if(this.connections[s].setVisible(e),!r){var l=this===this.connections[s].endpoints[0]?1:0;this.connections[s].endpoints[l].connections.length===1&&this.connections[s].endpoints[l].setVisible(e,!0,!0)}}}},{key:"applyType",value:function(e,t){Ie(Me(n.prototype),"applyType",this).call(this,e,t),this.setPaintStyle(e.endpointStyle||e.paintStyle),this.setHoverPaintStyle(e.endpointHoverStyle||e.hoverPaintStyle),this.connectorStyle=e.connectorStyle,this.connectorHoverStyle=e.connectorHoverStyle,this.connector=e.connector,this.connectorOverlays=e.connectorOverlays,this.edgeType=e.edgeType,e.maxConnections!=null&&(this.maxConnections=e.maxConnections),e.scope&&(this.scope=e.scope),K(e,df),this.instance.applyEndpointType(this,e)}},{key:"destroy",value:function(){Ie(Me(n.prototype),"destroy",this).call(this),this.deleted=!0,this.endpoint!=null&&this.instance.destroyEndpoint(this)}},{key:"isFull",value:function(){return this.maxConnections===0?!0:!(this.isFloating()||this.maxConnections<0||this.connections.length<this.maxConnections)}},{key:"isFloating",value:function(){return this.instance.router.isFloating(this)}},{key:"isConnectedTo",value:function(e){var t=!1;if(e){for(var r=0;r<this.connections.length;r++)if(this.connections[r].endpoints[1]===e||this.connections[r].endpoints[0]===e){t=!0;break}}return t}},{key:"setDragAllowedWhenFull",value:function(e){this.dragAllowedWhenFull=e}},{key:"getUuid",value:function(){return this.uuid}},{key:"connectorSelector",value:function(){return this.connections[0]}},{key:"prepareEndpoint",value:function(e,t){var r={cssClass:this.cssClass,endpoint:this},s;if(ol(e,ci)){var l=e;s=Zt.clone(l),s.classes=r.cssClass.split(" ")}else if(Le(e))s=Zt.get(this,e,r);else{var u=e;K(r,u.options||{}),s=Zt.get(this,u.type,r)}return s.typeId=t,s}},{key:"setEndpoint",value:function(e){var t=this.prepareEndpoint(e);this.setPreparedEndpoint(t)}},{key:"setPreparedEndpoint",value:function(e){this.endpoint!=null&&this.instance.destroyEndpoint(this),this.endpoint=e}},{key:"addClass",value:function(e,t){Ie(Me(n.prototype),"addClass",this).call(this,e,t),this.endpoint!=null&&this.endpoint.addClass(e)}},{key:"removeClass",value:function(e,t){Ie(Me(n.prototype),"removeClass",this).call(this,e,t),this.endpoint!=null&&this.endpoint.removeClass(e)}}]),n}(Yl),or="anchors",ao="connector";function ps(o,a,n,i,e,t,r){var s;if(a)o.endpoints[n]=a,a.addConnection(o);else{var l=r||o.endpointSpec||o.endpointsSpec[n]||o.instance.defaults.endpoints[n]||o.instance.defaults.endpoint,u=o.endpointStyles[n]||o.endpointStyle||o.instance.defaults.endpointStyles[n]||o.instance.defaults.endpointStyle;u.fill==null&&o.paintStyle!=null&&(u.fill=o.paintStyle.stroke),u.outlineStroke==null&&o.paintStyle!=null&&(u.outlineStroke=o.paintStyle.outlineStroke),u.outlineWidth==null&&o.paintStyle!=null&&(u.outlineWidth=o.paintStyle.outlineWidth);var d=o.endpointHoverStyles[n]||o.endpointHoverStyle||o.endpointHoverStyle||o.instance.defaults.endpointHoverStyles[n]||o.instance.defaults.endpointHoverStyle;o.hoverPaintStyle!=null&&(d==null&&(d={}),d.fill==null&&(d.fill=o.hoverPaintStyle.stroke));var h=o.uuids?o.uuids[n]:null;i=i!=null?i:o.instance.defaults.anchors!=null?o.instance.defaults.anchors[n]:o.instance.defaults.anchor,s=o.instance._internal_newEndpoint({paintStyle:u,hoverPaintStyle:d,endpoint:l,connections:[o],uuid:h,element:e,scope:o.scope,anchor:i,reattachConnections:o.reattach||o.instance.defaults.reattachConnections,connectionsDetachable:o.detachable||o.instance.defaults.connectionsDetachable}),o.instance._refreshEndpoint(s),a==null&&(s.deleteOnEmpty=!0),o.endpoints[n]=s}return s}var Hi=function(o){me(n,o);var a=_e(n);function n(i,e){var t;$(this,n),t=a.call(this,i,e),t.instance=i,c(v(t),"connector",void 0),c(v(t),"defaultLabelLocation",.5),c(v(t),"scope",void 0),c(v(t),"typeId","_jsplumb_connection"),c(v(t),"previousConnection",void 0),c(v(t),"sourceId",void 0),c(v(t),"targetId",void 0),c(v(t),"source",void 0),c(v(t),"target",void 0),c(v(t),"detachable",!0),c(v(t),"reattach",!1),c(v(t),"uuids",void 0),c(v(t),"cost",1),c(v(t),"directed",void 0),c(v(t),"endpoints",[null,null]),c(v(t),"endpointStyles",void 0),c(v(t),"endpointSpec",void 0),c(v(t),"endpointsSpec",void 0),c(v(t),"endpointStyle",{}),c(v(t),"endpointHoverStyle",{}),c(v(t),"endpointHoverStyles",void 0),c(v(t),"suspendedEndpoint",void 0),c(v(t),"suspendedIndex",void 0),c(v(t),"suspendedElement",void 0),c(v(t),"suspendedElementId",void 0),c(v(t),"suspendedElementType",void 0),c(v(t),"_forceReattach",void 0),c(v(t),"_forceDetach",void 0),c(v(t),"proxies",[]),c(v(t),"pending",!1),t.id=e.id,t.previousConnection=e.previousConnection,t.source=e.source,t.target=e.target,e.sourceEndpoint?(t.source=e.sourceEndpoint.element,t.sourceId=e.sourceEndpoint.elementId):t.sourceId=i.getId(t.source),e.targetEndpoint?(t.target=e.targetEndpoint.element,t.targetId=e.targetEndpoint.elementId):t.targetId=i.getId(t.target),t.scope=e.scope;var r=e.anchors?e.anchors[0]:e.anchor,s=e.anchors?e.anchors[1]:e.anchor;i.manage(t.source),i.manage(t.target),t.visible=!0,t.params={cssClass:e.cssClass,hoverClass:e.hoverClass,"pointer-events":e["pointer-events"],overlays:e.overlays},t.lastPaintedAt=null,e.type&&(e.endpoints=e.endpoints||t.instance._deriveEndpointAndAnchorSpec(e.type).endpoints),t.endpointSpec=e.endpoint,t.endpointsSpec=e.endpoints||[null,null],t.endpointStyle=e.endpointStyle,t.endpointHoverStyle=e.endpointHoverStyle,t.endpointStyles=e.endpointStyles||[null,null],t.endpointHoverStyles=e.endpointHoverStyles||[null,null],t.paintStyle=e.paintStyle,t.hoverPaintStyle=e.hoverPaintStyle,t.uuids=e.uuids,t.makeEndpoint(!0,t.source,t.sourceId,r,e.sourceEndpoint),t.makeEndpoint(!1,t.target,t.targetId,s,e.targetEndpoint),t.scope||(t.scope=t.endpoints[0].scope),e.deleteEndpointsOnEmpty!=null&&(t.endpoints[0].deleteOnEmpty=e.deleteEndpointsOnEmpty,t.endpoints[1].deleteOnEmpty=e.deleteEndpointsOnEmpty);var l=t.instance.defaults.connectionsDetachable;e.detachable===!1&&(l=!1),t.endpoints[0].connectionsDetachable===!1&&(l=!1),t.endpoints[1].connectionsDetachable===!1&&(l=!1),t.endpointsSpec=e.endpoints||[null,null],t.endpointSpec=e.endpoint||null;var u=e.reattach||t.endpoints[0].reattachConnections||t.endpoints[1].reattachConnections||t.instance.defaults.reattachConnections,d=K({},t.endpoints[0].connectorStyle||t.endpoints[1].connectorStyle||e.paintStyle||t.instance.defaults.paintStyle);if(t.appendToDefaultType({detachable:l,reattach:u,paintStyle:d,hoverPaintStyle:K({},t.endpoints[0].connectorHoverStyle||t.endpoints[1].connectorHoverStyle||e.hoverPaintStyle||t.instance.defaults.hoverPaintStyle)}),e.outlineWidth&&(d.outlineWidth=e.outlineWidth),e.outlineColor&&(d.outlineStroke=e.outlineColor),e.lineWidth&&(d.strokeWidth=e.lineWidth),e.color&&(d.stroke=e.color),!t.instance._suspendDrawing){var h=t.instance._suspendedAt||He();t.instance._paintEndpoint(t.endpoints[0],{timestamp:h}),t.instance._paintEndpoint(t.endpoints[1],{timestamp:h})}t.cost=e.cost||t.endpoints[0].connectionCost,t.directed=e.directed,e.directed==null&&(t.directed=t.endpoints[0].connectionsDirected);var f=K({},t.endpoints[1].parameters);K(f,t.endpoints[0].parameters),K(f,t.parameters),t.parameters=f,t.paintStyleInUse=t.getPaintStyle()||{},t._setConnector(t.endpoints[0].connector||t.endpoints[1].connector||e.connector||t.instance.defaults.connector,!0);var g=e.data==null||!Zn(e.data)?{}:e.data;t.setData(g);var y=[Tr,t.endpoints[0].edgeType,t.endpoints[1].edgeType,e.type].join(" ");return/[^\s]/.test(y)&&t.addType(y,e.data),t}return Z(n,[{key:"getIdPrefix",value:function(){return"_jsPlumb_c"}},{key:"getDefaultOverlayKey",value:function(){return zc}},{key:"getXY",value:function(){return{x:this.connector.x,y:this.connector.y}}},{key:"makeEndpoint",value:function(e,t,r,s,l){return r=r||this.instance.getId(t),ps(this,l,e?0:1,s,t)}},{key:"getTypeDescriptor",value:function(){return n.type}},{key:"isDetachable",value:function(e){return this.detachable===!1?!1:e!=null?e.connectionsDetachable===!0:this.detachable===!0}},{key:"setDetachable",value:function(e){this.detachable=e===!0}},{key:"isReattach",value:function(){return this.reattach===!0||this.endpoints[0].reattachConnections===!0||this.endpoints[1].reattachConnections===!0}},{key:"setReattach",value:function(e){this.reattach=e===!0}},{key:"applyType",value:function(e,t){var r=null;e.connector!=null&&(r=this.getCachedTypeItem(ao,t.connector),r==null&&(r=this.prepareConnector(e.connector,t.connector),this.cacheTypeItem(ao,r,t.connector)),this.setPreparedConnector(r)),Ie(Me(n.prototype),"applyType",this).call(this,e,t),e.detachable!=null&&this.setDetachable(e.detachable),e.reattach!=null&&this.setReattach(e.reattach),e.scope&&(this.scope=e.scope);var s=null;e.anchor?(s=this.getCachedTypeItem(or,t.anchor),s==null&&(s=[Mi(e.anchor),Mi(e.anchor)],this.cacheTypeItem(or,s,t.anchor))):e.anchors&&(s=this.getCachedTypeItem(or,t.anchors),s==null&&(s=[Mi(e.anchors[0]),Mi(e.anchors[1])],this.cacheTypeItem(or,s,t.anchors))),s!=null&&(this.instance.router.setConnectionAnchors(this,s),this.instance.router.isDynamicAnchor(this.endpoints[1])&&this.instance.repaint(this.endpoints[1].element)),this.instance.applyConnectorType(this.connector,e)}},{key:"addClass",value:function(e,t){Ie(Me(n.prototype),"addClass",this).call(this,e),t&&(this.endpoints[0].addClass(e),this.endpoints[1].addClass(e),this.suspendedEndpoint&&this.suspendedEndpoint.addClass(e)),this.connector&&this.instance.addConnectorClass(this.connector,e)}},{key:"removeClass",value:function(e,t){Ie(Me(n.prototype),"removeClass",this).call(this,e),t&&(this.endpoints[0].removeClass(e),this.endpoints[1].removeClass(e),this.suspendedEndpoint&&this.suspendedEndpoint.removeClass(e)),this.connector&&this.instance.removeConnectorClass(this.connector,e)}},{key:"setVisible",value:function(e){Ie(Me(n.prototype),"setVisible",this).call(this,e),this.connector&&this.instance.setConnectorVisible(this.connector,e),this.instance._paintConnection(this)}},{key:"destroy",value:function(){Ie(Me(n.prototype),"destroy",this).call(this),this.endpoints=null,this.endpointStyles=null,this.source=null,this.target=null,this.instance.destroyConnector(this),this.connector=null,this.deleted=!0}},{key:"getUuids",value:function(){return[this.endpoints[0].getUuid(),this.endpoints[1].getUuid()]}},{key:"prepareConnector",value:function(e,t){var r={cssClass:this.params.cssClass,hoverClass:this.params.hoverClass,"pointer-events":this.params["pointer-events"]},s;if(Le(e))s=this.instance._makeConnector(this,e,r);else{var l=e;s=this.instance._makeConnector(this,l.type,br(l.options||{},r))}return t!=null&&(s.typeId=t),s}},{key:"setPreparedConnector",value:function(e,t,r,s){if(this.connector!==e){var l,u="";if(this.connector!=null&&(l=this.connector,u=this.instance.getConnectorClass(this.connector),this.instance.destroyConnector(this)),this.connector=e,s&&this.cacheTypeItem(ao,e,s),this.addClass(u),l!=null){var d=this.getOverlays();for(var h in d)this.instance.reattachOverlay(d[h],this)}t||this.instance._paintConnection(this)}}},{key:"_setConnector",value:function(e,t,r,s){var l=this.prepareConnector(e,s);this.setPreparedConnector(l,t,r,s)}},{key:"replaceEndpoint",value:function(e,t){var r=this.endpoints[e],s=r.elementId,l=this.instance.getEndpoints(r.element),u=l.indexOf(r),d=ps(this,null,e,null,r.element,s,t);this.endpoints[e]=d,l.splice(u,1,d),r.detachFromConnection(this),this.instance.deleteEndpoint(r),this.instance.fire(Oc,{previous:r,current:d})}}]),n}(Yl);c(Hi,"type","connection");function Li(o){if(o.path==null){var a=K({"jtk-overlay-id":o.id},o.attributes);o.path=Ht(Co,a);var n=o.instance.overlayClass+" "+(o.cssClass?o.cssClass:"");o.instance.addClass(o.path,n),o.path.jtk={overlay:o}}var i=o.path.parentNode;if(i==null){if(o.component instanceof Hi){var e=o.component.connector;i=e!=null?e.canvas:null}else if(o.component instanceof zn){var t=o.component.endpoint;i=t!=null?t.canvas:t}i!=null&&pr(i,o.path,1)}return o.path}function hf(o,a,n,i){Li(o);var e=[0,0];i.xmin<0&&(e[0]=-i.xmin),i.ymin<0&&(e[1]=-i.ymin);var t={d:a,stroke:n.stroke?n.stroke:null,fill:n.fill?n.fill:null,transform:"translate("+e[0]+","+e[1]+")","pointer-events":"visibleStroke"};Bt(o.path,t)}function ff(o,a){var n=o;n.path!=null&&n.path.parentNode!=null&&n.path.parentNode.removeChild(n.path),n.bgPath!=null&&n.bgPath.parentNode!=null&&n.bgPath.parentNode.removeChild(n.bgPath),delete n.path,delete n.bgPath}(function(o){me(n,o);var a=_e(n);function n(){var i;$(this,n);for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];return i=a.call.apply(a,[this].concat(t)),c(v(i),"path",void 0),i}return n})(Hr);var zl=function(){function o(){$(this,o)}return Z(o,null,[{key:"paint",value:function(n,i,e,t){if(e!=null){var r=[n.x,n.y],s=[n.w,n.h];if(t!=null&&(t.xmin<0&&(r[0]+=t.xmin),t.ymin<0&&(r[1]+=t.ymin),s[0]=t.xmax+(t.xmin<0?-t.xmin:0),s[1]=t.ymax+(t.ymin<0?-t.ymin:0)),isFinite(s[0])&&isFinite(s[1])){var l={width:""+(s[0]||0),height:""+(s[1]||0)};i.containerType===Cn.HTML?Bt(n.canvas,K(l,{style:xl([r[0],r[1]])})):Bt(n.canvas,K(l,{x:r[0],y:r[1]}))}}}}]),o}();function vf(o,a,n,i){pf(o,a),zl.paint(a,o,n,i);var e="",t=[0,0];if(i.xmin<0&&(t[0]=-i.xmin),i.ymin<0&&(t[1]=-i.ymin),a.segments.length>0){e=o.getPathData(a);var r={d:e,transform:"translate("+t[0]+","+t[1]+")","pointer-events":"visibleStroke"},s=null;if(n.outlineStroke){var l=n.outlineWidth||1,u=n.strokeWidth+2*l;s=K({},n),s.stroke=n.outlineStroke,s.strokeWidth=u,a.bgPath==null?(a.bgPath=Ht(Co,r),o.addClass(a.bgPath,o.connectorOutlineClass),pr(a.canvas,a.bgPath,0)):Bt(a.bgPath,r),ko(a.canvas,a.bgPath,s)}var d=a;d.path==null?(d.path=Ht(Co,r),pr(d.canvas,d.path,n.outlineStroke?1:0)):(d.path.parentNode!==d.canvas&&pr(d.canvas,d.path,n.outlineStroke?1:0),Bt(a.path,r)),ko(a.canvas,a.path,n)}}function pf(o,a){if(a.canvas!=null)return a.canvas;var n=Ht(kl,{style:"",width:"0",height:"0","pointer-events":ei,position:Vi});return a.canvas=n,o._appendElement(a.canvas,o.getContainer()),a.cssClass!=null&&o.addClass(n,a.cssClass),o.addClass(n,o.connectorClass),n.jtk=n.jtk||{},n.jtk.connector=a,n}var gf=function(){function o(){$(this,o)}return Z(o,null,[{key:"getEndpointElement",value:function(n){if(n.canvas!=null)return n.canvas;var i=Ht(kl,{style:"",width:"0",height:"0","pointer-events":"all",position:Vi});n.canvas=i;var e=n.classes.join(" ");n.instance.addClass(i,e);for(var t=n.endpoint.scope.split(/\s/),r=0;r<t.length;r++)n.instance.setAttribute(i,dl+t[r],Al);return n.instance._appendElementToContainer(i),n.cssClass!=null&&n.instance.addClass(i,n.cssClass),n.instance.addClass(i,n.instance.endpointClass),i.jtk=i.jtk||{},i.jtk.endpoint=n.endpoint,i.style.display=n.endpoint.visible!==!1?bo:ei,i}},{key:"paint",value:function(n,i,e){if(n.endpoint.deleted!==!0){this.getEndpointElement(n),zl.paint(n,n.instance,e);var t=K({},e);t.outlineStroke&&(t.stroke=t.outlineStroke),n.node==null?(n.node=i.makeNode(n,t),n.canvas.appendChild(n.node)):i.updateNode!=null&&i.updateNode(n,n.node),ko(n.canvas,n.node,t)}}}]),o}(),qr=function(){function o(a,n){$(this,o),this.connection=a,c(this,"type",void 0),c(this,"edited",!1),c(this,"stub",void 0),c(this,"sourceStub",void 0),c(this,"targetStub",void 0),c(this,"maxStub",void 0),c(this,"typeId",void 0),c(this,"gap",void 0),c(this,"sourceGap",void 0),c(this,"targetGap",void 0),c(this,"segments",[]),c(this,"totalLength",0),c(this,"segmentProportions",[]),c(this,"segmentProportionalLengths",[]),c(this,"paintInfo",null),c(this,"strokeWidth",void 0),c(this,"x",void 0),c(this,"y",void 0),c(this,"w",void 0),c(this,"h",void 0),c(this,"segment",void 0),c(this,"bounds",Sr()),c(this,"cssClass",void 0),c(this,"hoverClass",void 0),c(this,"geometry",void 0),this.stub=n.stub||this.getDefaultStubs(),this.sourceStub=Array.isArray(this.stub)?this.stub[0]:this.stub,this.targetStub=Array.isArray(this.stub)?this.stub[1]:this.stub,this.gap=n.gap||0,this.sourceGap=Array.isArray(this.gap)?this.gap[0]:this.gap,this.targetGap=Array.isArray(this.gap)?this.gap[1]:this.gap,this.maxStub=Math.max(this.sourceStub,this.targetStub),this.cssClass=n.cssClass||"",this.hoverClass=n.hoverClass||""}return Z(o,[{key:"getTypeDescriptor",value:function(){return"connector"}},{key:"getIdPrefix",value:function(){return"_jsplumb_connector"}},{key:"setGeometry",value:function(n,i){this.geometry=n,this.edited=n!=null&&!i}},{key:"exportGeometry",value:function(){return this.geometry}},{key:"importGeometry",value:function(n){return this.geometry=n,!0}},{key:"resetGeometry",value:function(){this.geometry=null,this.edited=!1}},{key:"transformAnchorPlacement",value:function(n,i,e){return{x:n.x,y:n.y,ox:n.ox,oy:n.oy,curX:n.curX+i,curY:n.curY+e}}},{key:"resetBounds",value:function(){this.bounds=Sr()}},{key:"findSegmentForPoint",value:function(n,i){for(var e={d:1/0,s:null,x:null,y:null,l:null,x1:null,y1:null,x2:null,y2:null,index:null,connectorLocation:null},t=0;t<this.segments.length;t++){var r=this.segments[t].findClosestPointOnPath(n,i);r.d<e.d&&(e.d=r.d,e.l=r.l,e.x=r.x,e.y=r.y,e.s=this.segments[t],e.x1=r.x1,e.x2=r.x2,e.y1=r.y1,e.y2=r.y2,e.index=t,e.connectorLocation=this.segmentProportions[t][0]+r.l*(this.segmentProportions[t][1]-this.segmentProportions[t][0]))}return e}},{key:"lineIntersection",value:function(n,i,e,t){for(var r=[],s=0;s<this.segments.length;s++)r.push.apply(r,this.segments[s].lineIntersection(n,i,e,t));return r}},{key:"boxIntersection",value:function(n,i,e,t){for(var r=[],s=0;s<this.segments.length;s++)r.push.apply(r,this.segments[s].boxIntersection(n,i,e,t));return r}},{key:"boundingBoxIntersection",value:function(n){for(var i=[],e=0;e<this.segments.length;e++)i.push.apply(i,this.segments[e].boundingBoxIntersection(n));return i}},{key:"_updateSegmentProportions",value:function(){for(var n=0,i=0;i<this.segments.length;i++){var e=this.segments[i].getLength();this.segmentProportionalLengths[i]=e/this.totalLength,this.segmentProportions[i]=[n,n+=e/this.totalLength]}}},{key:"_findSegmentForLocation",value:function(n,i){var e,t,r;if(i&&(n=n>0?n/this.totalLength:(this.totalLength+n)/this.totalLength),n===1)e=this.segments.length-1,r=1;else if(n===0)r=0,e=0;else if(n>=.5){for(e=0,r=0,t=this.segmentProportions.length-1;t>-1;t--)if(this.segmentProportions[t][1]>=n&&this.segmentProportions[t][0]<=n){e=t,r=(n-this.segmentProportions[t][0])/this.segmentProportionalLengths[t];break}}else for(e=this.segmentProportions.length-1,r=1,t=0;t<this.segmentProportions.length;t++)if(this.segmentProportions[t][1]>=n){e=t,r=(n-this.segmentProportions[t][0])/this.segmentProportionalLengths[t];break}return{segment:this.segments[e],proportion:r,index:e}}},{key:"_addSegment",value:function(n,i){if(!(i.x1===i.x2&&i.y1===i.y2)){var e=new n(i);this.segments.push(e),this.totalLength+=e.getLength(),this.updateBounds(e)}}},{key:"_clearSegments",value:function(){this.totalLength=0,this.segments.length=0,this.segmentProportions.length=0,this.segmentProportionalLengths.length=0}},{key:"getLength",value:function(){return this.totalLength}},{key:"_prepareCompute",value:function(n){this.strokeWidth=n.strokeWidth;var i=n.sourcePos.curX,e=n.targetPos.curX,t=n.sourcePos.curY,r=n.targetPos.curY,s=na({x:i,y:t},{x:e,y:r}),l=e<i,u=r<t,d=[n.sourcePos.ox,n.sourcePos.oy],h=[n.targetPos.ox,n.targetPos.oy],f=l?e:i,g=u?r:t,y=Math.abs(e-i),_=Math.abs(r-t),p=d[0]===0&&d[1]===0,C=h[0]===0&&h[1]===0;if(p||C){var b=y>_?0:1,m=[1,0][b],S=b===0?i:t,w=b===0?e:r;p&&(d[b]=S>w?-1:1,d[m]=0),C&&(h[b]=S>w?1:-1,h[m]=0)}var O=l?y+this.sourceGap*d[0]:this.sourceGap*d[0],I=u?_+this.sourceGap*d[1]:this.sourceGap*d[1],A=l?this.targetGap*h[0]:y+this.targetGap*h[0],V=u?this.targetGap*h[1]:_+this.targetGap*h[1],B=d[0]*h[0]+d[1]*h[1],H={sx:O,sy:I,tx:A,ty:V,xSpan:Math.abs(A-O),ySpan:Math.abs(V-I),mx:(O+A)/2,my:(I+V)/2,so:d,to:h,x:f,y:g,w:y,h:_,segment:s,startStubX:O+d[0]*this.sourceStub,startStubY:I+d[1]*this.sourceStub,endStubX:A+h[0]*this.targetStub,endStubY:V+h[1]*this.targetStub,isXGreaterThanStubTimes2:Math.abs(O-A)>this.sourceStub+this.targetStub,isYGreaterThanStubTimes2:Math.abs(I-V)>this.sourceStub+this.targetStub,opposite:B===-1,perpendicular:B===0,orthogonal:B===1,sourceAxis:d[0]===0?"y":"x",points:[f,g,y,_,O,I,A,V],stubs:[this.sourceStub,this.targetStub]};return H.anchorOrientation=H.opposite?"opposite":H.orthogonal?"orthogonal":"perpendicular",H}},{key:"updateBounds",value:function(n){var i=n.extents;this.bounds.xmin=Math.min(this.bounds.xmin,i.xmin),this.bounds.xmax=Math.max(this.bounds.xmax,i.xmax),this.bounds.ymin=Math.min(this.bounds.ymin,i.ymin),this.bounds.ymax=Math.max(this.bounds.ymax,i.ymax)}},{key:"dumpSegmentsToConsole",value:function(){Be("SEGMENTS:");for(var n=0;n<this.segments.length;n++)Be(this.segments[n].type,""+this.segments[n].getLength(),""+this.segmentProportions[n])}},{key:"pointOnPath",value:function(n,i){var e=this._findSegmentForLocation(n,i);return e.segment&&e.segment.pointOnPath(e.proportion,!1)||{x:0,y:0}}},{key:"gradientAtPoint",value:function(n,i){var e=this._findSegmentForLocation(n,i);return e.segment&&e.segment.gradientAtPoint(e.proportion,!1)||0}},{key:"pointAlongPathFrom",value:function(n,i,e){var t=this._findSegmentForLocation(n,e);return t.segment&&t.segment.pointAlongPathFrom(t.proportion,i,!1)||{x:0,y:0}}},{key:"compute",value:function(n){this.paintInfo=this._prepareCompute(n),this._clearSegments(),this._compute(this.paintInfo,n),this.x=this.paintInfo.points[0],this.y=this.paintInfo.points[1],this.w=this.paintInfo.points[2],this.h=this.paintInfo.points[3],this.segment=this.paintInfo.segment,this._updateSegmentProportions()}},{key:"setAnchorOrientation",value:function(n,i){}}]),o}(),yf=20,mf=20,ri=function(o){me(n,o);var a=_e(n);function n(i,e,t){var r;return $(this,n),r=a.call(this,i,e,t),r.instance=i,r.component=e,c(v(r),"width",void 0),c(v(r),"length",void 0),c(v(r),"foldback",void 0),c(v(r),"direction",void 0),c(v(r),"location",.5),c(v(r),"paintStyle",void 0),c(v(r),"type",n.type),c(v(r),"cachedDimensions",void 0),t=t||{},r.width=t.width||yf,r.length=t.length||mf,r.direction=(t.direction||1)<0?-1:1,r.foldback=t.foldback||.623,r.paintStyle=t.paintStyle||{strokeWidth:1},r.location=t.location==null?r.location:Array.isArray(t.location)?t.location[0]:t.location,r}return Z(n,[{key:"draw",value:function(e,t,r){if(e instanceof qr){var s=e,l,u,d,h,f;if(this.location>1||this.location<0){var g=this.location<0?1:0;l=s.pointAlongPathFrom(g,this.location,!1),u=s.pointAlongPathFrom(g,this.location-this.direction*this.length/2,!1),d=gn(l,u,this.length)}else if(this.location===1){if(l=s.pointOnPath(this.location),u=s.pointAlongPathFrom(this.location,-this.length),d=gn(l,u,this.length),this.direction===-1){var y=d;d=l,l=y}}else if(this.location===0){if(d=s.pointOnPath(this.location),u=s.pointAlongPathFrom(this.location,this.length),l=gn(d,u,this.length),this.direction===-1){var _=d;d=l,l=_}}else l=s.pointAlongPathFrom(this.location,this.direction*this.length/2),u=s.pointOnPath(this.location),d=gn(l,u,this.length);h=Qd(l,d,this.width),f=gn(l,d,this.foldback*this.length);var p={hxy:l,tail:h,cxy:f},C=this.paintStyle.stroke||t.stroke,b=this.paintStyle.fill||t.stroke,m=this.paintStyle.strokeWidth||t.strokeWidth;return{component:e,d:p,"stroke-width":m,stroke:C,fill:b,xmin:Math.min(l.x,h[0].x,h[1].x),xmax:Math.max(l.x,h[0].x,h[1].x),ymin:Math.min(l.y,h[0].y,h[1].y),ymax:Math.max(l.y,h[0].y,h[1].y)}}}},{key:"updateFrom",value:function(e){}}]),n}(Hr);c(ri,"type","Arrow");function Ao(o){return o.type===ri.type}xn.register(ri.type,ri);var Or=function(o){me(n,o);var a=_e(n);function n(i,e,t){var r;return $(this,n),r=a.call(this,i,e,t),r.instance=i,c(v(r),"type",n.type),r.length=r.length/2,r.foldback=2,r}return n}(ri);c(Or,"type","Diamond");function wo(o){return o.type===Or.type}xn.register(Or.type,Or);var ua=function(o){me(n,o);var a=_e(n);function n(i,e,t){var r;return $(this,n),r=a.call(this,i,e,t),r.instance=i,c(v(r),"type",n.type),r.foldback=1,r}return n}(ri);c(ua,"type","PlainArrow");function Do(o){return o.type===ua.type}xn.register("PlainArrow",ua);var Mr=function(o){me(n,o);var a=_e(n);function n(i,e,t){var r;return $(this,n),r=a.call(this,i,e,t),r.instance=i,r.component=e,c(v(r),"create",void 0),c(v(r),"type",n.type),r.create=t.create,r}return Z(n,[{key:"updateFrom",value:function(e){}}]),n}(Hr);c(Mr,"type","Custom");function $t(o){return o.type===Mr.type}xn.register(Mr.type,Mr);var _f="allowNestedGroups",Fn="paintStyle",Ef="scope",oi=function(o){me(n,o);var a=_e(n);function n(i,e){var t;return $(this,n),t=a.call(this,i,e),c(v(t),"radius",void 0),c(v(t),"defaultOffset",void 0),c(v(t),"defaultInnerRadius",void 0),c(v(t),"type",n.type),e=e||{},t.radius=e.radius||5,t.defaultOffset=.5*t.radius,t.defaultInnerRadius=t.radius/3,t}return n}(ci);c(oi,"type","Dot");var bf={type:oi.type,cls:oi,compute:function(a,n,i,e){var t=n.curX-a.radius,r=n.curY-a.radius,s=a.radius*2,l=a.radius*2;if(e&&e.stroke){var u=e.strokeWidth||1;t-=u,r-=u,s+=u*2,l+=u*2}return a.x=t,a.y=r,a.w=s,a.h=l,[t,r,s,l,a.radius]},getParams:function(a){return{radius:a.radius}}},so=function o(a,n){$(this,o),this.instance=a,this.el=n,c(this,"group",void 0)},Cf=function(o){me(n,o);var a=_e(n);function n(i,e,t){var r;$(this,n),r=a.call(this,i,e),r.instance=i,c(v(r),"children",[]),c(v(r),"collapsed",!1),c(v(r),"droppable",void 0),c(v(r),"enabled",void 0),c(v(r),"orphan",void 0),c(v(r),"constrain",void 0),c(v(r),"proxied",void 0),c(v(r),"ghost",void 0),c(v(r),"revert",void 0),c(v(r),"prune",void 0),c(v(r),"dropOverride",void 0),c(v(r),"anchor",void 0),c(v(r),"endpoint",void 0),c(v(r),"connections",{source:[],target:[],internal:[]}),c(v(r),"manager",void 0),c(v(r),"id",void 0),c(v(r),"elId",void 0);var s=r.el;return s._isJsPlumbGroup=!0,s._jsPlumbGroup=v(r),r.elId=i.getId(e),r.orphan=t.orphan===!0,r.revert=r.orphan===!0?!1:t.revert!==!1,r.droppable=t.droppable!==!1,r.ghost=t.ghost===!0,r.enabled=t.enabled!==!1,r.prune=r.orphan!==!0&&t.prune===!0,r.constrain=r.ghost||t.constrain===!0,r.proxied=t.proxied!==!1,r.id=t.id||He(),r.dropOverride=t.dropOverride===!0,r.anchor=t.anchor,r.endpoint=t.endpoint,r.anchor=t.anchor,i.setAttribute(e,cl,""),r}return Z(n,[{key:"contentArea",get:function(){return this.instance.getGroupContentArea(this)}},{key:"overrideDrop",value:function(e,t){return this.dropOverride&&(this.revert||this.prune||this.orphan)}},{key:"getAnchor",value:function(e,t){return this.anchor||"Continuous"}},{key:"getEndpoint",value:function(e,t){return this.endpoint||{type:oi.type,options:{radius:10}}}},{key:"add",value:function(e,t){var r=this.instance.getGroupContentArea(this),s=e;if(s._jsPlumbParentGroup!=null){if(s._jsPlumbParentGroup===this)return;s._jsPlumbParentGroup.remove(e,!0,t,!1)}s._jsPlumbParentGroup=this,this.children.push(new so(this.instance,e)),this.instance._appendElement(s,r),this.manager._updateConnectionsForGroup(this)}},{key:"resolveNode",value:function(e){return e==null?null:qo(this.children,function(t){return t.el===e})}},{key:"remove",value:function(e,t,r,s,l){var u=this.resolveNode(e);u!=null&&this._doRemove(u,t,r,s,l)}},{key:"_doRemove",value:function(e,t,r,s,l){var u=e.el;if(delete u._jsPlumbParentGroup,ze(this.children,function(h){return h===e}),t)try{this.instance.getGroupContentArea(this).removeChild(u)}catch(h){Be("Could not remove element from Group "+h)}if(!r){var d={group:this,el:u};l&&(d.targetGroup=l),this.instance.fire(Rc,d)}s||this.manager._updateConnectionsForGroup(this)}},{key:"removeAll",value:function(e,t){for(var r=0,s=this.children.length;r<s;r++){var l=this.children[0];this._doRemove(l,e,t,!0),this.instance.unmanage(l.el,!0)}this.children.length=0,this.manager._updateConnectionsForGroup(this)}},{key:"orphanAll",value:function(){for(var e={},t=0;t<this.children.length;t++){var r=this.manager.orphan(this.children[t].el,!1);e[r.id]=r.pos}return this.children.length=0,e}},{key:"addGroup",value:function(e){if(this.instance.allowNestedGroups&&e!==this){if(this.instance.groupManager.isAncestor(this,e))return!1;e.group!=null&&e.group.removeGroup(e);var t=this.instance.getId(e.el),r=this.instance.getManagedElements()[t];r.group=this.elId;var s=this.instance.getOffsetRelativeToRoot(e.el),l=this.collapsed?this.instance.getOffsetRelativeToRoot(this.el):this.instance.getOffsetRelativeToRoot(this.instance.getGroupContentArea(this));e.el._jsPlumbParentGroup=this,this.children.push(e),this.instance._appendElementToGroup(this,e.el),e.group=this;var u={x:s.x-l.x,y:s.y-l.y};return this.instance.setPosition(e.el,u),this.instance.fire(Fc,{parent:this,child:e}),!0}else return!1}},{key:"removeGroup",value:function(e){if(e.group===this){var t=e.el,r=this.instance.getGroupContentArea(this);r===t.parentNode&&r.removeChild(e.el);var s=this.instance.getId(e.el),l=this.instance.getManagedElements()[s];l&&delete l.group,this.children=this.children.filter(function(u){return u.id!==e.id}),delete e.group,delete t._jsPlumbParentGroup,this.instance.fire(jc,{parent:this,child:e})}}},{key:"getGroups",value:function(){return this.children.filter(function(e){return e.constructor===n})}},{key:"getNodes",value:function(){return this.children.filter(function(e){return e.constructor===so})}},{key:"collapseParent",get:function(){var e=null;if(this.group==null)return null;for(var t=this.group;t!=null;)t.collapsed&&(e=t),t=t.group;return e}}]),n}(so),kf=function(){function o(a){var n=this;$(this,o),this.instance=a,c(this,"groupMap",{}),c(this,"_connectionSourceMap",{}),c(this,"_connectionTargetMap",{}),a.bind(fl,function(i){var e=n.getGroupFor(i.source),t=n.getGroupFor(i.target);e!=null&&t!=null&&e===t?(n._connectionSourceMap[i.connection.id]=e,n._connectionTargetMap[i.connection.id]=e,gi(e.connections.internal,i.connection)):(e!=null&&(i.target._jsPlumbGroup===e?gi(e.connections.internal,i.connection):gi(e.connections.source,i.connection),n._connectionSourceMap[i.connection.id]=e),t!=null&&(i.source._jsPlumbGroup===t?gi(t.connections.internal,i.connection):gi(t.connections.target,i.connection),n._connectionTargetMap[i.connection.id]=t))}),a.bind(Ko,function(i){n._cleanupDetachedConnection(i.connection)}),a.bind(pl,function(i){var e=i.originalEndpoint.element,t=n.getGroupFor(e),r=i.connection.endpoints[i.index],s=r.element,l=n.getGroupFor(s),u=i.index===0?n._connectionSourceMap:n._connectionTargetMap,d=i.index===0?n._connectionTargetMap:n._connectionSourceMap;l!=null?(u[i.connection.id]=l,i.connection.source===i.connection.target&&(d[i.connection.id]=l)):(delete u[i.connection.id],i.connection.source===i.connection.target&&delete d[i.connection.id]),t!=null&&n._updateConnectionsForGroup(t),l!=null&&n._updateConnectionsForGroup(l)})}return Z(o,[{key:"_cleanupDetachedConnection",value:function(n){n.proxies.length=0;var i=this._connectionSourceMap[n.id],e;i!=null&&(e=function(r){return r.id===n.id},ze(i.connections.source,e),ze(i.connections.target,e),ze(i.connections.internal,e),delete this._connectionSourceMap[n.id]),i=this._connectionTargetMap[n.id],i!=null&&(e=function(r){return r.id===n.id},ze(i.connections.source,e),ze(i.connections.target,e),ze(i.connections.internal,e),delete this._connectionTargetMap[n.id])}},{key:"addGroup",value:function(n){var i=n.el;if(this.groupMap[n.id]!=null)throw new Error("cannot create Group ["+n.id+"]; a Group with that ID exists");if(i._isJsPlumbGroup!=null)throw new Error("cannot create Group ["+n.id+"]; the given element is already a Group");var e=new Cf(this.instance,n.el,n);return this.groupMap[e.id]=e,n.collapsed&&this.collapseGroup(e),this.instance.manage(e.el),this.instance.addClass(e.el,_i),e.manager=this,this._updateConnectionsForGroup(e),this.instance.fire(Mc,{group:e}),e}},{key:"getGroup",value:function(n){var i=n;if(Le(n)&&(i=this.groupMap[n],i==null))throw new Error("No such group ["+n+"]");return i}},{key:"getGroupFor",value:function(n){for(var i=n,e=this.instance.getContainer(),t=!1,r=null;!t;)i==null||i===e?t=!0:i._jsPlumbParentGroup?(r=i._jsPlumbParentGroup,t=!0):i=i.parentNode;return r}},{key:"getGroups",value:function(){var n=[];for(var i in this.groupMap)n.push(this.groupMap[i]);return n}},{key:"removeGroup",value:function(n,i,e,t){var r=this,s=this.getGroup(n);this.expandGroup(s,!0);var l={};return Q(s.children,function(u){var d=r.instance.getManagedElements()[r.instance.getId(u.el)];d&&delete d.group}),i?(Q(s.getGroups(),function(u){return r.removeGroup(u,i,e)}),s.removeAll(e,t)):(s.group&&Q(s.children,function(u){return s.group.add(u.el)}),l=s.orphanAll()),s.group&&s.group.removeGroup(s),this.instance.unmanage(s.el,!0),delete this.groupMap[s.id],this.instance.fire(Gc,{group:s}),l}},{key:"removeAllGroups",value:function(n,i,e){for(var t in this.groupMap)this.removeGroup(this.groupMap[t],n,i,e)}},{key:"forEach",value:function(n){for(var i in this.groupMap)n(this.groupMap[i])}},{key:"orphan",value:function(n,i){var e=n;if(e._jsPlumbParentGroup){var t=e._jsPlumbParentGroup,r=this.instance.getId(e),s=this.instance.getOffset(n);return i!==!0&&t.group?this.instance._appendElementToGroup(t.group,n):this.instance._appendElementToContainer(n),this.instance.setPosition(n,s),delete e._jsPlumbParentGroup,{id:r,pos:s}}}},{key:"_updateConnectionsForGroup",value:function(n){var i=this;n.connections.source.length=0,n.connections.target.length=0,n.connections.internal.length=0;var e=n.children.slice().map(function(f){return f.el}),t=[];if(Q(e,function(f){Array.prototype.push.apply(t,i.instance.getSelector(f,Oe))}),Array.prototype.push.apply(e,t),e.length>0){var r=this.instance.getConnections({source:e,scope:mn},!0),s=this.instance.getConnections({target:e,scope:mn},!0),l={},u,d,h=function(g){for(var y=0;y<g.length;y++)l[g[y].id]||(l[g[y].id]=!0,u=i.getGroupFor(g[y].source),d=i.getGroupFor(g[y].target),g[y].source===n.el&&d===n||g[y].target===n.el&&u===n?n.connections.internal.push(g[y]):u===n?(d!==n?n.connections.source.push(g[y]):n.connections.internal.push(g[y]),i._connectionSourceMap[g[y].id]=n):d===n&&(n.connections.target.push(g[y]),i._connectionTargetMap[g[y].id]=n))};h(r),h(s)}}},{key:"_collapseConnection",value:function(n,i,e){var t=n.endpoints[i===0?1:0].element;if(t._jsPlumbParentGroup&&!t._jsPlumbParentGroup.proxied&&t._jsPlumbParentGroup.collapsed)return!1;var r=n.endpoints[0].element,s=r._jsPlumbParentGroup,l=s!=null?s.collapseParent||s:null,u=n.endpoints[1].element,d=u._jsPlumbParentGroup,h=d!=null?d.collapseParent||d:null;if(l==null||h==null||l.id!==h.id){var f=e.el;return this.instance.getId(f),this.instance.proxyConnection(n,i,f,function(g,y){return e.getEndpoint(g,y)},function(g,y){return e.getAnchor(g,y)}),!0}else return!1}},{key:"_expandConnection",value:function(n,i,e){this.instance.unproxyConnection(n,i)}},{key:"isElementDescendant",value:function(n,i){for(var e=this.instance.getContainer(),t=!1;!t;){if(n==null||n===e)return!1;if(n===i)return!0;n=n.parentNode}}},{key:"collapseGroup",value:function(n){var i=this,e=this.getGroup(n);if(!(e==null||e.collapsed)){var t=e.el;if(e.collapseParent==null){if(this.instance.setGroupVisible(e,!1),e.collapsed=!0,this.instance.removeClass(t,_i),this.instance.addClass(t,nr),e.proxied){var r=new Set,s=function(u,d){for(var h=0;h<u.length;h++){var f=u[h];i._collapseConnection(f,d,e)===!0&&r.add(f.id)}};s(e.connections.source,0),s(e.connections.target,1),Q(e.getGroups(),function(l){i.cascadeCollapse(e,l,r)})}this.instance.revalidate(t),this.repaintGroup(e),this.instance.fire(Ic,{group:e})}else e.collapsed=!0,this.instance.removeClass(t,_i),this.instance.addClass(t,nr)}}},{key:"cascadeCollapse",value:function(n,i,e){var t=this;if(n.proxied){var r=function(l,u){for(var d=0;d<l.length;d++){var h=l[d];e.has(h.id)||t._collapseConnection(h,u,n)===!0&&e.add(h.id)}};r(i.connections.source,0),r(i.connections.target,1)}Q(i.getGroups(),function(s){t.cascadeCollapse(n,s,e)})}},{key:"expandGroup",value:function(n,i){var e=this,t=this.getGroup(n);if(t!=null){var r=t.el;if(t.collapseParent==null){if(this.instance.setGroupVisible(t,!0),t.collapsed=!1,this.instance.addClass(r,_i),this.instance.removeClass(r,nr),t.proxied){var s=function(d,h){for(var f=0;f<d.length;f++){var g=d[f];e._expandConnection(g,h,t)}};s(t.connections.source,0),s(t.connections.target,1);var l=function u(d,h){if(h||d.collapsed){var f=function(y,_){for(var p=0;p<y.length;p++){var C=y[p];e._collapseConnection(C,_,d.collapseParent||d)}};f(d.connections.source,0),f(d.connections.target,1),Q(d.connections.internal,function(g){return g.setVisible(!1)}),Q(d.getGroups(),function(g){return u(g,!0)})}else e.expandGroup(d,!0)};Q(t.getGroups(),l)}this.instance.revalidate(r),this.repaintGroup(t),i||this.instance.fire(Lc,{group:t})}else t.collapsed=!1,this.instance.addClass(r,_i),this.instance.removeClass(r,nr)}}},{key:"toggleGroup",value:function(n){n=this.getGroup(n),n!=null&&(n.collapsed?this.expandGroup(n):this.collapseGroup(n))}},{key:"repaintGroup",value:function(n){for(var i=this.getGroup(n),e=i.children,t=0;t<e.length;t++)this.instance.revalidate(e[t].el)}},{key:"addToGroup",value:function(n,i){var e=this,t=this.getGroup(n);if(t){for(var r=t.el,s=function(f){var g=f,y=g._isJsPlumbGroup!=null,_=g._jsPlumbGroup,p=g._jsPlumbParentGroup;if(p!==t){var C=e.instance.manage(f),b=e.instance.getOffset(f),m=t.collapsed?e.instance.getOffsetRelativeToRoot(r):e.instance.getOffset(e.instance.getGroupContentArea(t));C.group=t.elId,p!=null&&(p.remove(f,!1,i,!1,t),e._updateConnectionsForGroup(p)),y?t.addGroup(_):t.add(f,i);var S=function(A,V){var B=V===0?1:0;A.each(function(H){H.setVisible(!1),H.endpoints[B].element._jsPlumbGroup===t?(H.endpoints[B].setVisible(!1),e._expandConnection(H,B,t)):(H.endpoints[V].setVisible(!1),e._collapseConnection(H,V,t))})};t.collapsed&&(S(e.instance.select({source:f}),0),S(e.instance.select({target:f}),1)),e.instance.getId(f);var w={x:b.x-m.x,y:b.y-m.y};if(e.instance.setPosition(f,w),e._updateConnectionsForGroup(t),e.instance.revalidate(f),!i){var O={group:t,el:f,pos:w};p&&(O.sourceGroup=p),e.instance.fire(Nc,O)}}},l=arguments.length,u=new Array(l>2?l-2:0),d=2;d<l;d++)u[d-2]=arguments[d];Q(u,s)}}},{key:"removeFromGroup",value:function(n,i){var e=this,t=this.getGroup(n);if(t){for(var r=function(h){if(t.collapsed){var f=function(_,p){for(var C=0;C<_.length;C++){var b=_[C];if(b.proxies){for(var m=0;m<b.proxies.length;m++)if(b.proxies[m]!=null){var S=b.proxies[m].originalEp.element;(S===h||e.isElementDescendant(S,h))&&e._expandConnection(b,p,t)}}}};f(t.connections.source.slice(),0),f(t.connections.target.slice(),1)}t.remove(h,null,i);var g=e.instance.getManagedElements()[e.instance.getId(h)];g&&delete g.group},s=arguments.length,l=new Array(s>2?s-2:0),u=2;u<s;u++)l[u-2]=arguments[u];Q(l,r)}}},{key:"getAncestors",value:function(n){for(var i=[],e=n.group;e!=null;)i.push(e),e=e.group;return i}},{key:"isAncestor",value:function(n,i){return n==null||i==null?!1:this.getAncestors(n).indexOf(i)!==-1}},{key:"getDescendants",value:function(n){var i=[],e=function t(r){var s=r.getGroups();i.push.apply(i,Jn(s)),Q(s,t)};return e(n),i}},{key:"isDescendant",value:function(n,i){return n==null||i==null?!1:this.getDescendants(i).indexOf(n)!==-1}},{key:"reset",value:function(){this._connectionSourceMap={},this._connectionTargetMap={},this.groupMap={}}}]),o}(),$l=function(){function o(a,n){$(this,o),this.instance=a,this.entries=n}return Z(o,[{key:"length",get:function(){return this.entries.length}},{key:"each",value:function(n){return Q(this.entries,function(i){return n(i)}),this}},{key:"get",value:function(n){return this.entries[n]}},{key:"addClass",value:function(n,i){return this.each(function(e){return e.addClass(n,i)}),this}},{key:"removeClass",value:function(n,i){return this.each(function(e){return e.removeClass(n,i)}),this}},{key:"removeAllOverlays",value:function(){return this.each(function(n){return n.removeAllOverlays()}),this}},{key:"setLabel",value:function(n){return this.each(function(i){return i.setLabel(n)}),this}},{key:"clear",value:function(){return this.entries.length=0,this}},{key:"map",value:function(n){var i=[];return this.each(function(e){return i.push(n(e))}),i}},{key:"addOverlay",value:function(n){return this.each(function(i){return i.addOverlay(n)}),this}},{key:"removeOverlay",value:function(n){return this.each(function(i){return i.removeOverlay(n)}),this}},{key:"removeOverlays",value:function(){return this.each(function(n){return n.removeOverlays()}),this}},{key:"showOverlay",value:function(n){return this.each(function(i){return i.showOverlay(n)}),this}},{key:"hideOverlay",value:function(n){return this.each(function(i){return i.hideOverlay(n)}),this}},{key:"setPaintStyle",value:function(n){return this.each(function(i){return i.setPaintStyle(n)}),this}},{key:"setHoverPaintStyle",value:function(n){return this.each(function(i){return i.setHoverPaintStyle(n)}),this}},{key:"setSuspendEvents",value:function(n){return this.each(function(i){return i.setSuspendEvents(n)}),this}},{key:"setParameter",value:function(n,i){return this.each(function(e){return e.parameters[n]=i}),this}},{key:"setParameters",value:function(n){return this.each(function(i){return i.parameters=n}),this}},{key:"setVisible",value:function(n){return this.each(function(i){return i.setVisible(n)}),this}},{key:"addType",value:function(n){return this.each(function(i){return i.addType(n)}),this}},{key:"toggleType",value:function(n){return this.each(function(i){return i.toggleType(n)}),this}},{key:"removeType",value:function(n){return this.each(function(i){return i.removeType(n)}),this}},{key:"bind",value:function(n,i){return this.each(function(e){return e.bind(n,i)}),this}},{key:"unbind",value:function(n,i){return this.each(function(e){return e.unbind(n,i)}),this}},{key:"setHover",value:function(n){var i=this;return this.each(function(e){return i.instance.setHover(e,n)}),this}}]),o}(),xf=function(o){me(n,o);var a=_e(n);function n(){return $(this,n),a.apply(this,arguments)}return Z(n,[{key:"setEnabled",value:function(e){return this.each(function(t){return t.enabled=e}),this}},{key:"setAnchor",value:function(e){return this.each(function(t){return t.setAnchor(e)}),this}},{key:"deleteEveryConnection",value:function(){return this.each(function(e){return e.deleteEveryConnection()}),this}},{key:"deleteAll",value:function(){var e=this;return this.each(function(t){return e.instance.deleteEndpoint(t)}),this.clear(),this}}]),n}($l),Sf=function(o){me(n,o);var a=_e(n);function n(){return $(this,n),a.apply(this,arguments)}return Z(n,[{key:"setDetachable",value:function(e){return this.each(function(t){return t.setDetachable(e)}),this}},{key:"setReattach",value:function(e){return this.each(function(t){return t.setReattach(e)}),this}},{key:"setConnector",value:function(e){return this.each(function(t){return t._setConnector(e)}),this}},{key:"deleteAll",value:function(){var e=this;this.each(function(t){return e.instance.deleteConnection(t)}),this.clear()}},{key:"repaint",value:function(){var e=this;return this.each(function(t){return e.instance._paintConnection(t)}),this}}]),n}($l),Tf=function o(){$(this,o),c(this,"affectedElements",new Set)};function gs(){return{x:0,y:0,w:0,h:0,r:0,c:{x:0,y:0},x2:0,y2:0,t:{x:0,y:0,c:{x:0,y:0},w:0,h:0,r:0,x2:0,y2:0,cr:0,sr:0},dirty:!0}}function Pf(o,a,n,i,e){var t={x:o+n/2,y:a+i/2},r=Math.cos(e/360*Math.PI*2),s=Math.sin(e/360*Math.PI*2),l=function(m,S){return{x:t.x+Math.round((m-t.x)*r-(S-t.y)*s),y:t.y+Math.round((S-t.y)*r-(m-t.x)*s)}},u=l(o,a),d=l(o+n,a),h=l(o+n,a+i),f=l(o,a+i),g=l(o+n/2,a+i/2),y=Math.min(u.x,d.x,h.x,f.x),_=Math.max(u.x,d.x,h.x,f.x),p=Math.min(u.y,d.y,h.y,f.y),C=Math.max(u.y,d.y,h.y,f.y);return{x:y,y:p,w:_-y,h:C-p,c:g,r:e,x2:_,y2:C,cr:r,sr:s}}var Ir=function(a,n){var i=0;return n[1]>a[1]?i=-1:n[1]<a[1]&&(i=1),i},ys=function(a,n){return Ir(a,n)*-1};function ar(o,a,n,i){uc([o,a],n,Ir,i)}function Xt(o,a){var n=en(a,function(i){return i[0]===o});n>-1&&a.splice(n,1)}var Af=function(o){me(n,o);var a=_e(n);function n(i){var e;return $(this,n),e=a.call(this),e.instance=i,c(v(e),"_currentTransaction",null),c(v(e),"_sortedElements",{xmin:[],xmax:[],ymin:[],ymax:[]}),c(v(e),"_elementMap",new Map),c(v(e),"_transformedElementMap",new Map),c(v(e),"_bounds",{minx:0,maxx:0,miny:0,maxy:0}),e}return Z(n,[{key:"_updateBounds",value:function(e,t,r){t!=null&&(Xt(e,this._sortedElements.xmin),Xt(e,this._sortedElements.xmax),Xt(e,this._sortedElements.ymin),Xt(e,this._sortedElements.ymax),ar(e,t.t.x,this._sortedElements.xmin,!1),ar(e,t.t.x+t.t.w,this._sortedElements.xmax,!0),ar(e,t.t.y,this._sortedElements.ymin,!1),ar(e,t.t.y+t.t.h,this._sortedElements.ymax,!0),r!==!0&&this._recalculateBounds())}},{key:"_recalculateBounds",value:function(){this._bounds.minx=this._sortedElements.xmin.length>0?this._sortedElements.xmin[0][1]:0,this._bounds.maxx=this._sortedElements.xmax.length>0?this._sortedElements.xmax[0][1]:0,this._bounds.miny=this._sortedElements.ymin.length>0?this._sortedElements.ymin[0][1]:0,this._bounds.maxy=this._sortedElements.ymax.length>0?this._sortedElements.ymax[0][1]:0}},{key:"recomputeBounds",value:function(){var e=this;this._sortedElements.xmin.length=0,this._sortedElements.xmax.length=0,this._sortedElements.ymin.length=0,this._sortedElements.ymax.length=0,this._elementMap.forEach(function(t,r){e._sortedElements.xmin.push([r,t.t.x]),e._sortedElements.xmax.push([r,t.t.x+t.t.w]),e._sortedElements.ymin.push([r,t.t.y]),e._sortedElements.ymax.push([r,t.t.y+t.t.h])}),this._sortedElements.xmin.sort(Ir),this._sortedElements.ymin.sort(Ir),this._sortedElements.xmax.sort(ys),this._sortedElements.ymax.sort(ys),this._recalculateBounds()}},{key:"_finaliseUpdate",value:function(e,t,r){t.t=Pf(t.x,t.y,t.w,t.h,t.r),this._transformedElementMap.set(e,t.t),r!==!0&&this._updateBounds(e,t,r)}},{key:"shouldFireEvent",value:function(e,t,r){return!0}},{key:"startTransaction",value:function(){if(this._currentTransaction!=null)throw new Error("Viewport: cannot start transaction; a transaction is currently active.");this._currentTransaction=new Tf}},{key:"endTransaction",value:function(){var e=this;this._currentTransaction!=null&&(this._currentTransaction.affectedElements.forEach(function(t){var r=e.getPosition(t);e._finaliseUpdate(t,r,!0)}),this.recomputeBounds(),this._currentTransaction=null)}},{key:"updateElements",value:function(e){var t=this;Q(e,function(r){return t.updateElement(r.id,r.x,r.y,r.width,r.height,r.rotation)})}},{key:"updateElement",value:function(e,t,r,s,l,u,d){var h=Na(this._elementMap,e,gs);return h.dirty=t==null&&h.x==null||r==null&&h.y==null||s==null&&h.w==null||l==null&&h.h==null,t!=null&&(h.x=t),r!=null&&(h.y=r),s!=null&&(h.w=s),l!=null&&(h.h=l),u!=null&&(h.r=u||0),h.c.x=h.x+h.w/2,h.c.y=h.y+h.h/2,h.x2=h.x+h.w,h.y2=h.y+h.h,this._currentTransaction==null?this._finaliseUpdate(e,h,d):this._currentTransaction.affectedElements.add(e),h}},{key:"refreshElement",value:function(e,t){var r=this.instance.getManagedElements(),s=r[e]?r[e].el:null;if(s!=null){var l=this.getSize(s),u=this.getOffset(s);return this.updateElement(e,u.x,u.y,l.w,l.h,null,t)}else return null}},{key:"getSize",value:function(e){return this.instance.getSize(e)}},{key:"getOffset",value:function(e){return this.instance.getOffset(e)}},{key:"registerElement",value:function(e,t){return this.updateElement(e,0,0,0,0,0,t)}},{key:"addElement",value:function(e,t,r,s,l,u){return this.updateElement(e,t,r,s,l,u)}},{key:"rotateElement",value:function(e,t){var r=Na(this._elementMap,e,gs);return r.r=t||0,this._finaliseUpdate(e,r),r}},{key:"getBoundsWidth",value:function(){return this._bounds.maxx-this._bounds.minx}},{key:"getBoundsHeight",value:function(){return this._bounds.maxy-this._bounds.miny}},{key:"getX",value:function(){return this._bounds.minx}},{key:"getY",value:function(){return this._bounds.miny}},{key:"setSize",value:function(e,t,r){if(this._elementMap.has(e))return this.updateElement(e,null,null,t,r,null)}},{key:"setPosition",value:function(e,t,r){if(this._elementMap.has(e))return this.updateElement(e,t,r,null,null,null)}},{key:"reset",value:function(){this._sortedElements.xmin.length=0,this._sortedElements.xmax.length=0,this._sortedElements.ymin.length=0,this._sortedElements.ymax.length=0,this._elementMap.clear(),this._transformedElementMap.clear(),this._recalculateBounds()}},{key:"remove",value:function(e){Xt(e,this._sortedElements.xmin),Xt(e,this._sortedElements.xmax),Xt(e,this._sortedElements.ymin),Xt(e,this._sortedElements.ymax),this._elementMap.delete(e),this._transformedElementMap.delete(e),this._recalculateBounds()}},{key:"getPosition",value:function(e){return this._elementMap.get(e)}},{key:"getElements",value:function(){return this._elementMap}},{key:"isEmpty",value:function(){return this._elementMap.size===0}}]),n}($i),jn;function wf(o,a,n,i,e){for(var t=n?o.w:o.h,r=n?o.h:o.w,s=[],l=t/(a.length+1),u=0;u<a.length;u++){var d=(u+1)*l,h=i*r;e&&(d=t-d);var f=n?d:h,g=o.x+f,y=f/o.w,_=n?h:d,p=o.y+_,C=_/o.h;if(o.r!==0&&o.r!=null){var b=Cr({x:g,y:p},o.c,o.r);g=b.x,p=b.y}s.push({x:g,y:p,xLoc:y,yLoc:C,c:a[u].c})}return s}function ms(o,a){return a.theta-o.theta}function _s(o,a){var n=o.theta<0?-Math.PI-o.theta:Math.PI-o.theta,i=a.theta<0?-Math.PI-a.theta:Math.PI-a.theta;return n-i}var Df=(jn={},c(jn,Re,_s),c(jn,Ke,ms),c(jn,at,ms),c(jn,et,_s),jn);function Wt(o){return o.isContinuous===!0}function Es(o){return o.isContinuous===!0}function Of(o){return o.locations.length>1}function bs(o){return[o.currentLocation,o.locations[o.currentLocation]]}var Mf=function(){function o(a){var n=this;$(this,o),this.instance=a,c(this,"anchorLists",new Map),c(this,"anchorLocations",new Map),a.bind(Ko,function(i){i.sourceEndpoint._anchor.isContinuous&&n._removeEndpointFromAnchorLists(i.sourceEndpoint),i.targetEndpoint._anchor.isContinuous&&n._removeEndpointFromAnchorLists(i.targetEndpoint)}),a.bind(gl,function(i){n._removeEndpointFromAnchorLists(i)})}return Z(o,[{key:"getAnchorOrientation",value:function(n){var i=this.anchorLocations.get(n.id);return i?[i.ox,i.oy]:[0,0]}},{key:"_distance",value:function(n,i,e,t,r,s,l){var u=t.x+n.x*r.w,d=t.y+n.y*r.h,h=t.x+r.w/2,f=t.y+r.h/2;if(s!=null&&s.length>0){var g=this.instance._applyRotations([u,d,0,0],s);u=g.x,d=g.y}return Math.sqrt(Math.pow(i-u,2)+Math.pow(e-d,2))+Math.sqrt(Math.pow(h-u,2)+Math.pow(f-d,2))}},{key:"_anchorSelector",value:function(n,i,e,t,r,s,l){for(var u=e.x+t.w/2,d=e.y+t.h/2,h=-1,f=1/0,g=0;g<l.length;g++){var y=this._distance(l[g],u,d,n,i,r,s);y<f&&(h=g+0,f=y)}return[h,l[h]]}},{key:"_floatingAnchorCompute",value:function(n,i){var e=i.xy,t={curX:e.x+n.size.w/2,curY:e.y+n.size.h/2,x:0,y:0,ox:0,oy:0};return this._setComputedPosition(n,t)}},{key:"_setComputedPosition",value:function(n,i,e){return this.anchorLocations.set(n.id,i),n.computedPosition=i,e&&(n.timestamp=e),i}},{key:"_computeSingleLocation",value:function(n,i,e,t){var r,s=t.rotation,l={curX:i.x+n.x*e.w+n.offx,curY:i.y+n.y*e.h+n.offy,x:n.x,y:n.y,ox:0,oy:0};if(s!=null&&s.length>0){var u=[n.iox,n.ioy],d={x:l.curX,y:l.curY,cr:0,sr:0};Q(s,function(h){d=Cr(d,h.c,h.r);var f=[Math.round(u[0]*d.cr-u[1]*d.sr),Math.round(u[1]*d.cr+u[0]*d.sr)];u=f.slice()}),n.ox=u[0],n.oy=u[1],r={curX:d.x,curY:d.y,x:n.x,y:n.y,ox:u[0],oy:u[1]}}else n.ox=n.iox,n.oy=n.ioy,r=K({ox:n.iox,oy:n.ioy},l);return r}},{key:"_singleAnchorCompute",value:function(n,i){var e=i.xy,t=i.wh,r=i.timestamp,s=this.anchorLocations.get(n.id);if(s!=null&&r&&r===n.timestamp)return s;var l=bs(n),u=fr(l,2);u[0];var d=u[1];return s=this._computeSingleLocation(d,e,t,i),this._setComputedPosition(n,s,r)}},{key:"_defaultAnchorCompute",value:function(n,i){var e;if(n.locations.length===1)return this._singleAnchorCompute(n,i);var t=i.xy,r=i.wh,s=i.txy,l=i.twh,u=bs(n),d=fr(u,2),h=d[0],f=d[1];if(n.locked||s==null||l==null)e=this._computeSingleLocation(f,t,r,i);else{var g=this._anchorSelector(t,r,s,l,i.rotation,i.tRotation,n.locations),y=fr(g,2),_=y[0],p=y[1];n.currentLocation=_,_!==h&&(n.cssClass=p.cls||n.cssClass,i.element._anchorLocationChanged(n)),e=this._computeSingleLocation(p,t,r,i)}return this._setComputedPosition(n,e,i.timestamp)}},{key:"_placeAnchors",value:function(n,i){var e=this,t=this.instance.viewport.getPosition(n),r=function(l,u,d,h,f,g){if(d.length>0)for(var y=d.sort(Df[l]),_=l===Ke||l===Re,p=wf(t,y,h,f,_),C=0;C<p.length;C++){var b=p[C].c,m=b.endpoints[0].elementId===n,S=m?b.endpoints[0]:b.endpoints[1];e._setComputedPosition(S._anchor,{curX:p[C].x,curY:p[C].y,x:p[C].xLoc,y:p[C].yLoc,ox:g[0],oy:g[1]})}};r(at,t,i.bottom,!0,1,[0,1]),r(Re,t,i.top,!0,0,[0,-1]),r(et,t,i.left,!1,0,[-1,0]),r(Ke,t,i.right,!1,1,[1,0])}},{key:"_updateAnchorList",value:function(n,i,e,t,r,s,l,u,d,h,f){var g=t.endpoints[l],y=g.id,_=[1,0][l],p={theta:i,order:e,c:t,b:r,elId:s,epId:y},C=n[d],b=g._continuousAnchorEdge?n[g._continuousAnchorEdge]:null,m;if(b){var S=en(b,function(A){return A.epId===y});if(S!==-1){b.splice(S,1);for(var w=0;w<b.length;w++)m=b[w].c,m.placeholder!==!0&&h.add(m),f.add(b[w].c.endpoints[l]),f.add(b[w].c.endpoints[_])}}for(var O=0;O<C.length;O++)m=C[O].c,m.placeholder!==!0&&h.add(m),f.add(C[O].c.endpoints[l]),f.add(C[O].c.endpoints[_]);{var I=u?0:C.length;C.splice(I,0,p)}g._continuousAnchorEdge=d}},{key:"_removeEndpointFromAnchorLists",value:function(n){var i=this.anchorLists.get(n.elementId),e=0;(function(t,r){if(t){var s=function(u){return u.epId===r};ze(t.top,s),ze(t.left,s),ze(t.bottom,s),ze(t.right,s),e+=t.top.length,e+=t.left.length,e+=t.bottom.length,e+=t.right.length}})(i,n.id),e===0&&this.anchorLists.delete(n.elementId),this.anchorLocations.delete(n._anchor.id)}},{key:"computeAnchorLocation",value:function(n,i){var e;return Wt(n)?e=this.anchorLocations.get(n.id)||{curX:0,curY:0,x:0,y:0,ox:0,oy:0}:Es(n)?e=this._floatingAnchorCompute(n,i):e=this._defaultAnchorCompute(n,i),n.timestamp=i.timestamp,e}},{key:"computePath",value:function(n,i){var e=this.instance.viewport.getPosition(n.sourceId),t=this.instance.viewport.getPosition(n.targetId),r=n.endpoints[0],s=n.endpoints[1],l=this.getEndpointLocation(r,{xy:e,wh:e,element:r,timestamp:i,rotation:this.instance._getRotations(n.sourceId)}),u=this.getEndpointLocation(s,{xy:t,wh:t,element:s,timestamp:i,rotation:this.instance._getRotations(n.targetId)});n.connector.resetBounds(),n.connector.compute({sourcePos:l,targetPos:u,sourceEndpoint:n.endpoints[0],targetEndpoint:n.endpoints[1],strokeWidth:n.paintStyleInUse.strokeWidth,sourceInfo:e,targetInfo:t})}},{key:"getEndpointLocation",value:function(n,i){i=i||{};var e=n._anchor,t=this.anchorLocations.get(e.id);return(t==null||i.timestamp!=null&&e.timestamp!==i.timestamp)&&(t=this.computeAnchorLocation(e,i),this._setComputedPosition(e,t,i.timestamp)),t}},{key:"getEndpointOrientation",value:function(n){return n._anchor?this.getAnchorOrientation(n._anchor):[0,0]}},{key:"setAnchorOrientation",value:function(n,i){var e=this.anchorLocations.get(n.id);e!=null&&(e.ox=i[0],e.oy=i[1])}},{key:"isDynamicAnchor",value:function(n){return n._anchor?!Wt(n._anchor)&&n._anchor.locations.length>1:!1}},{key:"isFloating",value:function(n){return n._anchor?Es(n._anchor):!1}},{key:"prepareAnchor",value:function(n){return Mi(n)}},{key:"redraw",value:function(n,i,e){var t=this,r=new Set,s=new Set,l=new Set;if(!this.instance._suspendDrawing){var u=this.instance.endpointsByElement[n]||[];i=i||He();for(var d={},h,f,g=0;g<u.length;g++)if(f=u[g],f.visible!==!1)if(s.add(f),h=f._anchor,f.connections.length===0)Wt(h)&&(this.anchorLists.has(n)||this.anchorLists.set(n,{top:[],right:[],bottom:[],left:[]}),this._updateAnchorList(this.anchorLists.get(n),-Math.PI/2,0,{endpoints:[f,f],placeholder:!0},!1,n,0,!1,Dh(h),r,s),l.add(n));else for(var y=0;y<f.connections.length;y++){var _=f.connections[y],p=_.sourceId,C=_.targetId,b=Wt(_.endpoints[0]._anchor),m=Wt(_.endpoints[1]._anchor);if(b||m){var S=(_.endpoints[0]._anchor.faces||[]).join("-"),w=(_.endpoints[1]._anchor.faces||[]).join("-"),O=[p,S,C,w].join("-"),I=d[O],A=_.sourceId===n?1:0;b&&!this.anchorLists.has(p)&&this.anchorLists.set(p,{top:[],right:[],bottom:[],left:[]}),m&&!this.anchorLists.has(C)&&this.anchorLists.set(C,{top:[],right:[],bottom:[],left:[]});var V=this.instance.viewport.getPosition(C),B=this.instance.viewport.getPosition(p);if(C===p&&(b||m))this._updateAnchorList(this.anchorLists.get(p),-Math.PI/2,0,_,!1,C,0,!1,Re,r,s),this._updateAnchorList(this.anchorLists.get(C),-Math.PI/2,0,_,!1,p,1,!1,Re,r,s);else{var H=this.instance._getRotations(p),R=this.instance._getRotations(C);I||(I=this._calculateOrientation(p,C,B,V,_.endpoints[0]._anchor,_.endpoints[1]._anchor,H,R),d[O]=I),b&&this._updateAnchorList(this.anchorLists.get(p),I.theta,0,_,!1,C,0,!1,I.a[0],r,s),m&&this._updateAnchorList(this.anchorLists.get(C),I.theta2,-1,_,!0,p,1,!0,I.a[1],r,s)}b&&l.add(p),m&&l.add(C),r.add(_),(b&&A===0||m&&A===1)&&s.add(_.endpoints[A])}else{var he=f.connections[y].endpoints[_.sourceId===n?1:0],U=he._anchor;if(Of(U)){this.instance._paintEndpoint(he,{elementWithPrecedence:n,timestamp:i}),r.add(f.connections[y]);for(var J=0;J<he.connections.length;J++)he.connections[J]!==f.connections[y]&&r.add(he.connections[J])}else r.add(f.connections[y])}}l.forEach(function(T){t._placeAnchors(T,t.anchorLists.get(T))}),s.forEach(function(T){var k=t.instance.viewport.getPosition(T.elementId);t.instance._paintEndpoint(T,{timestamp:i,offset:k})}),r.forEach(function(T){t.instance._paintConnection(T,{timestamp:i})})}return{c:r,e:s}}},{key:"reset",value:function(){this.anchorLocations.clear(),this.anchorLists.clear()}},{key:"setAnchor",value:function(n,i){i!=null&&(n._anchor=i)}},{key:"setConnectionAnchors",value:function(n,i){n.endpoints[0]._anchor=i[0],n.endpoints[1]._anchor=i[1]}},{key:"_calculateOrientation",value:function(n,i,e,t,r,s,l,u){var d=this,h={HORIZONTAL:"horizontal",VERTICAL:"vertical",DIAGONAL:"diagonal",IDENTITY:"identity"};if(n===i)return{orientation:h.IDENTITY,a:[Re,Re]};var f=Math.atan2(t.c.y-e.c.y,t.c.x-e.c.x),g=Math.atan2(e.c.y-t.c.y,e.c.x-t.c.x),y=[],_={};(function(O,I){for(var A=0;A<O.length;A++){var V;if(_[O[A]]=(V={},c(V,et,{x:I[A][0].x,y:I[A][0].c.y}),c(V,Ke,{x:I[A][0].x+I[A][0].w,y:I[A][0].c.y}),c(V,Re,{x:I[A][0].c.x,y:I[A][0].y}),c(V,at,{x:I[A][0].c.x,y:I[A][0].y+I[A][0].h}),V),I[A][1]!=null&&I[A][1].length>0)for(var B in _[O[A]])_[O[A]][B]=d.instance._applyRotationsXY(_[O[A]][B],I[A][1])}})([Eo,ul],[[e,l],[t,u]]);for(var p=[Re,et,Ke,at],C=0;C<p.length;C++)for(var b=0;b<p.length;b++)y.push({source:p[C],target:p[b],dist:So(_.source[p[C]],_.target[p[b]])});y.sort(function(O,I){if(O.dist<I.dist)return-1;if(I.dist<O.dist)return 1;var A,V=(A={},c(A,et,0),c(A,Re,1),c(A,Ke,2),c(A,at,3),A),B=V[O.source],H=V[I.source],R=V[O.target],he=V[I.target];return B<H?-1:H<B?1:R<he?-1:he<R?1:0});for(var m=y[0].source,S=y[0].target,w=0;w<y.length&&(Wt(r)&&r.locked?m=r.currentFace:!r.isContinuous||Ja(r,y[w].source)?m=y[w].source:m=null,s.isContinuous&&s.locked?S=s.currentFace:!s.isContinuous||Ja(s,y[w].target)?S=y[w].target:S=null,!(m!=null&&S!=null));w++);return r.isContinuous&&this.setCurrentFace(r,m),s.isContinuous&&this.setCurrentFace(s,S),{a:[m,S],theta:f,theta2:g}}},{key:"setCurrentFace",value:function(n,i,e){n.currentFace=i,e&&n.lockedFace!=null&&(n.lockedFace=n.currentFace)}},{key:"lock",value:function(n){n.locked=!0,Wt(n)&&(n.lockedFace=n.currentFace)}},{key:"unlock",value:function(n){n.locked=!1,Wt(n)&&(n.lockedFace=null)}},{key:"selectAnchorLocation",value:function(n,i){var e=en(n.locations,function(t){return t.x===i.x&&t.y===i.y});return e!==-1?(n.currentLocation=e,!0):!1}},{key:"lockCurrentAxis",value:function(n){n.currentFace!=null&&(n.lockedAxis=n.currentFace===et||n.currentFace===Ke?Ph:Ah)}},{key:"unlockCurrentAxis",value:function(n){n.lockedAxis=null}},{key:"anchorsEqual",value:function(n,i){if(!n||!i)return!1;var e=n.locations[n.currentLocation],t=i.locations[i.currentLocation];return e.x===t.x&&e.y===t.y&&e.offx===t.offx&&e.offy===t.offy&&e.ox===t.ox&&e.oy===t.oy}}]),o}(),Cs={},Xi={get:function(a,n,i){var e=Cs[n];if(e)return new e(a,i);throw{message:"jsPlumb: unknown connector type '"+n+"'"}},register:function(a,n){Cs[a]=n}},_n=function(o){me(n,o);var a=_e(n);function n(i){var e;return $(this,n),e=a.call(this,i),c(v(e),"length",void 0),c(v(e),"m",void 0),c(v(e),"m2",void 0),c(v(e),"type",n.segmentType),e._setCoordinates({x1:i.x1,y1:i.y1,x2:i.x2,y2:i.y2}),e}return Z(n,[{key:"getPath",value:function(e){return(e?"M "+this.x1+" "+this.y1+" ":"")+"L "+this.x2+" "+this.y2}},{key:"_recalc",value:function(){this.length=Math.sqrt(Math.pow(this.x2-this.x1,2)+Math.pow(this.y2-this.y1,2)),this.m=ni({x:this.x1,y:this.y1},{x:this.x2,y:this.y2}),this.m2=-1/this.m,this.extents={xmin:Math.min(this.x1,this.x2),ymin:Math.min(this.y1,this.y2),xmax:Math.max(this.x1,this.x2),ymax:Math.max(this.y1,this.y2)}}},{key:"getLength",value:function(){return this.length}},{key:"getGradient",value:function(){return this.m}},{key:"_setCoordinates",value:function(e){this.x1=e.x1,this.y1=e.y1,this.x2=e.x2,this.y2=e.y2,this._recalc()}},{key:"pointOnPath",value:function(e,t){if(e===0&&!t)return{x:this.x1,y:this.y1};if(e===1&&!t)return{x:this.x2,y:this.y2};var r=t?e>0?e:this.length+e:e*this.length;return gn({x:this.x1,y:this.y1},{x:this.x2,y:this.y2},r)}},{key:"gradientAtPoint",value:function(e,t){return this.m}},{key:"pointAlongPathFrom",value:function(e,t,r){var s=this.pointOnPath(e,r),l=t<=0?{x:this.x1,y:this.y1}:{x:this.x2,y:this.y2};return t<=0&&Math.abs(t)>1&&(t*=-1),gn(s,l,t)}},{key:"within",value:function(e,t,r){return r>=Math.min(e,t)&&r<=Math.max(e,t)}},{key:"closest",value:function(e,t,r){return Math.abs(r-e)<Math.abs(r-t)?e:t}},{key:"findClosestPointOnPath",value:function(e,t){var r={d:1/0,x:null,y:null,l:null,x1:this.x1,x2:this.x2,y1:this.y1,y2:this.y2};if(this.m===0)r.y=this.y1,r.x=this.within(this.x1,this.x2,e)?e:this.closest(this.x1,this.x2,e);else if(this.m===1/0||this.m===-1/0)r.x=this.x1,r.y=this.within(this.y1,this.y2,t)?t:this.closest(this.y1,this.y2,t);else{var s=this.y1-this.m*this.x1,l=t-this.m2*e,u=(l-s)/(this.m-this.m2),d=this.m*u+s;r.x=this.within(this.x1,this.x2,u)?u:this.closest(this.x1,this.x2,u),r.y=this.within(this.y1,this.y2,d)?d:this.closest(this.y1,this.y2,d)}var h=So({x:r.x,y:r.y},{x:this.x1,y:this.y1});return r.d=So({x:e,y:t},r),r.l=h/length,r}},{key:"_pointLiesBetween",value:function(e,t,r){return r>t?t<=e&&e<=r:t>=e&&e>=r}},{key:"lineIntersection",value:function(e,t,r,s){var l=Math.abs(ni({x:e,y:t},{x:r,y:s})),u=Math.abs(this.m),d=u===1/0?this.x1:this.y1-u*this.x1,h=[],f=l===1/0?e:t-l*e;if(l!==u)if(l===1/0&&u===0)this._pointLiesBetween(e,this.x1,this.x2)&&this._pointLiesBetween(this.y1,t,s)&&h.push({x:e,y:this.y1});else if(l===0&&u===1/0)this._pointLiesBetween(t,this.y1,this.y2)&&this._pointLiesBetween(this.x1,e,r)&&h.push({x:this.x1,y:t});else{var g,y;l===1/0?(g=e,this._pointLiesBetween(g,this.x1,this.x2)&&(y=u*e+d,this._pointLiesBetween(y,t,s)&&h.push({x:g,y}))):l===0?(y=t,this._pointLiesBetween(y,this.y1,this.y2)&&(g=(t-d)/u,this._pointLiesBetween(g,e,r)&&h.push({x:g,y}))):(g=(f-d)/(u-l),y=u*g+d,this._pointLiesBetween(g,this.x1,this.x2)&&this._pointLiesBetween(y,this.y1,this.y2)&&h.push({x:g,y}))}return h}},{key:"boxIntersection",value:function(e,t,r,s){var l=[];return l.push.apply(l,this.lineIntersection(e,t,e+r,t)),l.push.apply(l,this.lineIntersection(e+r,t,e+r,t+s)),l.push.apply(l,this.lineIntersection(e+r,t+s,e,t+s)),l.push.apply(l,this.lineIntersection(e,t+s,e,t)),l}}]),n}(Zo);c(_n,"segmentType","Straight");var Lr=function(o){me(n,o);var a=_e(n);function n(){var i;$(this,n);for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];return i=a.call.apply(a,[this].concat(t)),c(v(i),"type",n.type),i}return Z(n,[{key:"getDefaultStubs",value:function(){return[0,0]}},{key:"_compute",value:function(e,t){this._addSegment(_n,{x1:e.sx,y1:e.sy,x2:e.startStubX,y2:e.startStubY}),this._addSegment(_n,{x1:e.startStubX,y1:e.startStubY,x2:e.endStubX,y2:e.endStubY}),this._addSegment(_n,{x1:e.endStubX,y1:e.endStubY,x2:e.tx,y2:e.ty}),this.geometry={source:t.sourcePos,target:t.targetPos}}},{key:"transformGeometry",value:function(e,t,r){return{source:this.transformAnchorPlacement(e.source,t,r),target:this.transformAnchorPlacement(e.target,t,r)}}}]),n}(qr);c(Lr,"type","Straight");function If(o,a){for(var n=o.scope.split(/\s/),i=a.scope.split(/\s/),e=0;e<n.length;e++)for(var t=0;t<i.length;t++)if(i[t]===n[e])return!0;return!1}function fn(o,a,n){var i=[],e=function(s){return Le(s)?s:o.getId(s)};if(a)if(typeof a=="string"){if(a==="*")return a;i.push(a)}else if(n)i=a;else if(a.length!=null){var t;(t=i).push.apply(t,Jn(Jn(a).map(e)))}else i.push(e(a));return i}function Lf(o,a){o!=null&&o.endpoints.push(a)}function Nf(o,a){o!=null&&ze(o.endpoints,function(n){return n===a})}function sr(o,a,n){a!=null&&(a.connections.push(o),a.connections.length===1&&o.instance.addClass(o.source,o.instance.connectedClass)),n!=null&&(a==null||o.sourceId!==o.targetId)&&(n.connections.push(o),n.connections.length===1&&o.instance.addClass(o.target,o.instance.connectedClass))}function lr(o,a,n){if(a!=null){var i=a.connections.length;ze(a.connections,function(t){return o.id===t.id}),i>0&&a.connections.length===0&&o.instance.removeClass(o.source,o.instance.connectedClass)}if(n!=null){var e=n.connections.length;(a==null||o.sourceId!==o.targetId)&&ze(n.connections,function(t){return o.id===t.id}),e>0&&n.connections.length===0&&o.instance.removeClass(o.target,o.instance.connectedClass)}}var Rf=function(o){me(n,o);var a=_e(n);function n(i,e){var t;return $(this,n),t=a.call(this),t._instanceIndex=i,c(v(t),"defaults",void 0),c(v(t),"_initialDefaults",{}),c(v(t),"isConnectionBeingDragged",!1),c(v(t),"currentlyDragging",!1),c(v(t),"hoverSuspended",!1),c(v(t),"_suspendDrawing",!1),c(v(t),"_suspendedAt",null),c(v(t),"connectorClass",$o),c(v(t),"connectorOutlineClass",Cc),c(v(t),"connectedClass",kc),c(v(t),"endpointClass",Wn),c(v(t),"endpointConnectedClass",xc),c(v(t),"endpointFullClass",Sc),c(v(t),"endpointFloatingClass",Xo),c(v(t),"endpointDropAllowedClass",Tc),c(v(t),"endpointDropForbiddenClass",Pc),c(v(t),"endpointAnchorClassPrefix",Ac),c(v(t),"overlayClass",Br),c(v(t),"connections",[]),c(v(t),"endpointsByElement",{}),c(v(t),"endpointsByUUID",new Map),c(v(t),"sourceSelectors",[]),c(v(t),"targetSelectors",[]),c(v(t),"allowNestedGroups",void 0),c(v(t),"_curIdStamp",1),c(v(t),"viewport",new Af(v(t))),c(v(t),"router",void 0),c(v(t),"groupManager",void 0),c(v(t),"_connectionTypes",new Map),c(v(t),"_endpointTypes",new Map),c(v(t),"_container",void 0),c(v(t),"_managedElements",{}),c(v(t),"DEFAULT_SCOPE",void 0),c(v(t),"_zoom",1),t.defaults={anchor:Dt.Bottom,anchors:[null,null],connectionsDetachable:!0,connectionOverlays:[],connector:Lr.type,container:null,endpoint:oi.type,endpointOverlays:[],endpoints:[null,null],endpointStyle:{fill:"#456"},endpointStyles:[null,null],endpointHoverStyle:null,endpointHoverStyles:[null,null],hoverPaintStyle:null,listStyle:{},maxConnections:1,paintStyle:{strokeWidth:2,stroke:"#456"},reattachConnections:!1,scope:"jsplumb_defaultscope",allowNestedGroups:!0},e&&K(t.defaults,e),K(t._initialDefaults,t.defaults),t._initialDefaults[Fn]!=null&&(t._initialDefaults[Fn].strokeWidth=t._initialDefaults[Fn].strokeWidth||2),t.DEFAULT_SCOPE=t.defaults[Ef],t.allowNestedGroups=t._initialDefaults[_f]!==!1,t.router=new Mf(v(t)),t.groupManager=new kf(v(t)),t.setContainer(t._initialDefaults.container),t}return Z(n,[{key:"defaultScope",get:function(){return this.DEFAULT_SCOPE}},{key:"currentZoom",get:function(){return this._zoom}},{key:"areDefaultAnchorsSet",value:function(){return this.validAnchorsSpec(this.defaults.anchors)}},{key:"validAnchorsSpec",value:function(e){return e!=null&&e[0]!=null&&e[1]!=null}},{key:"getContainer",value:function(){return this._container}},{key:"setZoom",value:function(e,t){return this._zoom=e,this.fire(El,this._zoom),t&&this.repaintEverything(),!0}},{key:"_idstamp",value:function(){return""+this._curIdStamp++}},{key:"checkCondition",value:function(e,t){var r=this.getListener(e),s=!0;if(r&&r.length>0){var l=Array.prototype.slice.call(arguments,1);try{for(var u=0,d=r.length;u<d;u++)s=s&&r[u].apply(r[u],l)}catch(h){Be("cannot check condition ["+e+"]"+h)}}return s}},{key:"getId",value:function(e,t){if(e==null)return null;var r=this.getAttribute(e,Kt);return(!r||r==="undefined")&&(arguments.length===2&&arguments[1]!==void 0?r=t:(arguments.length===1||arguments.length===3&&!arguments[2])&&(r="jsplumb-"+this._instanceIndex+"-"+this._idstamp()),this.setAttribute(e,Kt,r)),r}},{key:"getConnections",value:function(e,t){e?e.constructor===String&&(e={scope:e}):e={};for(var r=e.scope||this.defaultScope,s=fn(this,r,!0),l=fn(this,e.source),u=fn(this,e.target),d=!t&&s.length>1?{}:[],h=function(b,m){if(!t&&s.length>1){var S=d[b];S==null&&(S=d[b]=[]),S.push(m)}else d.push(m)},f=0,g=this.connections.length;f<g;f++){var y=this.connections[f],_=y.proxies&&y.proxies[0]?y.proxies[0].originalEp.elementId:y.sourceId,p=y.proxies&&y.proxies[1]?y.proxies[1].originalEp.elementId:y.targetId;cn(s,y.scope)&&cn(l,_)&&cn(u,p)&&h(y.scope,y)}return d}},{key:"select",value:function(e){return e=e||{},e.scope=e.scope||"*",new Sf(this,e.connections||this.getConnections(e,!0))}},{key:"selectEndpoints",value:function(e){e=e||{},e.scope=e.scope||mn;var t=!e.element&&!e.source&&!e.target,r=t?mn:fn(this,e.element),s=t?mn:fn(this,e.source),l=t?mn:fn(this,e.target),u=fn(this,e.scope,!0),d=[];for(var h in this.endpointsByElement){var f=cn(r,h,!0),g=cn(s,h,!0),y=s!=="*",_=cn(l,h,!0),p=l!=="*";if(f||g||_){e:for(var C=0,b=this.endpointsByElement[h].length;C<b;C++){var m=this.endpointsByElement[h][C];if(cn(u,m.scope,!0)){var S=y&&s.length>0&&!m.isSource,w=p&&l.length>0&&!m.isTarget;if(S||w)continue e;d.push(m)}}}}return new xf(this,d)}},{key:"setContainer",value:function(e){this._container=e,this.fire(Dc,this._container)}},{key:"_set",value:function(e,t,r){var s=[{el:"source",elId:"sourceId"},{el:"target",elId:"targetId"}],l,u=s[r],d=e[u.elId],h,f=e.endpoints[r],g={index:r,originalEndpoint:f,originalSourceId:r===0?d:e.sourceId,newSourceId:e.sourceId,originalTargetId:r===1?d:e.targetId,newTargetId:e.targetId,connection:e,newEndpoint:f};return t instanceof zn?(l=t,l.addConnection(e)):(h=this.getId(t),h===e[u.elId]?l=null:l=e.makeEndpoint(r===0,t,h)),l!=null&&(g.newEndpoint=l,f.detachFromConnection(e),e.endpoints[r]=l,e[u.el]=l.element,e[u.elId]=l.elementId,g[r===0?"newSourceId":"newTargetId"]=l.elementId,this.fireMoveEvent(g),this._paintConnection(e)),g}},{key:"setSource",value:function(e,t){lr(e,this._managedElements[e.sourceId]);var r=this._set(e,t,0);sr(e,this._managedElements[r.newSourceId])}},{key:"setTarget",value:function(e,t){lr(e,this._managedElements[e.targetId]);var r=this._set(e,t,1);sr(e,this._managedElements[r.newTargetId])}},{key:"setConnectionType",value:function(e,t,r){e.setType(t,r),this._paintConnection(e)}},{key:"isHoverSuspended",value:function(){return this.hoverSuspended}},{key:"setSuspendDrawing",value:function(e,t){var r=this._suspendDrawing;return this._suspendDrawing=e,e?this._suspendedAt=""+new Date().getTime():(this._suspendedAt=null,this.viewport.recomputeBounds()),t&&this.repaintEverything(),r}},{key:"getSuspendedAt",value:function(){return this._suspendedAt}},{key:"batch",value:function(e,t){var r=this._suspendDrawing===!0;r||this.setSuspendDrawing(!0),e(),r||this.setSuspendDrawing(!1,!t)}},{key:"each",value:function(e,t){if(e!=null){if(e.length!=null)for(var r=0;r<e.length;r++)t(e[r]);else t(e);return this}}},{key:"updateOffset",value:function(e){var t=e.elId;return e.recalc?this.viewport.refreshElement(t):this.viewport.getPosition(t)}},{key:"deleteConnection",value:function(e,t){if(e!=null&&e.deleted!==!0&&(t=t||{},t.force||tl(!0,!1,[[e.endpoints[0],Kn,[e]],[e.endpoints[1],Kn,[e]],[e,Kn,[e]],[this,hl,[Cl,e]]]))){lr(e,this._managedElements[e.sourceId],this._managedElements[e.targetId]),this.fireDetachEvent(e,!e.pending&&t.fireEvent!==!1,t.originalEvent);var r=e.endpoints[0],s=e.endpoints[1];return r!==t.endpointToIgnore&&r.detachFromConnection(e,null,!0),s!==t.endpointToIgnore&&s.detachFromConnection(e,null,!0),ze(this.connections,function(l){return e.id===l.id}),e.destroy(),r!==t.endpointToIgnore&&r.deleteOnEmpty&&r.connections.length===0&&this.deleteEndpoint(r),s!==t.endpointToIgnore&&s.deleteOnEmpty&&s.connections.length===0&&this.deleteEndpoint(s),!0}return!1}},{key:"deleteEveryConnection",value:function(e){var t=this;e=e||{};var r=this.connections.length,s=0;return this.batch(function(){for(var l=0;l<r;l++)s+=t.deleteConnection(t.connections[0],e)?1:0}),s}},{key:"deleteConnectionsForElement",value:function(e,t){var r=this.getId(e),s=this._managedElements[r];if(s)for(var l=s.connections.length,u=0;u<l;u++)this.deleteConnection(s.connections[0],t);return this}},{key:"fireDetachEvent",value:function(e,t,r){var s=e.id!=null,l=s?{connection:e,source:e.source,target:e.target,sourceId:e.sourceId,targetId:e.targetId,sourceEndpoint:e.endpoints[0],targetEndpoint:e.endpoints[1]}:e;t&&this.fire(vl,l,r),this.fire(Ko,l,r)}},{key:"fireMoveEvent",value:function(e,t){this.fire(pl,e,t)}},{key:"manageAll",value:function(e,t){for(var r=Le(e)?this.getSelector(this.getContainer(),e):e,s=0;s<r.length;s++)this.manage(r[s],null,t)}},{key:"manage",value:function(e,t,r){this.getAttribute(e,Kt)==null&&(t=t||this.getAttribute(e,"id")||He(),this.setAttribute(e,Kt,t));var s=this.getId(e);if(this._managedElements[s])r&&(this._managedElements[s].viewportElement=this.updateOffset({elId:s,timestamp:null,recalc:!0}));else{var l={el:e,endpoints:[],connections:[],rotation:0,data:{}};this._managedElements[s]=l,this._suspendDrawing?l.viewportElement=this.viewport.registerElement(s,!0):l.viewportElement=this.updateOffset({elId:s,recalc:!0}),this.fire(yl,{el:e})}return this._managedElements[s]}},{key:"getManagedData",value:function(e,t,r){if(this._managedElements[e]){var s=this._managedElements[e].data[t];return s!=null?s[r]:null}}},{key:"setManagedData",value:function(e,t,r,s){this._managedElements[e]&&(this._managedElements[e].data[t]=this._managedElements[e].data[t]||{},this._managedElements[e].data[t][r]=s)}},{key:"getManagedElement",value:function(e){return this._managedElements[e]?this._managedElements[e].el:null}},{key:"unmanage",value:function(e,t){var r=this;this.removeAllEndpoints(e,!0);var s=function(u){var d=r.getId(u);r.removeAttribute(u,Kt),delete r._managedElements[d],r.viewport.remove(d),r.fire(_l,{el:u,id:d}),u&&t&&r._removeElement(u)};this._getAssociatedElements(e).map(s),s(e)}},{key:"rotate",value:function(e,t,r){var s=this.getId(e);return this._managedElements[s]&&(this._managedElements[s].rotation=t,this.viewport.rotateElement(s,t),r!==!0)?this.revalidate(e):{c:new Set,e:new Set}}},{key:"_getRotation",value:function(e){var t=this._managedElements[e];return t!=null&&t.rotation||0}},{key:"_getRotations",value:function(e){var t=this,r=[],s=this._managedElements[e],l=function u(d){if(d.group!=null){var h=t._managedElements[d.group];h!=null&&(r.push({r:h.viewportElement.r,c:h.viewportElement.c}),u(h))}};return s!=null&&(r.push({r:s.viewportElement.r||0,c:s.viewportElement.c}),l(s)),r}},{key:"_applyRotations",value:function(e,t){var r=e.slice(),s={x:r[0],y:r[1],cr:0,sr:0};return Q(t,function(l){s=Cr(s,l.c,l.r)}),s}},{key:"_applyRotationsXY",value:function(e,t){return Q(t,function(r){e=Cr(e,r.c,r.r)}),e}},{key:"_internal_newEndpoint",value:function(e){var t=K({},e),r=this.manage(t.element);t.elementId=this.getId(t.element),t.id="ep_"+this._idstamp();var s=new zn(this,t);return Lf(r,s),e.uuid&&this.endpointsByUUID.set(e.uuid,s),il(this.endpointsByElement,s.elementId,s),this._suspendDrawing||this._paintEndpoint(s,{timestamp:this._suspendedAt}),s}},{key:"_deriveEndpointAndAnchorSpec",value:function(e,t){for(var r=((t?"":"default ")+e).split(/[\s]/),s=null,l=null,u=null,d=null,h=0;h<r.length;h++){var f=this.getConnectionType(r[h]);f&&(f.endpoints&&(s=f.endpoints),f.endpoint&&(l=f.endpoint),f.anchors&&(d=f.anchors),f.anchor&&(u=f.anchor))}return{endpoints:s||[l,l],anchors:d||[u,u]}}},{key:"revalidate",value:function(e,t){var r=this.getId(e);return this.updateOffset({elId:r,recalc:!0,timestamp:t}),this.repaint(e)}},{key:"repaintEverything",value:function(){var e=He(),t;for(t in this._managedElements)this.viewport.refreshElement(t,!0);this.viewport.recomputeBounds();for(t in this._managedElements)this.repaint(this._managedElements[t].el,e,!0);return this}},{key:"setElementPosition",value:function(e,t,r){var s=this.getId(e);return this.viewport.setPosition(s,t,r),this.repaint(e)}},{key:"repaint",value:function(e,t,r){var s={c:new Set,e:new Set},l=function(y){y.c.forEach(function(_){return s.c.add(_)}),y.e.forEach(function(_){return s.e.add(_)})};if(!this._suspendDrawing){var u=this.getId(e);if(e!=null){var d=this._getAssociatedElements(e);if(t==null&&(t=He()),!r)for(var h=0;h<d.length;h++)this.updateOffset({elId:this.getId(d[h]),recalc:!0,timestamp:t});if(l(this.router.redraw(u,t,null)),d.length>0)for(var f=0;f<d.length;f++)l(this.router.redraw(this.getId(d[f]),t,null))}}return s}},{key:"unregisterEndpoint",value:function(e){var t=e.getUuid();t&&this.endpointsByUUID.delete(t),Nf(this._managedElements[e.elementId],e);var r=this.endpointsByElement[e.elementId];r!=null&&(this.endpointsByElement[e.elementId]=r.filter(function(s){return s!==e})),this.fire(gl,e)}},{key:"_maybePruneEndpoint",value:function(e){return e.deleteOnEmpty&&e.connections.length===0?(this.deleteEndpoint(e),!0):!1}},{key:"deleteEndpoint",value:function(e){var t=this,r=typeof e=="string"?this.endpointsByUUID.get(e):e;if(r){var s=r.proxiedBy,l=r.connections.slice();Q(l,function(u){r.detachFromConnection(u,null,!0)}),this.unregisterEndpoint(r),r.destroy(),Q(l,function(u){t.deleteConnection(u,{force:!0,endpointToIgnore:r})}),s!=null&&this.deleteEndpoint(s)}return this}},{key:"addEndpoint",value:function(e,t,r){r=r||{};var s=K({},r);K(s,t||{});var l=K({element:e},s);return this._internal_newEndpoint(l)}},{key:"addEndpoints",value:function(e,t,r){for(var s=[],l=0,u=t.length;l<u;l++)s.push(this.addEndpoint(e,t[l],r));return s}},{key:"reset",value:function(){var e=this;this.silently(function(){e.endpointsByElement={},e._managedElements={},e.endpointsByUUID.clear(),e.viewport.reset(),e.router.reset(),e.groupManager.reset(),e.connections.length=0})}},{key:"destroy",value:function(){this.reset(),this.unbind(),this.sourceSelectors.length=0,this.targetSelectors.length=0,this._connectionTypes.clear(),this._endpointTypes.clear()}},{key:"getEndpoints",value:function(e){return this.endpointsByElement[this.getId(e)]||[]}},{key:"getEndpoint",value:function(e){return this.endpointsByUUID.get(e)}},{key:"setEndpointUuid",value:function(e,t){e.uuid&&this.endpointsByUUID.delete(e.uuid),e.uuid=t,this.endpointsByUUID.set(t,e)}},{key:"connect",value:function(e,t){try{var r=this._prepareConnectionParams(e,t),s=this._newConnection(r);return this._finaliseConnection(s,r),s}catch(l){Be(l);return}}},{key:"_prepareConnectionParams",value:function(e,t){var r=K({},e);t&&K(r,t);var s=r;if(s.source&&s.source.endpoint&&(s.sourceEndpoint=s.source),s.target&&s.target.endpoint&&(s.targetEndpoint=s.target),e.uuids&&(s.sourceEndpoint=this.getEndpoint(e.uuids[0]),s.targetEndpoint=this.getEndpoint(e.uuids[1])),s.sourceEndpoint!=null){if(s.sourceEndpoint.isFull())throw Bc;if(s.type||(s.type=s.sourceEndpoint.edgeType),s.sourceEndpoint.connectorOverlays){s.overlays=s.overlays||[];for(var l=0,u=s.sourceEndpoint.connectorOverlays.length;l<u;l++)s.overlays.push(s.sourceEndpoint.connectorOverlays[l])}s.sourceEndpoint.scope&&(s.scope=s.sourceEndpoint.scope)}else if(s.source==null)throw qc;if(s.targetEndpoint!=null){if(s.targetEndpoint.isFull())throw Hc}else if(s.target==null)throw Yc;if(s.sourceEndpoint&&s.targetEndpoint&&!If(s.sourceEndpoint,s.targetEndpoint))throw"Cannot establish connection: scopes do not match";return s}},{key:"_newConnection",value:function(e){e.id="con_"+this._idstamp();var t=new Hi(this,e);return sr(t,this._managedElements[t.sourceId],this._managedElements[t.targetId]),this._paintConnection(t),t}},{key:"_finaliseConnection",value:function(e,t,r){t=t||{},e.suspendedEndpoint||this.connections.push(e),e.pending=null,e.endpoints[0].isTemporarySource=!1,this.repaint(e.source);var s={connection:e,source:e.source,target:e.target,sourceId:e.sourceId,targetId:e.targetId,sourceEndpoint:e.endpoints[0],targetEndpoint:e.endpoints[1]};this.fire(fl,s,r),!t.doNotFireConnectionEvent&&t.fireEvent!==!1&&this.fire(Wo,s,r)}},{key:"removeAllEndpoints",value:function(e,t){var r=this,s=function(u){var d=r.getId(u),h=r.endpointsByElement[d],f,g;if(h)for(f=0,g=h.length;f<g;f++)r.deleteEndpoint(h[f]);delete r.endpointsByElement[d]};return t&&this._getAssociatedElements(e).map(s),s(e),this}},{key:"_createSourceDefinition",value:function(e,t){var r=K({},t);K(r,e),r.edgeType=r.edgeType||Tr;var s=this._deriveEndpointAndAnchorSpec(r.edgeType);r.endpoint=r.endpoint||s.endpoints[0],r.anchor=r.anchor||s.anchors[0];var l=r.maxConnections||-1,u={def:K({},r),uniqueEndpoint:r.uniqueEndpoint,maxConnections:l,enabled:!0,endpoint:null};return u}},{key:"addSourceSelector",value:function(e,t){var r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1,s=this._createSourceDefinition(t),l=new os(e,s,r);return this.sourceSelectors.push(l),l}},{key:"removeSourceSelector",value:function(e){ze(this.sourceSelectors,function(t){return t===e})}},{key:"removeTargetSelector",value:function(e){ze(this.targetSelectors,function(t){return t===e})}},{key:"addTargetSelector",value:function(e,t){var r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1,s=this._createTargetDefinition(t),l=new os(e,s,r);return this.targetSelectors.push(l),l}},{key:"_createTargetDefinition",value:function(e,t){var r=K({},t);K(r,e),r.edgeType=r.edgeType||Tr;var s=r.maxConnections||-1,l={def:K({},r),uniqueEndpoint:r.uniqueEndpoint,maxConnections:s,enabled:!0,endpoint:null};return l}},{key:"show",value:function(e,t){return this._setVisible(e,bo,t)}},{key:"hide",value:function(e,t){return this._setVisible(e,ei,t)}},{key:"_setVisible",value:function(e,t,r){var s=t===bo,l=null;r&&(l=function(h){h.setVisible(s,!0,!0)});var u=this.getId(e);return this._operation(e,function(d){if(s&&r){var h=d.sourceId===u?1:0;d.endpoints[h].isVisible()&&d.setVisible(!0)}else d.setVisible(s)},l),this}},{key:"toggleVisible",value:function(e,t){var r=null;t&&(r=function(l){var u=l.isVisible();l.setVisible(!u)}),this._operation(e,function(s){var l=s.isVisible();s.setVisible(!l)},r)}},{key:"_operation",value:function(e,t,r){var s=this.getId(e),l=this.endpointsByElement[s];if(l&&l.length)for(var u=0,d=l.length;u<d;u++){for(var h=0,f=l[u].connections.length;h<f;h++){var g=t(l[u].connections[h]);if(g)return}r&&r(l[u])}}},{key:"registerConnectionType",value:function(e,t){if(this._connectionTypes.set(e,K({},t)),t.overlays){for(var r={},s=0;s<t.overlays.length;s++){var l=Po(t.overlays[s]);r[l.options.id]=l}this._connectionTypes.get(e).overlays=r}}},{key:"registerConnectionTypes",value:function(e){for(var t in e)this.registerConnectionType(t,e[t])}},{key:"registerEndpointType",value:function(e,t){if(this._endpointTypes.set(e,K({},t)),t.overlays){for(var r={},s=0;s<t.overlays.length;s++){var l=Po(t.overlays[s]);r[l.options.id]=l}this._endpointTypes.get(e).overlays=r}}},{key:"registerEndpointTypes",value:function(e){for(var t in e)this.registerEndpointType(t,e[t])}},{key:"getType",value:function(e,t){return t==="connection"?this.getConnectionType(e):this.getEndpointType(e)}},{key:"getConnectionType",value:function(e){return this._connectionTypes.get(e)}},{key:"getEndpointType",value:function(e){return this._endpointTypes.get(e)}},{key:"importDefaults",value:function(e){for(var t in e)this.defaults[t]=e[t];return this.defaults[Fn]!=null&&(this.defaults[Fn].strokeWidth=this.defaults[Fn].strokeWidth||2),e.container&&this.setContainer(e.container),this}},{key:"restoreDefaults",value:function(){return this.defaults=K({},this._initialDefaults),this}},{key:"getManagedElements",value:function(){return this._managedElements}},{key:"proxyConnection",value:function(e,t,r,s,l){var u=e.proxies[t]!=null,d,h=u?e.proxies[t].originalEp.elementId:e.endpoints[t].elementId,f=u?e.proxies[t].originalEp:e.endpoints[t],g=this.getId(r);e.proxies[t]?e.proxies[t].ep.elementId===g?d=e.proxies[t].ep:(e.proxies[t].ep.detachFromConnection(e,t),d=this._internal_newEndpoint({element:r,endpoint:s(e,t),anchor:l(e,t),parameters:{isProxyEndpoint:!0}})):d=this._internal_newEndpoint({element:r,endpoint:s(e,t),anchor:l(e,t),parameters:{isProxyEndpoint:!0}}),d.deleteOnEmpty=!0,e.proxies[t]={ep:d,originalEp:f},this.sourceOrTargetChanged(h,g,e,r,t),f.detachFromConnection(e,null,!0),d.connections=[e],e.endpoints[t]=d,f.proxiedBy=d,f.setVisible(!1),e.setVisible(!0),this.revalidate(r)}},{key:"unproxyConnection",value:function(e,t){if(!(e.proxies==null||e.proxies[t]==null)){var r=e.proxies[t].originalEp.element,s=e.proxies[t].originalEp.elementId,l=e.proxies[t].ep.elementId;e.endpoints[t]=e.proxies[t].originalEp,delete e.proxies[t].originalEp.proxiedBy,this.sourceOrTargetChanged(l,s,e,r,t),e.proxies[t].ep.detachFromConnection(e,null),e.proxies[t].originalEp.addConnection(e),e.isVisible()&&e.proxies[t].originalEp.setVisible(!0),e.proxies[t]=null,en(e.proxies,function(u){return u!=null})===-1&&(e.proxies.length=0)}}},{key:"sourceOrTargetChanged",value:function(e,t,r,s,l){e!==t&&(l===0?(r.sourceId=t,r.source=s):l===1&&(r.targetId=t,r.target=s),lr(r,this._managedElements[e]),sr(r,this._managedElements[t]))}},{key:"getGroup",value:function(e){return this.groupManager.getGroup(e)}},{key:"getGroupFor",value:function(e){return this.groupManager.getGroupFor(e)}},{key:"addGroup",value:function(e){return this.groupManager.addGroup(e)}},{key:"addToGroup",value:function(e){for(var t,r=arguments.length,s=new Array(r>1?r-1:0),l=1;l<r;l++)s[l-1]=arguments[l];return(t=this.groupManager).addToGroup.apply(t,[e,!1].concat(s))}},{key:"collapseGroup",value:function(e){this.groupManager.collapseGroup(e)}},{key:"expandGroup",value:function(e){this.groupManager.expandGroup(e)}},{key:"toggleGroup",value:function(e){this.groupManager.toggleGroup(e)}},{key:"removeGroup",value:function(e,t,r,s){return this.groupManager.removeGroup(e,t,r,s)}},{key:"removeAllGroups",value:function(e,t){this.groupManager.removeAllGroups(e,t,!1)}},{key:"removeFromGroup",value:function(e,t,r){this.groupManager.removeFromGroup(e,r,t),this._appendElement(t,this.getContainer()),this.updateOffset({recalc:!0,elId:this.getId(t)})}},{key:"_paintEndpoint",value:function(e,t){function r(m){var S=0;if(t.elementWithPrecedence!=null){for(var w=0;w<m.connections.length;w++)if(m.connections[w].sourceId===t.elementWithPrecedence||m.connections[w].targetId===t.elementWithPrecedence){S=w;break}}return m.connections[S]}t=t||{};var s=t.timestamp,l=t.recalc!==!1;if(!s||e.timestamp!==s){var u=this.viewport.getPosition(e.elementId),d=t.offset?{x:t.offset.x,y:t.offset.y}:{x:u.x,y:u.y};if(d!=null){var h=t.anchorLoc;if(h==null){var f={xy:d,wh:u,element:e,timestamp:s};if(l&&this.router.isDynamicAnchor(e)&&e.connections.length>0){var g=r(e),y=g.endpoints[0]===e?1:0,_=y===0?g.sourceId:g.targetId,p=this.viewport.getPosition(_);f.index=y===0?1:0,f.connection=g,f.txy=p,f.twh=p,f.tElement=g.endpoints[y],f.tRotation=this._getRotations(_)}else e.connections.length>0&&(f.connection=e.connections[0]);f.rotation=this._getRotations(e.elementId),h=this.router.computeAnchorLocation(e._anchor,f)}e.endpoint.compute(h,this.router.getEndpointOrientation(e),e.paintStyleInUse),this.renderEndpoint(e,e.paintStyleInUse),e.timestamp=s;for(var C in e.overlays)if(e.overlays.hasOwnProperty(C)){var b=e.overlays[C];b.isVisible()&&(e.overlayPlacements[C]=this.drawOverlay(b,e.endpoint,e.paintStyleInUse,e.getAbsoluteOverlayPosition(b)),this._paintOverlay(b,e.overlayPlacements[C],{xmin:0,ymin:0}))}}}}},{key:"_paintConnection",value:function(e,t){if(!this._suspendDrawing&&e.visible!==!1){t=t||{};var r=t.timestamp;if(r!=null&&r===e.lastPaintedAt)return;if(r==null||r!==e.lastPaintedAt){this.router.computePath(e,r);var s={xmin:1/0,ymin:1/0,xmax:-1/0,ymax:-1/0};for(var l in e.overlays)if(e.overlays.hasOwnProperty(l)){var u=e.overlays[l];u.isVisible()&&(e.overlayPlacements[l]=this.drawOverlay(u,e.connector,e.paintStyleInUse,e.getAbsoluteOverlayPosition(u)),s.xmin=Math.min(s.xmin,e.overlayPlacements[l].xmin),s.xmax=Math.max(s.xmax,e.overlayPlacements[l].xmax),s.ymin=Math.min(s.ymin,e.overlayPlacements[l].ymin),s.ymax=Math.max(s.ymax,e.overlayPlacements[l].ymax))}var d=parseFloat(""+e.paintStyleInUse.strokeWidth||"1")/2,h=parseFloat(""+e.paintStyleInUse.strokeWidth||"0"),f={xmin:Math.min(e.connector.bounds.xmin-(d+h),s.xmin),ymin:Math.min(e.connector.bounds.ymin-(d+h),s.ymin),xmax:Math.max(e.connector.bounds.xmax+(d+h),s.xmax),ymax:Math.max(e.connector.bounds.ymax+(d+h),s.ymax)};this.paintConnector(e.connector,e.paintStyleInUse,f);for(var g in e.overlays)if(e.overlays.hasOwnProperty(g)){var y=e.overlays[g];y.isVisible()&&this._paintOverlay(y,e.overlayPlacements[g],f)}}e.lastPaintedAt=r}}},{key:"_refreshEndpoint",value:function(e){e._anchor.isFloating||(e.connections.length>0?this.addEndpointClass(e,this.endpointConnectedClass):this.removeEndpointClass(e,this.endpointConnectedClass),e.isFull()?this.addEndpointClass(e,this.endpointFullClass):this.removeEndpointClass(e,this.endpointFullClass))}},{key:"_makeConnector",value:function(e,t,r){return Xi.get(e,t,r)}},{key:"addOverlay",value:function(e,t,r){if(e.addOverlay(t),!r){var s=e instanceof zn?e.element:e.source;this.revalidate(s)}}},{key:"removeOverlay",value:function(e,t){e.removeOverlay(t);var r=e instanceof zn?e.element:e.source;this.revalidate(r)}},{key:"setOutlineColor",value:function(e,t){e.paintStyleInUse.outlineStroke=t,this._paintConnection(e)}},{key:"setOutlineWidth",value:function(e,t){e.paintStyleInUse.outlineWidth=t,this._paintConnection(e)}},{key:"setColor",value:function(e,t){e.paintStyleInUse.stroke=t,this._paintConnection(e)}},{key:"setLineWidth",value:function(e,t){e.paintStyleInUse.strokeWidth=t,this._paintConnection(e)}},{key:"setLineStyle",value:function(e,t){t.lineWidth!=null&&(e.paintStyleInUse.strokeWidth=t.lineWidth),t.outlineWidth!=null&&(e.paintStyleInUse.outlineWidth=t.outlineWidth),t.color!=null&&(e.paintStyleInUse.stroke=t.color),t.outlineColor!=null&&(e.paintStyleInUse.outlineStroke=t.outlineColor),this._paintConnection(e)}},{key:"getPathData",value:function(e){for(var t="",r=0;r<e.segments.length;r++)t+=e.segments[r].getPath(r===0),t+=" ";return t}}]),n}($i),Xl={};function ca(o,a){Xl[o]=a}function ks(o,a,n){var i=a,e=Xn(a.getBoundingClientRect)!==Pl?a.getBoundingClientRect():{left:0,top:0,width:0,height:0},t=document.body,r=document.documentElement,s=window.pageYOffset||r.scrollTop||t.scrollTop,l=window.pageXOffset||r.scrollLeft||t.scrollLeft,u=r.clientTop||t.clientTop||0,d=r.clientLeft||t.clientLeft||0,h=0,f=0,g=e.top+s-u+h*n,y=e.left+l-d+f*n,_=Pr(o),p=e.width||i.offsetWidth*n,C=e.height||i.offsetHeight*n,b=(_.x-y)/p,m=(_.y-g)/C;return{x:b,y:m}}function Vn(o){return Ao(o)||wo(o)||Do(o)}function xs(o,a){o.canvas&&(o.canvas.style.display=a?"block":"none")}function Ss(o){o.canvas&&o.canvas.parentNode.removeChild(o.canvas),delete o.canvas}function ki(o){return o.canvas}function kt(o){return la.getElement(o)}function vn(o){return la.getElement(o,o.component,function(a){var n=o.create(a);return o.instance.addClass(n,o.instance.overlayClass),n})}function Gf(o,a,n,i){var e=o.x,t=o.y;return a._jsPlumbParentGroup&&a._jsPlumbParentGroup.constrain&&(e=Math.max(o.x,0),t=Math.max(o.y,0),e=Math.min(e,n.w-i.w),t=Math.min(t,n.h-i.h)),{x:e,y:t}}var Ff=function(o){me(n,o);var a=_e(n);function n(i,e){var t;if($(this,n),t=a.call(this,i,e),t._instanceIndex=i,c(v(t),"containerType",null),c(v(t),"dragSelection",void 0),c(v(t),"dragManager",void 0),c(v(t),"_connectorClick",void 0),c(v(t),"_connectorDblClick",void 0),c(v(t),"_connectorTap",void 0),c(v(t),"_connectorDblTap",void 0),c(v(t),"_endpointClick",void 0),c(v(t),"_endpointDblClick",void 0),c(v(t),"_overlayClick",void 0),c(v(t),"_overlayDblClick",void 0),c(v(t),"_overlayTap",void 0),c(v(t),"_overlayDblTap",void 0),c(v(t),"_connectorMouseover",void 0),c(v(t),"_connectorMouseout",void 0),c(v(t),"_endpointMouseover",void 0),c(v(t),"_endpointMouseout",void 0),c(v(t),"_connectorContextmenu",void 0),c(v(t),"_connectorMousedown",void 0),c(v(t),"_connectorMouseup",void 0),c(v(t),"_endpointMousedown",void 0),c(v(t),"_endpointMouseup",void 0),c(v(t),"_overlayMouseover",void 0),c(v(t),"_overlayMouseout",void 0),c(v(t),"_elementClick",void 0),c(v(t),"_elementTap",void 0),c(v(t),"_elementDblTap",void 0),c(v(t),"_elementMouseenter",void 0),c(v(t),"_elementMouseexit",void 0),c(v(t),"_elementMousemove",void 0),c(v(t),"_elementMouseup",void 0),c(v(t),"_elementMousedown",void 0),c(v(t),"_elementContextmenu",void 0),c(v(t),"_resizeObserver",void 0),c(v(t),"eventManager",void 0),c(v(t),"draggingClass","jtk-dragging"),c(v(t),"elementDraggingClass","jtk-element-dragging"),c(v(t),"hoverClass","jtk-hover"),c(v(t),"sourceElementDraggingClass","jtk-source-element-dragging"),c(v(t),"targetElementDraggingClass","jtk-target-element-dragging"),c(v(t),"hoverSourceClass","jtk-source-hover"),c(v(t),"hoverTargetClass","jtk-target-hover"),c(v(t),"dragSelectClass","jtk-drag-select"),c(v(t),"managedElementsSelector",void 0),c(v(t),"elementsDraggable",void 0),c(v(t),"elementDragHandler",void 0),c(v(t),"groupDragOptions",void 0),c(v(t),"elementDragOptions",void 0),c(v(t),"svg",{node:function(s,l){return Ht(s,l)},attr:function(s,l){return Bt(s,l)},pos:function(s){return xl(s)}}),e=e||{},t.containerType=_o(t.getContainer()),t.elementsDraggable=e&&e.elementsDraggable!==!1,t.managedElementsSelector=e&&e.managedElementsSelector||Oe,t.eventManager=new ta,t.dragSelection=new yh(v(t)),t.dragManager=new kh(v(t),t.dragSelection),t.dragManager.addHandler(new ss(v(t))),t.groupDragOptions={constrainFunction:Gf},t.dragManager.addHandler(new ls(v(t),t.dragSelection),t.groupDragOptions),t.elementDragHandler=new To(v(t),t.dragSelection),t.elementDragOptions=e&&e.dragOptions||{},t.dragManager.addHandler(t.elementDragHandler,t.elementDragOptions),e&&e.dragOptions&&e.dragOptions.filter&&t.dragManager.addFilter(e.dragOptions.filter),t._createEventListeners(),t._attachEventDelegates(),e.resizeObserver!==!1)try{t._resizeObserver=new ResizeObserver(function(r){var s=r.filter(function(l){var u=t.getAttribute(l.target,Kt);if(u!=null){var d=t.viewport._elementMap.get(u);return d?d.w!==l.contentRect.width||d.h!==l.contentRect.height:!1}else return!1});s.forEach(function(l){return t.revalidate(l.target)})})}catch{Be("WARN: ResizeObserver could not be attached.")}return t}return Z(n,[{key:"fireOverlayMethod",value:function(e,t,r){var s=e.component instanceof Hi?Mt:qt,l=Te(s,t);r._jsPlumbOverlay=e,e.fire(t,{e:r,overlay:e}),this.fire(l,e.component,r)}},{key:"addDragFilter",value:function(e,t){this.dragManager.addFilter(e,t)}},{key:"removeDragFilter",value:function(e){this.dragManager.removeFilter(e)}},{key:"setDragGrid",value:function(e){this.dragManager.setOption(this.elementDragHandler,{grid:e})}},{key:"setDragConstrainFunction",value:function(e){this.dragManager.setOption(this.elementDragHandler,{constrainFunction:e})}},{key:"_removeElement",value:function(e){e.parentNode&&e.parentNode.removeChild(e)}},{key:"_appendElement",value:function(e,t){t&&t.appendChild(e)}},{key:"_appendElementToGroup",value:function(e,t){this.getGroupContentArea(e).appendChild(t)}},{key:"_appendElementToContainer",value:function(e){this._appendElement(e,this.getContainer())}},{key:"_getAssociatedElements",value:function(e){var t=[];if(e.nodeType!==3&&e.nodeType!==8){var r=e.querySelectorAll(Oe);Array.prototype.push.apply(t,r)}return t.filter(function(s){return s.nodeType!==3&&s.nodeType!==8})}},{key:"shouldFireEvent",value:function(e,t,r){return!0}},{key:"getClass",value:function(e){return dc(e)}},{key:"addClass",value:function(e,t){pn(e,t)}},{key:"hasClass",value:function(e,t){return hc(e,t)}},{key:"removeClass",value:function(e,t){mo(e,t)}},{key:"toggleClass",value:function(e,t){fc(e,t)}},{key:"setAttribute",value:function(e,t,r){e.setAttribute(t,r)}},{key:"getAttribute",value:function(e,t){return e.getAttribute(t)}},{key:"setAttributes",value:function(e,t){for(var r in t)e.setAttribute(r,t[r])}},{key:"removeAttribute",value:function(e,t){e.removeAttribute&&e.removeAttribute(t)}},{key:"on",value:function(e,t,r,s){var l=this,u=function(h){s==null?l.eventManager.on(h,t,r):l.eventManager.on(h,t,r,s)};return ji(e)?Q(e,function(d){return u(d)}):u(e),this}},{key:"off",value:function(e,t,r){var s=this;return ji(e)?Q(e,function(l){return s.eventManager.off(l,t,r)}):this.eventManager.off(e,t,r),this}},{key:"trigger",value:function(e,t,r,s,l){this.eventManager.trigger(e,t,r,s,l)}},{key:"getOffsetRelativeToRoot",value:function(e){return qn(e)}},{key:"getOffset",value:function(e){for(var t=e,r=this.getContainer(),s=this.getPosition(t),l=e!==r&&t.offsetParent!==r?t.offsetParent:null,u=function(g){g!=null&&g!==document.body&&(g.scrollTop>0||g.scrollLeft>0)&&(s.x-=g.scrollLeft,s.y-=g.scrollTop)};l!=null;)s.x+=l.offsetLeft,s.y+=l.offsetTop,u(l),l=l.offsetParent===r?null:l.offsetParent;if(r!=null&&(r.scrollTop>0||r.scrollLeft>0)){var d=t.offsetParent!=null?this.getStyle(t.offsetParent,Ya):_c,h=this.getStyle(t,Ya);h!==Vi&&h!==Ra&&d!==Vi&&d!==Ra&&(s.x-=r.scrollLeft,s.y-=r.scrollTop)}return s}},{key:"getSize",value:function(e){var t=e;if(t.offsetWidth!=null)return vc(e);if(t.width&&t.width.baseVal)return pc(t)}},{key:"getPosition",value:function(e){var t=e;if(t.offsetLeft!=null)return{x:parseFloat(t.offsetLeft),y:parseFloat(t.offsetTop)};if(t.x&&t.x.baseVal)return gc(t)}},{key:"getStyle",value:function(e,t){return Xn(window.getComputedStyle)!==Pl?getComputedStyle(e,null).getPropertyValue(t):e.currentStyle[t]}},{key:"getGroupContentArea",value:function(e){var t=this.getSelector(e.el,Ad);return t&&t.length>0?t[0]:e.el}},{key:"getSelector",value:function(e,t){var r=null;if(arguments.length===1){if(!Le(e)){var s=document.createDocumentFragment();return s.appendChild(e),Zi(s.childNodes)}r=Zi(document.querySelectorAll(e))}else r=Zi(e.querySelectorAll(t));return r}},{key:"setPosition",value:function(e,t){var r=e;r.style.left=t.x+"px",r.style.top=t.y+"px"}},{key:"setDraggable",value:function(e,t){t?this.removeAttribute(e,vr):this.setAttribute(e,vr,Al)}},{key:"isDraggable",value:function(e){var t=this.getAttribute(e,vr);return t==null||t===Yn}},{key:"toggleDraggable",value:function(e){var t=this.isDraggable(e);return this.setDraggable(e,!t),!t}},{key:"_createEventListeners",value:function(){var e=function(C,b){if(!b.defaultPrevented&&b._jsPlumbOverlay==null){var m=Gt(ht(b),Ct,this.getContainer(),!0);this.fire(C,m.jtk.connector.connection,b)}};this._connectorClick=e.bind(this,md),this._connectorDblClick=e.bind(this,_d),this._connectorTap=e.bind(this,Td),this._connectorDblTap=e.bind(this,Ed);var t=function(C,b){var m=ht(b).parentNode;if(m.jtk&&m.jtk.connector){var S=m.jtk.connector,w=S.connection;this.setConnectorHover(S,C),C?(this.addClass(w.source,this.hoverSourceClass),this.addClass(w.target,this.hoverTargetClass)):(this.removeClass(w.source,this.hoverSourceClass),this.removeClass(w.target,this.hoverTargetClass)),this.fire(C?Cd:bd,m.jtk.connector.connection,b)}};this._connectorMouseover=t.bind(this,!0),this._connectorMouseout=t.bind(this,!1);var r=function(C,b){var m=ht(b).parentNode;m.jtk&&m.jtk.connector&&this.fire(C?kd:xd,m.jtk.connector.connection,b)};this._connectorMouseup=r.bind(this,!0),this._connectorMousedown=r.bind(this,!1),this._connectorContextmenu=function(p){var C=ht(p).parentNode;C.jtk&&C.jtk.connector&&this.fire(Sd,C.jtk.connector.connection,p)}.bind(this);var s=function(C,b,m){!b.defaultPrevented&&b._jsPlumbOverlay==null&&this.fire(C,m.jtk.endpoint,b)};this._endpointClick=s.bind(this,hd),this._endpointDblClick=s.bind(this,fd);var l=function(C,b){var m=ht(b);m.jtk&&m.jtk.endpoint&&(this.setEndpointHover(m.jtk.endpoint,C),this.fire(C?pd:vd,m.jtk.endpoint,b))};this._endpointMouseover=l.bind(this,!0),this._endpointMouseout=l.bind(this,!1);var u=function(C,b){var m=ht(b);m.jtk&&m.jtk.endpoint&&this.fire(C?gd:yd,m.jtk.endpoint,b)};this._endpointMouseup=u.bind(this,!0),this._endpointMousedown=u.bind(this,!1);var d=function(p,C){var b=Gt(ht(C),Nt,this.getContainer(),!0),m=b.jtk.overlay;m&&this.fireOverlayMethod(m,p,C)}.bind(this);this._overlayClick=d.bind(this,ot),this._overlayDblClick=d.bind(this,ft),this._overlayTap=d.bind(this,yt),this._overlayDblTap=d.bind(this,vt);var h=function(C,b){var m=Gt(ht(b),Nt,this.getContainer(),!0),S=m.jtk.overlay;S&&this.setOverlayHover(S,C)};this._overlayMouseover=h.bind(this,!0),this._overlayMouseout=h.bind(this,!1);var f=function(C,b,m){b.defaultPrevented||this.fire(b.detail===1?Ba:od,m,b)};this._elementClick=f.bind(this,Ba);var g=function(C,b,m){b.defaultPrevented||this.fire(qa,m,b)};this._elementTap=g.bind(this,qa);var y=function(C,b,m){b.defaultPrevented||this.fire(Ha,m,b)};this._elementDblTap=y.bind(this,Ha);var _=function(C,b){this.fire(C?sd:ad,ht(b),b)};this._elementMouseenter=_.bind(this,!0),this._elementMouseexit=_.bind(this,!1),this._elementMousemove=function(p){this.fire(ld,ht(p),p)}.bind(this),this._elementMouseup=function(p){this.fire(ud,ht(p),p)}.bind(this),this._elementMousedown=function(p){this.fire(cd,ht(p),p)}.bind(this),this._elementContextmenu=function(p){this.fire(dd,ht(p),p)}.bind(this)}},{key:"_attachEventDelegates",value:function(){var e=this.getContainer();this.eventManager.on(e,ot,Nt,this._overlayClick),this.eventManager.on(e,ft,Nt,this._overlayDblClick),this.eventManager.on(e,yt,Nt,this._overlayTap),this.eventManager.on(e,vt,Nt,this._overlayDblTap),this.eventManager.on(e,ot,Ct,this._connectorClick),this.eventManager.on(e,ft,Ct,this._connectorDblClick),this.eventManager.on(e,yt,Ct,this._connectorTap),this.eventManager.on(e,vt,Ct,this._connectorDblTap),this.eventManager.on(e,ot,dn,this._endpointClick),this.eventManager.on(e,ft,dn,this._endpointDblClick),this.eventManager.on(e,ot,this.managedElementsSelector,this._elementClick),this.eventManager.on(e,yt,this.managedElementsSelector,this._elementTap),this.eventManager.on(e,vt,this.managedElementsSelector,this._elementDblTap),this.eventManager.on(e,gt,Ct,this._connectorMouseover),this.eventManager.on(e,pt,Ct,this._connectorMouseout),this.eventManager.on(e,Ft,Ct,this._connectorContextmenu),this.eventManager.on(e,ce,Ct,this._connectorMouseup),this.eventManager.on(e,ue,Ct,this._connectorMousedown),this.eventManager.on(e,gt,dn,this._endpointMouseover),this.eventManager.on(e,pt,dn,this._endpointMouseout),this.eventManager.on(e,ce,dn,this._endpointMouseup),this.eventManager.on(e,ue,dn,this._endpointMousedown),this.eventManager.on(e,gt,Nt,this._overlayMouseover),this.eventManager.on(e,pt,Nt,this._overlayMouseout),this.eventManager.on(e,gt,Oe,this._elementMouseenter),this.eventManager.on(e,pt,Oe,this._elementMouseexit),this.eventManager.on(e,Ye,Oe,this._elementMousemove),this.eventManager.on(e,ce,Oe,this._elementMouseup),this.eventManager.on(e,ue,Oe,this._elementMousedown),this.eventManager.on(e,Ft,Oe,this._elementContextmenu)}},{key:"_detachEventDelegates",value:function(){var e=this.getContainer();e&&(this.eventManager.off(e,ot,this._connectorClick),this.eventManager.off(e,ft,this._connectorDblClick),this.eventManager.off(e,yt,this._connectorTap),this.eventManager.off(e,vt,this._connectorDblTap),this.eventManager.off(e,ot,this._endpointClick),this.eventManager.off(e,ft,this._endpointDblClick),this.eventManager.off(e,ot,this._overlayClick),this.eventManager.off(e,ft,this._overlayDblClick),this.eventManager.off(e,yt,this._overlayTap),this.eventManager.off(e,vt,this._overlayDblTap),this.eventManager.off(e,ot,this._elementClick),this.eventManager.off(e,yt,this._elementTap),this.eventManager.off(e,vt,this._elementDblTap),this.eventManager.off(e,gt,this._connectorMouseover),this.eventManager.off(e,pt,this._connectorMouseout),this.eventManager.off(e,Ft,this._connectorContextmenu),this.eventManager.off(e,ce,this._connectorMouseup),this.eventManager.off(e,ue,this._connectorMousedown),this.eventManager.off(e,gt,this._endpointMouseover),this.eventManager.off(e,pt,this._endpointMouseout),this.eventManager.off(e,ce,this._endpointMouseup),this.eventManager.off(e,ue,this._endpointMousedown),this.eventManager.off(e,gt,this._overlayMouseover),this.eventManager.off(e,pt,this._overlayMouseout),this.eventManager.off(e,Qo,this._elementMouseenter),this.eventManager.off(e,Jo,this._elementMouseexit),this.eventManager.off(e,Ye,this._elementMousemove),this.eventManager.off(e,ce,this._elementMouseup),this.eventManager.off(e,ue,this._elementMousedown),this.eventManager.off(e,Ft,this._elementContextmenu))}},{key:"setContainer",value:function(e){var t=this;if(e===document||e===document.body)throw new Error("Cannot set document or document.body as container element");this._detachEventDelegates();var r;this.dragManager!=null&&(r=this.dragManager.reset()),this.setAttribute(e,Va,He().replace("-",""));var s=this.getContainer();if(s!=null){s.removeAttribute(Va);var l=Zi(s.childNodes).filter(function(u){return u!=null&&(t.hasClass(u,$o)||t.hasClass(u,Wn)||t.hasClass(u,Br)||u.getAttribute&&u.getAttribute(Kt)!=null)});Q(l,function(u){e.appendChild(u)})}Ie(Me(n.prototype),"setContainer",this).call(this,e),this.containerType=_o(e),this.eventManager!=null&&this._attachEventDelegates(),this.dragManager!=null&&(this.dragManager.addHandler(new ss(this)),this.dragManager.addHandler(new ls(this,this.dragSelection),this.groupDragOptions),this.elementDragHandler=new To(this,this.dragSelection),this.dragManager.addHandler(this.elementDragHandler,this.elementDragOptions),r!=null&&this.dragManager.setFilters(r))}},{key:"reset",value:function(){Ie(Me(n.prototype),"reset",this).call(this),this._resizeObserver&&this._resizeObserver.disconnect();var e=this.getContainer(),t=e.querySelectorAll([Oe,dn,Ct,Nt].join(","));Q(t,function(r){return r.parentNode&&r.parentNode.removeChild(r)})}},{key:"destroy",value:function(){this._detachEventDelegates(),this.dragManager!=null&&this.dragManager.reset(),this.clearDragSelection(),Ie(Me(n.prototype),"destroy",this).call(this)}},{key:"unmanage",value:function(e,t){this._resizeObserver!=null&&this._resizeObserver.unobserve(e),this.removeFromDragSelection(e),Ie(Me(n.prototype),"unmanage",this).call(this,e,t)}},{key:"addToDragSelection",value:function(){for(var e=this,t=arguments.length,r=new Array(t),s=0;s<t;s++)r[s]=arguments[s];Q(r,function(l){return e.dragSelection.add(l)})}},{key:"clearDragSelection",value:function(){this.dragSelection.clear()}},{key:"removeFromDragSelection",value:function(){for(var e=this,t=arguments.length,r=new Array(t),s=0;s<t;s++)r[s]=arguments[s];Q(r,function(l){return e.dragSelection.remove(l)})}},{key:"toggleDragSelection",value:function(){for(var e=this,t=arguments.length,r=new Array(t),s=0;s<t;s++)r[s]=arguments[s];Q(r,function(l){return e.dragSelection.toggle(l)})}},{key:"addToDragGroup",value:function(e){for(var t,r=arguments.length,s=new Array(r>1?r-1:0),l=1;l<r;l++)s[l-1]=arguments[l];(t=this.elementDragHandler).addToDragGroup.apply(t,[e].concat(s))}},{key:"removeFromDragGroup",value:function(){var e;(e=this.elementDragHandler).removeFromDragGroup.apply(e,arguments)}},{key:"setDragGroupState",value:function(e){for(var t,r=arguments.length,s=new Array(r>1?r-1:0),l=1;l<r;l++)s[l-1]=arguments[l];(t=this.elementDragHandler).setDragGroupState.apply(t,[e].concat(s))}},{key:"clearDragGroup",value:function(e){this.elementDragHandler.clearDragGroup(e)}},{key:"consume",value:function(e,t){Fi(e,t)}},{key:"rotate",value:function(e,t,r){var s=this.getId(e);return this._managedElements[s]?(this._managedElements[s].el.style.transform="rotate("+t+"deg)",this._managedElements[s].el.style.transformOrigin="center center",Ie(Me(n.prototype),"rotate",this).call(this,e,t,r)):{c:new Set,e:new Set}}},{key:"addOverlayClass",value:function(e,t){if(zt(e))e.instance.addClass(kt(e),t);else if(Vn(e))e.instance.addClass(Li(e),t);else if($t(e))e.instance.addClass(vn(e),t);else throw"Could not add class to overlay of type ["+e.type+"]"}},{key:"removeOverlayClass",value:function(e,t){if(zt(e))e.instance.removeClass(kt(e),t);else if(Vn(e))e.instance.removeClass(Li(e),t);else if($t(e))e.instance.removeClass(vn(e),t);else throw"Could not remove class from overlay of type ["+e.type+"]"}},{key:"_paintOverlay",value:function(e,t,r){if(zt(e)){kt(e);var s=e.component.getXY();e.canvas.style.left=s.x+t.d.minx+"px",e.canvas.style.top=s.y+t.d.miny+"px"}else if(Vn(e)){var l=isNaN(t.d.cxy.x)||isNaN(t.d.cxy.y)?"M 0 0":"M"+t.d.hxy.x+","+t.d.hxy.y+" L"+t.d.tail[0].x+","+t.d.tail[0].y+" L"+t.d.cxy.x+","+t.d.cxy.y+" L"+t.d.tail[1].x+","+t.d.tail[1].y+" Z";hf(e,l,t,r)}else if($t(e)){vn(e);var u=e.component.getXY();e.canvas.style.left=u.x+t.d.minx+"px",e.canvas.style.top=u.y+t.d.miny+"px"}else throw"Could not paint overlay of type ["+e.type+"]"}},{key:"setOverlayVisible",value:function(e,t){var r=t?"block":"none";function s(l){l!=null&&(l.style.display=r)}zt(e)?s(kt(e)):$t(e)?s(vn(e)):Vn(e)&&s(e.path)}},{key:"reattachOverlay",value:function(e,t){zt(e)?e.instance._appendElement(kt(e),this.getContainer()):$t(e)?e.instance._appendElement(vn(e),this.getContainer()):Vn(e)&&this._appendElement(Li(e),t.connector.canvas)}},{key:"setOverlayHover",value:function(e,t){var r;zt(e)?r=kt(e):$t(e)?r=vn(e):Vn(e)&&(r=Li(e)),r!=null&&(this.hoverClass!=null&&(t?this.addClass(r,this.hoverClass):this.removeClass(r,this.hoverClass)),this.setHover(e.component,t))}},{key:"destroyOverlay",value:function(e){if(zt(e)){var t=kt(e);t.parentNode.removeChild(t),delete e.canvas,delete e.cachedDimensions}else if(Ao(e)||wo(e)||Do(e))ff(e);else if($t(e)){var r=vn(e);r.parentNode.removeChild(r),delete e.canvas,delete e.cachedDimensions}}},{key:"drawOverlay",value:function(e,t,r,s){if(zt(e)||$t(e)){var l=la._getDimensions(e);if(l!=null&&l.w!=null&&l.h!=null){var u={x:0,y:0};if(s)u={x:s.x,y:s.y};else if(t instanceof ci){var d=Array.isArray(e.location)?e.location:[e.location,e.location];u={x:d[0]*t.w,y:d[1]*t.h}}else{var h=e.location,f=!1;(Le(e.location)||e.location<0||e.location>1)&&(h=parseInt(""+e.location,10),f=!0),u=t.pointOnPath(h,f)}var g=u.x-l.w/2,y=u.y-l.h/2;return{component:e,d:{minx:g,miny:y,td:l,cxy:u},xmin:g,xmax:g+l.w,ymin:y,ymax:y+l.h}}else return{xmin:0,xmax:0,ymin:0,ymax:0}}else{if(Ao(e)||wo(e)||Do(e))return e.draw(t,r,s);throw"Could not draw overlay of type ["+e.type+"]"}}},{key:"updateLabel",value:function(e){if(En(e.label)){var t=e.label(this);t!=null?kt(e).innerText=t:kt(e).innerText=""}else e.labelText==null&&(e.labelText=e.label,e.labelText!=null?kt(e).innerText=e.labelText:kt(e).innerText="")}},{key:"setHover",value:function(e,t){e._hover=t,e instanceof zn&&e.endpoint!=null?this.setEndpointHover(e,t,-1):e instanceof Hi&&e.connector!=null&&this.setConnectorHover(e.connector,t)}},{key:"paintConnector",value:function(e,t,r){vf(this,e,t,r)}},{key:"setConnectorHover",value:function(e,t,r){if(t===!1||!this.currentlyDragging&&!this.isHoverSuspended()){var s=e.canvas;s!=null&&(e.hoverClass!=null&&(t?this.addClass(s,e.hoverClass):this.removeClass(s,e.hoverClass)),t?this.addClass(s,this.hoverClass):this.removeClass(s,this.hoverClass)),e.connection.hoverPaintStyle!=null&&(e.connection.paintStyleInUse=t?e.connection.hoverPaintStyle:e.connection.paintStyle,this._suspendDrawing||this._paintConnection(e.connection)),e.connection.endpoints[0]!==r&&this.setEndpointHover(e.connection.endpoints[0],t,0,!0),e.connection.endpoints[1]!==r&&this.setEndpointHover(e.connection.endpoints[1],t,1,!0)}}},{key:"destroyConnector",value:function(e){e.connector!=null&&Ss(e.connector)}},{key:"addConnectorClass",value:function(e,t){e.canvas&&this.addClass(e.canvas,t)}},{key:"removeConnectorClass",value:function(e,t){e.canvas&&this.removeClass(e.canvas,t)}},{key:"getConnectorClass",value:function(e){return e.canvas?e.canvas.className.baseVal:""}},{key:"setConnectorVisible",value:function(e,t){xs(e,t)}},{key:"applyConnectorType",value:function(e,t){if(e.canvas&&t.cssClass){var r=Array.isArray(t.cssClass)?t.cssClass:[t.cssClass];this.addClass(e.canvas,r.join(" "))}}},{key:"addEndpointClass",value:function(e,t){var r=ki(e.endpoint);r!=null&&this.addClass(r,t)}},{key:"applyEndpointType",value:function(e,t){if(t.cssClass){var r=ki(e.endpoint);if(r){var s=Array.isArray(t.cssClass)?t.cssClass:[t.cssClass];this.addClass(r,s.join(" "))}}}},{key:"destroyEndpoint",value:function(e){var t=this.endpointAnchorClassPrefix+(e.currentAnchorClass?"-"+e.currentAnchorClass:"");this.removeClass(e.element,t),Ss(e.endpoint)}},{key:"renderEndpoint",value:function(e,t){var r=Xl[e.endpoint.type];r!=null?gf.paint(e.endpoint,r,t):Be("jsPlumb: no endpoint renderer found for type ["+e.endpoint.type+"]")}},{key:"removeEndpointClass",value:function(e,t){var r=ki(e.endpoint);r!=null&&this.removeClass(r,t)}},{key:"getEndpointClass",value:function(e){var t=ki(e.endpoint);return t!=null?t.className:""}},{key:"setEndpointHover",value:function(e,t,r,s){if(e!=null&&(t===!1||!this.currentlyDragging&&!this.isHoverSuspended())){var l=ki(e.endpoint);if(l!=null&&(e.hoverClass!=null&&(t?this.addClass(l,e.hoverClass):this.removeClass(l,e.hoverClass)),r===0||r===1)){var u=r===0?this.hoverSourceClass:this.hoverTargetClass;t?this.addClass(l,u):this.removeClass(l,u)}if(e.hoverPaintStyle!=null&&(e.paintStyleInUse=t?e.hoverPaintStyle:e.paintStyle,this._suspendDrawing||this.renderEndpoint(e,e.paintStyleInUse)),!s)for(var d=0;d<e.connections.length;d++)this.setConnectorHover(e.connections[d].connector,t,e)}}},{key:"setEndpointVisible",value:function(e,t){xs(e.endpoint,t)}},{key:"setGroupVisible",value:function(e,t){for(var r=e.el.querySelectorAll(Oe),s=0;s<r.length;s++)t?this.show(r[s],!0):this.hide(r[s],!0)}},{key:"deleteConnection",value:function(e,t){return e!=null&&e.deleted!==!0?(e.endpoints[0].deleted!==!0&&this.setEndpointHover(e.endpoints[0],!1,0,!0),e.endpoints[1].deleted!==!0&&this.setEndpointHover(e.endpoints[1],!1,1,!0),Ie(Me(n.prototype),"deleteConnection",this).call(this,e,t)):!1}},{key:"addSourceSelector",value:function(e,t,r){return this.addDragFilter(e),Ie(Me(n.prototype),"addSourceSelector",this).call(this,e,t,r)}},{key:"removeSourceSelector",value:function(e){this.removeDragFilter(e.selector),Ie(Me(n.prototype),"removeSourceSelector",this).call(this,e)}},{key:"manage",value:function(e,t,r){if(this.containerType===Cn.SVG&&!yc(e))throw new Error("ERROR: cannot manage non-svg element when container is an SVG element.");var s=Ie(Me(n.prototype),"manage",this).call(this,e,t,r);return s!=null&&this._resizeObserver!=null&&this._resizeObserver.observe(s.el),s}}]),n}(Rf),jf="circle",Vf=function(){ca(oi.type,{makeNode:function(n,i){return Ht(jf,{cx:n.w/2,cy:n.h/2,r:n.radius})},updateNode:function(n,i){Bt(i,{cx:""+n.w/2,cy:""+n.h/2,r:""+n.radius})}})},Nr=function(o){me(n,o);var a=_e(n);function n(i,e){var t;return $(this,n),t=a.call(this,i,e),c(v(t),"width",void 0),c(v(t),"height",void 0),c(v(t),"type",n.type),e=e||{},t.width=e.width||10,t.height=e.height||10,t}return Z(n,null,[{key:"_getParams",value:function(e){return{width:e.width,height:e.height}}}]),n}(ci);c(Nr,"type","Rectangle");var Uf={type:Nr.type,cls:Nr,compute:function(a,n,i,e){var t=e.width||a.width,r=e.height||a.height,s=n.curX-t/2,l=n.curY-r/2;return a.x=s,a.y=l,a.w=t,a.h=r,[s,l,t,r]},getParams:function(a){return{width:a.width,height:a.height}}},Bf="rect",Hf=function(){ca(Nr.type,{makeNode:function(n,i){return Ht(Bf,{width:n.w,height:n.h})},updateNode:function(n,i){Bt(i,{width:n.w,height:n.h})}})},Rr=function(o){me(n,o);var a=_e(n);function n(i,e){var t;return $(this,n),t=a.call(this,i,e),c(v(t),"type",n.type),t}return n}(ci);c(Rr,"type","Blank");var qf={type:Rr.type,cls:Rr,compute:function(a,n,i,e){return a.x=n.curX,a.y=n.curY,a.w=10,a.h=0,[n.curX,n.curY,10,0]},getParams:function(a){return{}}},Ts={width:10,height:0,fill:"transparent",stroke:"transparent"},Yf=function(){ca(Rr.type,{makeNode:function(n,i){return Ht("rect",Ts)},updateNode:function(n,i){Bt(i,Ts)}})};Vf();Yf();Hf();var At;(function(o){o[o.top=0]="top",o[o.bottom=1]="bottom"})(At||(At={}));var da=new Map;da.set(At.top,[Dt.TopRight,Dt.TopLeft]);da.set(At.bottom,[Dt.BottomRight,Dt.BottomLeft]);var zf={deriveAnchor:function(a,n,i,e){return da.get(a)[n]}},ha="jtk-scrollable-list",$f=Ur(ha),Ps="scroll";(function(){function o(a,n){var i=this;$(this,o),this.instance=a,c(this,"options",void 0),c(this,"count",void 0),c(this,"lists",void 0),this.count=0,this.lists={},this.options=n||{},this.instance.bind(yl,function(e){for(var t=i.instance.getSelector(e.el,$f),r=0;r<t.length;r++)i.addList(t[r])}),this.instance.bind(_l,function(e){i.removeList(e.el)}),this.instance.bind(Wo,function(e,t){if(t==null){var r=i.findParentList(e.target);r!=null&&r.newConnection(e.connection,e.target,1);var s=i.findParentList(e.source);s!=null&&s.newConnection(e.connection,e.source,0)}}),this.instance.bind(bl,function(e){var t=e.dropEndpoint.element,r=i.findParentList(t);return r==null||t.offsetTop>=r.domElement.scrollTop&&t.offsetTop+t.offsetHeight<=r.domElement.scrollTop+r.domElement.offsetHeight})}return Z(o,[{key:"addList",value:function(n,i){var e=K({},zf);K(e,this.options),i=K(e,i||{});var t=[this.instance._instanceIndex,this.count++].join("_");return this.lists[t]=new Xf(this.instance,n,i,t),this.lists[t]}},{key:"getList",value:function(n){var i=this.instance.getAttribute(n,ha);if(i!=null)return this.lists[i]}},{key:"removeList",value:function(n){var i=this.getList(n);i&&(i.destroy(),delete this.lists[i.id])}},{key:"findParentList",value:function(n){for(var i=n.parentNode,e=this.instance.getContainer(),t;i!=null&&i!==e&&i!==document;){if(t=this.getList(i),t!=null)return t;i=i.parentNode}}}]),o})();var Xf=function(){function o(a,n,i,e){$(this,o),this.instance=a,this.el=n,this.options=i,this.id=e,c(this,"_scrollHandler",void 0),c(this,"domElement",void 0),c(this,"elId",void 0),this.domElement=n,this.elId=this.instance.getId(n),a.setAttribute(n,ha,e),this._scrollHandler=this.scrollHandler.bind(this),this.domElement._jsPlumbScrollHandler=this._scrollHandler,a.on(n,Ps,this._scrollHandler),this._scrollHandler()}return Z(o,[{key:"deriveAnchor",value:function(n,i,e,t){return this.options.anchor?this.options.anchor:this.options.deriveAnchor(n,i,e,t)}},{key:"deriveEndpoint",value:function(n,i,e,t){return this.options.deriveEndpoint?this.options.deriveEndpoint(n,i,e,t):this.options.endpoint?this.options.endpoint:e.endpoint.type}},{key:"newConnection",value:function(n,i,e){i.offsetTop<this.el.scrollTop?this._proxyConnection(i,n,e,At.top):i.offsetTop+i.offsetHeight>this.el.scrollTop+this.domElement.offsetHeight&&this._proxyConnection(i,n,e,At.bottom)}},{key:"scrollHandler",value:function(){for(var n=this,i=this.instance.getSelector(this.el,Oe),e=function(s){if(i[s].offsetTop<n.el.scrollTop)i[s]._jsPlumbProxies=i[s]._jsPlumbProxies||[],n.instance.select({source:i[s]}).each(function(u){n._proxyConnection(i[s],u,0,At.top)}),n.instance.select({target:i[s]}).each(function(u){n._proxyConnection(i[s],u,1,At.top)});else if(i[s].offsetTop+i[s].offsetHeight>n.el.scrollTop+n.domElement.offsetHeight)i[s]._jsPlumbProxies=i[s]._jsPlumbProxies||[],n.instance.select({source:i[s]}).each(function(u){n._proxyConnection(i[s],u,0,At.bottom)}),n.instance.select({target:i[s]}).each(function(u){n._proxyConnection(i[s],u,1,At.bottom)});else if(i[s]._jsPlumbProxies){for(var l=0;l<i[s]._jsPlumbProxies.length;l++)n.instance.unproxyConnection(i[s]._jsPlumbProxies[l][0],i[s]._jsPlumbProxies[l][1]);delete i[s]._jsPlumbProxies}n.instance.revalidate(i[s])},t=0;t<i.length;t++)e(t)}},{key:"_proxyConnection",value:function(n,i,e,t){var r=this;this.instance.proxyConnection(i,e,this.domElement,function(s,l){return r.deriveEndpoint(t,l,i.endpoints[l],i)},function(s,l){return r.deriveAnchor(t,l,i.endpoints[l],i)}),n._jsPlumbProxies=n._jsPlumbProxies||[],n._jsPlumbProxies.push([i,e])}},{key:"destroy",value:function(){this.instance.off(this.el,Ps,this._scrollHandler),delete this.domElement._jsPlumbScrollHandler;for(var n=this.instance.getSelector(this.el,Oe),i=0;i<n.length;i++)if(n[i]._jsPlumbProxies){for(var e=0;e<n[i]._jsPlumbProxies.length;e++)this.instance.unproxyConnection(n[i]._jsPlumbProxies[e][0],n[i]._jsPlumbProxies[e][1]);delete n[i]._jsPlumbProxies}}}]),o}(),As=1e-10;function ws(o){var a=Math.floor(o),n=Math.ceil(o);return o-a<As?a:n-o<As?n:o}var fa=function(o){me(n,o);var a=_e(n);function n(i){var e;$(this,n),e=a.call(this,i),c(v(e),"type",n.segmentType),c(v(e),"cx",void 0),c(v(e),"cy",void 0),c(v(e),"radius",void 0),c(v(e),"anticlockwise",void 0),c(v(e),"startAngle",void 0),c(v(e),"endAngle",void 0),c(v(e),"sweep",void 0),c(v(e),"length",void 0),c(v(e),"circumference",void 0),c(v(e),"frac",void 0),e.cx=i.cx,e.cy=i.cy,e.radius=i.r,e.anticlockwise=i.ac,i.startAngle&&i.endAngle?(e.startAngle=i.startAngle,e.endAngle=i.endAngle,e.x1=e.cx+e.radius*Math.cos(e.startAngle),e.y1=e.cy+e.radius*Math.sin(e.startAngle),e.x2=e.cx+e.radius*Math.cos(e.endAngle),e.y2=e.cy+e.radius*Math.sin(e.endAngle)):(e.startAngle=e._calcAngle(e.x1,e.y1),e.endAngle=e._calcAngle(e.x2,e.y2)),e.endAngle<0&&(e.endAngle+=hn),e.startAngle<0&&(e.startAngle+=hn);var t=e.endAngle<e.startAngle?e.endAngle+hn:e.endAngle;return e.sweep=Math.abs(t-e.startAngle),e.anticlockwise&&(e.sweep=hn-e.sweep),e.circumference=2*Math.PI*e.radius,e.frac=e.sweep/hn,e.length=e.circumference*e.frac,e.extents={xmin:e.cx-e.radius,xmax:e.cx+e.radius,ymin:e.cy-e.radius,ymax:e.cy+e.radius},e}return Z(n,[{key:"_calcAngle",value:function(e,t){return Kd({x:this.cx,y:this.cy},{x:e,y:t})}},{key:"_calcAngleForLocation",value:function(e,t){if(e.anticlockwise){var r=e.startAngle<e.endAngle?e.startAngle+hn:e.startAngle,s=Math.abs(r-e.endAngle);return r-s*t}else{var l=e.endAngle<e.startAngle?e.endAngle+hn:e.endAngle,u=Math.abs(l-e.startAngle);return e.startAngle+u*t}}},{key:"getPath",value:function(e){var t=this.sweep>Math.PI?1:0,r=this.anticlockwise?0:1;return(e?"M"+this.x1+" "+this.y1+" ":"")+"A "+this.radius+" "+this.radius+" 0 "+t+","+r+" "+this.x2+" "+this.y2}},{key:"getLength",value:function(){return this.length}},{key:"pointOnPath",value:function(e,t){if(e===0)return{x:this.x1,y:this.y1,theta:this.startAngle};if(e===1)return{x:this.x2,y:this.y2,theta:this.endAngle};t&&(e=e/length);var r=this._calcAngleForLocation(this,e),s=this.cx+this.radius*Math.cos(r),l=this.cy+this.radius*Math.sin(r);return{x:ws(s),y:ws(l),theta:r}}},{key:"gradientAtPoint",value:function(e,t){var r=this.pointOnPath(e,t),s=Wd({x:this.cx,y:this.cy},r);return!this.anticlockwise&&(s===1/0||s===-1/0)&&(s*=-1),s}},{key:"pointAlongPathFrom",value:function(e,t,r){var s=this.pointOnPath(e,r),l=t/this.circumference*2*Math.PI,u=this.anticlockwise?-1:1,d=s.theta+u*l,h=this.cx+this.radius*Math.cos(d),f=this.cy+this.radius*Math.sin(d);return{x:h,y:f}}}]),n}(Zo);c(fa,"segmentType","Arc");var Wl=function(o){me(n,o);var a=_e(n);function n(i,e){var t;return $(this,n),t=a.call(this,i,e),t.connection=i,c(v(t),"showLoopback",void 0),c(v(t),"curviness",void 0),c(v(t),"margin",void 0),c(v(t),"proximityLimit",void 0),c(v(t),"orientation",void 0),c(v(t),"loopbackRadius",void 0),c(v(t),"clockwise",void 0),c(v(t),"isLoopbackCurrently",void 0),c(v(t),"geometry",null),e=e||{},t.showLoopback=e.showLoopback!==!1,t.curviness=e.curviness||10,t.margin=e.margin||5,t.proximityLimit=e.proximityLimit||80,t.clockwise=e.orientation&&e.orientation==="clockwise",t.loopbackRadius=e.loopbackRadius||25,t.isLoopbackCurrently=!1,t}return Z(n,[{key:"getDefaultStubs",value:function(){return[0,0]}},{key:"_compute",value:function(e,t){var r=t.sourcePos,s=t.targetPos,l=Math.abs(r.curX-s.curX),u=Math.abs(r.curY-s.curY);if(!this.showLoopback||t.sourceEndpoint.elementId!==t.targetEndpoint.elementId)this.isLoopbackCurrently=!1,this._computeBezier(e,t,r,s,l,u);else{this.isLoopbackCurrently=!0;var d=t.sourcePos.curX,h=t.sourcePos.curY-this.margin,f=d,g=h-this.loopbackRadius,y=f-this.loopbackRadius,_=g-this.loopbackRadius;l=2*this.loopbackRadius,u=2*this.loopbackRadius,e.points[0]=y,e.points[1]=_,e.points[2]=l,e.points[3]=u,this._addSegment(fa,{loopback:!0,x1:d-y+4,y1:h-_,startAngle:0,endAngle:2*Math.PI,r:this.loopbackRadius,ac:!this.clockwise,x2:d-y-4,y2:h-_,cx:f-y,cy:g-_})}}},{key:"exportGeometry",value:function(){return this.geometry==null?null:{controlPoints:[K({},this.geometry.controlPoints[0]),K({},this.geometry.controlPoints[1])],source:K({},this.geometry.source),target:K({},this.geometry.target)}}},{key:"transformGeometry",value:function(e,t,r){return{controlPoints:[{x:e.controlPoints[0].x+t,y:e.controlPoints[0].y+r},{x:e.controlPoints[1].x+t,y:e.controlPoints[1].y+r}],source:this.transformAnchorPlacement(e.source,t,r),target:this.transformAnchorPlacement(e.target,t,r)}}},{key:"importGeometry",value:function(e){return e!=null?e.controlPoints==null||e.controlPoints.length!=2?(Be("jsPlumb Bezier: cannot import geometry; controlPoints missing or does not have length 2"),this.setGeometry(null,!0),!1):e.controlPoints[0].x==null||e.controlPoints[0].y==null||e.controlPoints[1].x==null||e.controlPoints[1].y==null?(Be("jsPlumb Bezier: cannot import geometry; controlPoints malformed"),this.setGeometry(null,!0),!1):e.source==null||e.source.curX==null||e.source.curY==null?(Be("jsPlumb Bezier: cannot import geometry; source missing or malformed"),this.setGeometry(null,!0),!1):e.target==null||e.target.curX==null||e.target.curY==null?(Be("jsPlumb Bezier: cannot import geometry; target missing or malformed"),this.setGeometry(null,!0),!1):(this.setGeometry(e,!1),!0):!1}}]),n}(qr),wt={subtract:function(a,n){return{x:a.x-n.x,y:a.y-n.y}},dotProduct:function(a,n){return a.x*n.x+a.y*n.y},square:function(a){return Math.sqrt(a.x*a.x+a.y*a.y)},scale:function(a,n){return{x:a.x*n,y:a.y*n}}},Kl=64,Wf=Math.pow(2,-Kl-1);function Kf(o,a){for(var n=[],i=Jf(o,a),e=a.length-1,t=2*e-1,r=Oo(i,t,n,0),s=wt.subtract(o,a[0]),l=wt.square(s),u=0,d,h=0;h<r;h++)s=wt.subtract(o,va(a,e,n[h],null,null)),d=wt.square(s),d<l&&(l=d,u=n[h]);return s=wt.subtract(o,a[e]),d=wt.square(s),d<l&&(l=d,u=1),{location:u,distance:l}}function Qf(o,a){var n=Kf(o,a);return{point:va(a,a.length-1,n.location,null,null),location:n.location}}function Jf(o,a){for(var n=a.length-1,i=2*n-1,e=[],t=[],r=[],s=[],l=[[1,.6,.3,.1],[.4,.6,.6,.4],[.1,.3,.6,1]],u=0;u<=n;u++)e[u]=wt.subtract(a[u],o);for(var d=0;d<=n-1;d++)t[d]=wt.subtract(a[d+1],a[d]),t[d]=wt.scale(t[d],3);for(var h=0;h<=n-1;h++)for(var f=0;f<=n;f++)r[h]||(r[h]=[]),r[h][f]=wt.dotProduct(t[h],e[f]);for(var g=0;g<=i;g++)s[g]||(s[g]=[]),s[g].y=0,s[g].x=parseFloat(""+g)/i;for(var y=n,_=n-1,p=0;p<=y+_;p++)for(var C=Math.max(0,p-_),b=Math.min(p,y),m=C;m<=b;m++){var S=p-m;s[m+S].y+=r[S][m]*l[S][m]}return s}function Oo(o,a,n,i){var e=[],t=[],r,s,l=[],u=[];switch(Zf(o,a)){case 0:return 0;case 1:{if(i>=Kl)return n[0]=(o[0].x+o[a].x)/2,1;if(ev(o,a))return n[0]=tv(o,a),1;break}}va(o,a,.5,e,t),r=Oo(e,a,l,i+1),s=Oo(t,a,u,i+1);for(var d=0;d<r;d++)n[d]=l[d];for(var h=0;h<s;h++)n[h+r]=u[h];return r+s}function Zf(o,a){var n=0,i,e;i=e=kr(o[0].y);for(var t=1;t<=a;t++)i=kr(o[t].y),i!=e&&n++,e=i;return n}function ev(o,a){var n,i,e,t,r,s,l,u,d,h,f,g,y,_,p,C;s=o[0].y-o[a].y,l=o[a].x-o[0].x,u=o[0].x*o[a].y-o[a].x*o[0].y;var b,m;b=m=0;for(var S=1;S<a;S++){var w=s*o[S].x+l*o[S].y+u;w>b?b=w:w<m&&(m=w)}return f=0,g=1,y=0,_=s,p=l,C=u-b,d=f*p-_*g,h=1/d,i=(g*C-p*y)*h,_=s,p=l,C=u-m,d=f*p-_*g,h=1/d,e=(g*C-p*y)*h,t=Math.min(i,e),r=Math.max(i,e),n=r-t,n<Wf?1:0}function tv(o,a){var n=1,i=0,e=o[a].x-o[0].x,t=o[a].y-o[0].y,r=o[0].x-0,s=o[0].y-0,l=e*i-t*n,u=1/l,d=(e*s-t*r)*u;return 0+n*d}function va(o,a,n,i,e){for(var t=[[]],r=0;r<=a;r++)t[0][r]=o[r];for(var s=1;s<=a;s++)for(var l=0;l<=a-s;l++)t[s]||(t[s]=[]),t[s][l]||(t[s][l]={}),t[s][l].x=(1-n)*t[s-1][l].x+n*t[s-1][l+1].x,t[s][l].y=(1-n)*t[s-1][l].y+n*t[s-1][l+1].y;if(i!=null)for(var u=0;u<=a;u++)i[u]=t[u][0];if(e!=null)for(var d=0;d<=a;d++)e[d]=t[a-d][d];return t[a][0]}function nv(o,a){var n=[];o--;for(var i=0;i<=o;i++)n.push(iv(i/o,a));return n}function iv(o,a){var n={x:0,y:0};if(o===0)return a[0];var i=a.length-1;if(o===1)return a[i];var e=a,t=1-o;if(i===0)return a[0];if(i===1)return{x:t*e[0].x+o*e[1].x,y:t*e[0].y+o*e[1].y};if(4>i){var r=t*t,s=o*o,l=0,u,d,h;return i===2?(e=[e[0],e[1],e[2],n],u=r,d=2*(t*o),h=s):i===3&&(u=r*t,d=3*(r*o),h=3*(t*s),l=o*s),{x:u*e[0].x+d*e[1].x+h*e[2].x+l*e[3].x,y:u*e[0].y+d*e[1].y+h*e[2].y+l*e[3].y}}else return n}function rv(o){var a=0;if(!Jl(o))for(var n=16,i=nv(n,o),e=0;e<n-1;e++){var t=i[e],r=i[e+1];a+=Ql(t,r)}return a}var Ds=new Map;function ov(o){var a=Ds.get(o);if(!a){a=[];var n=function(){return function(g){return Math.pow(g,o)}},i=function(){return function(g){return Math.pow(1-g,o)}},e=function(g){return function(y){return g}},t=function(){return function(g){return g}},r=function(){return function(g){return 1-g}},s=function(g){return function(y){for(var _=1,p=0;p<g.length;p++)_=_*g[p](y);return _}};a.push(n());for(var l=1;l<o;l++){for(var u=[e(o)],d=0;d<o-l;d++)u.push(t());for(var h=0;h<l;h++)u.push(r());a.push(s(u))}a.push(i()),Ds.set(o,a)}return a}function qi(o,a){for(var n=ov(o.length-1),i=0,e=0,t=0;t<o.length;t++)i=i+o[t].x*n[t](a),e=e+o[t].y*n[t](a);return{x:i,y:e}}function Ql(o,a){return Math.sqrt(Math.pow(o.x-a.x,2)+Math.pow(o.y-a.y,2))}function Jl(o){return o[0].x===o[1].x&&o[0].y===o[1].y}function Zl(o,a,n){if(Jl(o))return{point:o[0],location:a};for(var i=qi(o,a),e=0,t=a,r=n>0?1:-1,s=null;e<Math.abs(n);)t+=.005*r,s=qi(o,t),e+=Ql(s,i),i=s;return{point:s,location:t}}function av(o,a,n){return Zl(o,a,n).point}function sv(o,a,n){return Zl(o,a,n).location}function lv(o,a){var n=qi(o,a),i=qi(o.slice(0,o.length-1),a),e=i.y-n.y,t=i.x-n.x;return e===0?1/0:Math.atan(e/t)}function uv(o,a,n,i,e){var t=i-a,r=o-n,s=o*(a-i)+a*(n-o),l=cv(e),u=[t*l[0][0]+r*l[1][0],t*l[0][1]+r*l[1][1],t*l[0][2]+r*l[1][2],t*l[0][3]+r*l[1][3]+s],d=dv.apply(null,u),h=[];if(d!=null)for(var f=0;f<3;f++){var g=d[f],y=Math.pow(g,2),_=Math.pow(g,3),p={x:l[0][0]*_+l[0][1]*y+l[0][2]*g+l[0][3],y:l[1][0]*_+l[1][1]*y+l[1][2]*g+l[1][3]},C=void 0;n-o!==0?C=(p[0]-o)/(n-o):C=(p[1]-a)/(i-a),g>=0&&g<=1&&C>=0&&C<=1&&h.push(p)}return h}function Os(o,a){return[-o[0][a]+3*o[1][a]+-3*o[2][a]+o[3][a],3*o[0][a]-6*o[1][a]+3*o[2][a],-3*o[0][a]+3*o[1][a],o[0][a]]}function cv(o){return[Os(o,"x"),Os(o,"y")]}function dv(o,a,n,i){var e=a/o,t=n/o,r=i/o,s=(3*t-Math.pow(e,2))/9,l=(9*e*t-27*r-2*Math.pow(e,3))/54,u=Math.pow(s,3)+Math.pow(l,2),d,h,f=[0,0,0];if(u>=0)d=kr(l+Math.sqrt(u))*Math.pow(Math.abs(l+Math.sqrt(u)),1/3),h=kr(l-Math.sqrt(u))*Math.pow(Math.abs(l-Math.sqrt(u)),1/3),f[0]=-e/3+(d+h),f[1]=-e/3-(d+h)/2,f[2]=-e/3-(d+h)/2,Math.abs(Math.sqrt(3)*(d-h)/2)!==0&&(f[1]=-1,f[2]=-1);else{var g=Math.acos(l/Math.sqrt(-Math.pow(s,3)));f[0]=2*Math.sqrt(-s)*Math.cos(g/3)-e/3,f[1]=2*Math.sqrt(-s)*Math.cos((g+2*Math.PI)/3)-e/3,f[2]=2*Math.sqrt(-s)*Math.cos((g+4*Math.PI)/3)-e/3}for(var y=0;y<3;y++)(f[y]<0||f[y]>1)&&(f[y]=-1);return f}var pa=function(o){me(n,o);var a=_e(n);function n(i){var e;return $(this,n),e=a.call(this,i),c(v(e),"curve",void 0),c(v(e),"cp1x",void 0),c(v(e),"cp1y",void 0),c(v(e),"cp2x",void 0),c(v(e),"cp2y",void 0),c(v(e),"length",0),c(v(e),"type",n.segmentType),e.cp1x=i.cp1x,e.cp1y=i.cp1y,e.cp2x=i.cp2x,e.cp2y=i.cp2y,e.x1=i.x1,e.x2=i.x2,e.y1=i.y1,e.y2=i.y2,e.curve=[{x:e.x1,y:e.y1},{x:e.cp1x,y:e.cp1y},{x:e.cp2x,y:e.cp2y},{x:e.x2,y:e.y2}],e.extents={xmin:Math.min(e.x1,e.x2,e.cp1x,e.cp2x),ymin:Math.min(e.y1,e.y2,e.cp1y,e.cp2y),xmax:Math.max(e.x1,e.x2,e.cp1x,e.cp2x),ymax:Math.max(e.y1,e.y2,e.cp1y,e.cp2y)},e}return Z(n,[{key:"getPath",value:function(e){return(e?"M "+this.x2+" "+this.y2+" ":"")+"C "+this.cp2x+" "+this.cp2y+" "+this.cp1x+" "+this.cp1y+" "+this.x1+" "+this.y1}},{key:"pointOnPath",value:function(e,t){return e=n._translateLocation(this.curve,e,t),qi(this.curve,e)}},{key:"gradientAtPoint",value:function(e,t){return e=n._translateLocation(this.curve,e,t),lv(this.curve,e)}},{key:"pointAlongPathFrom",value:function(e,t,r){return e=n._translateLocation(this.curve,e,r),av(this.curve,e,t)}},{key:"getLength",value:function(){return(this.length==null||this.length===0)&&(this.length=rv(this.curve)),this.length}},{key:"findClosestPointOnPath",value:function(e,t){var r=Qf({x:e,y:t},this.curve);return{d:Math.sqrt(Math.pow(r.point.x-e,2)+Math.pow(r.point.y-t,2)),x:r.point.x,y:r.point.y,l:1-r.location,s:this,x1:null,y1:null,x2:null,y2:null}}},{key:"lineIntersection",value:function(e,t,r,s){return uv(e,t,r,s,this.curve)}}],[{key:"_translateLocation",value:function(e,t,r){return r&&(t=sv(e,t>0?0:1,t)),t}}]),n}(Zo);c(pa,"segmentType","Bezier");var Mo=function(o){me(n,o);var a=_e(n);function n(i,e){var t;return $(this,n),t=a.call(this,i,e),t.connection=i,c(v(t),"type",n.type),c(v(t),"majorAnchor",void 0),c(v(t),"minorAnchor",void 0),e=e||{},t.majorAnchor=e.curviness||150,t.minorAnchor=10,t}return Z(n,[{key:"getCurviness",value:function(){return this.majorAnchor}},{key:"_findControlPoint",value:function(e,t,r,s,l){var u=s[0]!==l[0]||s[1]===l[1],d={x:0,y:0};return u?(l[0]===0?d.x=r.curX<t.curX?e.x+this.minorAnchor:e.x-this.minorAnchor:d.x=e.x+this.majorAnchor*l[0],l[1]===0?d.y=r.curY<t.curY?e.y+this.minorAnchor:e.y-this.minorAnchor:d.y=e.y+this.majorAnchor*s[1]):(s[0]===0?d.x=t.curX<r.curX?e.x+this.minorAnchor:e.x-this.minorAnchor:d.x=e.x-this.majorAnchor*s[0],s[1]===0?d.y=t.curY<r.curY?e.y+this.minorAnchor:e.y-this.minorAnchor:d.y=e.y+this.majorAnchor*l[1]),d}},{key:"_computeBezier",value:function(e,t,r,s,l,u){var d,h,f=r.curX<s.curX?l:0,g=r.curY<s.curY?u:0,y=r.curX<s.curX?0:l,_=r.curY<s.curY?0:u;this.edited!==!0?(d=this._findControlPoint({x:f,y:g},r,s,e.so,e.to),h=this._findControlPoint({x:y,y:_},s,r,e.to,e.so)):(d=this.geometry.controlPoints[0],h=this.geometry.controlPoints[1]),this.geometry={controlPoints:[d,h],source:t.sourcePos,target:t.targetPos},this._addSegment(pa,{x1:f,y1:g,x2:y,y2:_,cp1x:d.x,cp1y:d.y,cp2x:h.x,cp2y:h.y})}}]),n}(Wl);c(Mo,"type","Bezier");function hv(o,a,n,i){return o<=n&&i<=a?1:o<=n&&a<=i?2:n<=o&&i>=a?3:4}function fv(o,a,n,i,e,t,r,s,l){if(s<=l)return{x:o,y:a};if(n===1)return i.curY<=0&&e.curY>=1?{x:o+(i.x<.5?-1*t:t),y:a}:i.curX>=1&&e.curX<=0?{x:o,y:a+(i.y<.5?-1*r:r)}:{x:o+-1*t,y:a+-1*r};if(n===2)return i.curY>=1&&e.curY<=0?{x:o+(i.x<.5?-1*t:t),y:a}:i.curX>=1&&e.curX<=0?{x:o,y:a+(i.y<.5?-1*r:r)}:{x:o+t,y:a+-1*r};if(n===3)return i.curY>=1&&e.curY<=0?{x:o+(i.x<.5?-1*t:t),y:a}:i.curX<=0&&e.curX>=1?{x:o,y:a+(i.y<.5?-1*r:r)}:{x:o+-1*t,y:a+-1*r};if(n===4)return i.curY<=0&&e.curY>=1?{x:o+(i.x<.5?-1*t:t),y:a}:i.curX<=0&&e.curX>=1?{x:o,y:a+(i.y<.5?-1*r:r)}:{x:o+t,y:a+-1*r}}var Io=function(o){me(n,o);var a=_e(n);function n(i,e){var t;return $(this,n),t=a.call(this,i,e),t.connection=i,c(v(t),"type",n.type),c(v(t),"_controlPoint",void 0),t.curviness=e.curviness||10,t.margin=e.margin||5,t.proximityLimit=e.proximityLimit||80,t.clockwise=e.orientation&&e.orientation==="clockwise",t}return Z(n,[{key:"_computeBezier",value:function(e,t,r,s,l,u){var d=r.curX<s.curX?0:l,h=r.curY<s.curY?0:u,f=r.curX<s.curX?l:0,g=r.curY<s.curY?u:0;if(r.x===0&&(d-=this.margin),r.x===1&&(d+=this.margin),r.y===0&&(h-=this.margin),r.y===1&&(h+=this.margin),s.x===0&&(f-=this.margin),s.x===1&&(f+=this.margin),s.y===0&&(g-=this.margin),s.y===1&&(g+=this.margin),this.edited!==!0){var y=(d+f)/2,_=(h+g)/2,p=hv(d,h,f,g),C=Math.sqrt(Math.pow(f-d,2)+Math.pow(g-h,2));this._controlPoint=fv(y,_,p,t.sourcePos,t.targetPos,this.curviness,this.curviness,C,this.proximityLimit)}else this._controlPoint=this.geometry.controlPoints[0];var b,m,S,w;b=this._controlPoint.x,m=this._controlPoint.x,S=this._controlPoint.y,w=this._controlPoint.y,this.geometry={controlPoints:[this._controlPoint,this._controlPoint],source:t.sourcePos,target:t.targetPos},this._addSegment(pa,{x1:f,y1:g,x2:d,y2:h,cp1x:b,cp1y:S,cp2x:m,cp2y:w})}}]),n}(Wl);c(Io,"type","StateMachine");Xi.register(Mo.type,Mo);Xi.register(Io.type,Io);function Ms(o){return o<0?-1:o===0?0:1}function Is(o){return[Ms(o[2]-o[0]),Ms(o[3]-o[1])]}function Ls(o){return Math.sqrt(Math.pow(o[0]-o[2],2)+Math.pow(o[1]-o[3],2))}function Ns(o){var a=[];return a.push.apply(a,o),a}var Lo=function(o){me(n,o);var a=_e(n);function n(i,e){var t;return $(this,n),t=a.call(this,i,e),t.connection=i,c(v(t),"type",n.type),c(v(t),"internalSegments",[]),c(v(t),"midpoint",void 0),c(v(t),"alwaysRespectStubs",void 0),c(v(t),"cornerRadius",void 0),c(v(t),"lastx",void 0),c(v(t),"lasty",void 0),c(v(t),"lastOrientation",void 0),c(v(t),"loopbackRadius",void 0),c(v(t),"isLoopbackCurrently",void 0),t.midpoint=e.midpoint==null||isNaN(e.midpoint)?.5:e.midpoint,t.cornerRadius=e.cornerRadius!=null?e.cornerRadius:0,t.alwaysRespectStubs=e.alwaysRespectStubs===!0,t.lastx=null,t.lasty=null,t.lastOrientation=null,t.loopbackRadius=e.loopbackRadius||25,t.isLoopbackCurrently=!1,t}return Z(n,[{key:"getDefaultStubs",value:function(){return[30,30]}},{key:"addASegment",value:function(e,t,r){if(!(this.lastx===e&&this.lasty===t)){var s=this.lastx==null?r.sx:this.lastx,l=this.lasty==null?r.sy:this.lasty,u=s===e?"v":"h";this.lastx=e,this.lasty=t,this.internalSegments.push([s,l,e,t,u])}}},{key:"writeSegments",value:function(e){for(var t=null,r,s,l,u=0;u<this.internalSegments.length-1;u++){if(t=t||Ns(this.internalSegments[u]),r=Ns(this.internalSegments[u+1]),s=Is(t),l=Is(r),this.cornerRadius>0&&t[4]!==r[4]){var d=Math.min(Ls(t),Ls(r)),h=Math.min(this.cornerRadius,d/2);t[2]-=s[0]*h,t[3]-=s[1]*h,r[0]+=l[0]*h,r[1]+=l[1]*h;var f=s[1]===l[0]&&l[0]===1||s[1]===l[0]&&l[0]===0&&s[0]!==l[1]||s[1]===l[0]&&l[0]===-1,g=r[1]>t[3]?1:-1,y=r[0]>t[2]?1:-1,_=g===y,p=_&&f||!_&&!f?r[0]:t[2],C=_&&f||!_&&!f?t[3]:r[1];this._addSegment(_n,{x1:t[0],y1:t[1],x2:t[2],y2:t[3]}),this._addSegment(fa,{r:h,x1:t[2],y1:t[3],x2:r[0],y2:r[1],cx:p,cy:C,ac:f})}else this._addSegment(_n,{x1:t[0],y1:t[1],x2:t[2],y2:t[3]});t=r}r!=null&&this._addSegment(_n,{x1:r[0],y1:r[1],x2:r[2],y2:r[3]})}},{key:"_compute",value:function(e,t){var r=this;this.internalSegments.length=0,this.lastx=null,this.lasty=null,this.lastOrientation=null;var s=function(I){return[e.startStubX,e.startStubY,e.endStubX,e.endStubY]},l={perpendicular:s,orthogonal:s,opposite:function(I){var A=e,V=I==="x"?0:1,B={x:function(){return A.so[V]===1&&(A.startStubX>A.endStubX&&A.tx>A.startStubX||A.sx>A.endStubX&&A.tx>A.sx)||A.so[V]===-1&&(A.startStubX<A.endStubX&&A.tx<A.startStubX||A.sx<A.endStubX&&A.tx<A.sx)},y:function(){return A.so[V]===1&&(A.startStubY>A.endStubY&&A.ty>A.startStubY||A.sy>A.endStubY&&A.ty>A.sy)||A.so[V]===-1&&(A.startStubY<A.endStubY&&A.ty<A.startStubY||A.sy<A.endStubY&&A.ty<A.sy)}};return!r.alwaysRespectStubs&&B[I]()?{x:[(e.sx+e.tx)/2,e.startStubY,(e.sx+e.tx)/2,e.endStubY],y:[e.startStubX,(e.sy+e.ty)/2,e.endStubX,(e.sy+e.ty)/2]}[I]:[e.startStubX,e.startStubY,e.endStubX,e.endStubY]}},u=l[e.anchorOrientation](e.sourceAxis),d=e.sourceAxis==="x"?0:1,h=e.sourceAxis==="x"?1:0,f=u[d],g=u[h],y=u[d+2],_=u[h+2];this.addASegment(u[0],u[1],e);var p=e.startStubX+(e.endStubX-e.startStubX)*this.midpoint,C=e.startStubY+(e.endStubY-e.startStubY)*this.midpoint,b={x:[0,1],y:[1,0]},m={perpendicular:function(I,A,V,B,H){var R=e,he={x:[[[1,2,3,4],null,[2,1,4,3]],null,[[4,3,2,1],null,[3,4,1,2]]],y:[[[3,2,1,4],null,[2,3,4,1]],null,[[4,1,2,3],null,[1,4,3,2]]]},U={x:[[R.startStubX,R.endStubX],null,[R.endStubX,R.startStubX]],y:[[R.startStubY,R.endStubY],null,[R.endStubY,R.startStubY]]},J={x:[[p,R.startStubY],[p,R.endStubY]],y:[[R.startStubX,C],[R.endStubX,C]]},T={x:[[R.endStubX,R.startStubY]],y:[[R.startStubX,R.endStubY]]},k={x:[[R.startStubX,R.endStubY],[R.endStubX,R.endStubY]],y:[[R.endStubX,R.startStubY],[R.endStubX,R.endStubY]]},W={x:[[R.startStubX,C],[R.endStubX,C],[R.endStubX,R.endStubY]],y:[[p,R.startStubY],[p,R.endStubY],[R.endStubX,R.endStubY]]},ne={x:[R.startStubY,R.endStubY],y:[R.startStubX,R.endStubX]},j=b[I][0],ie=b[I][1],Pe=R.so[j]+1,we=R.to[ie]+1,bt=R.to[ie]===-1&&ne[I][1]<ne[I][0]||R.to[ie]===1&&ne[I][1]>ne[I][0],Ee=U[I][Pe][0],Fe=U[I][Pe][1],nt=he[I][Pe][we];if(R.segment===nt[3]||R.segment===nt[2]&&bt)return J[I];if(R.segment===nt[2]&&Fe<Ee)return T[I];if(R.segment===nt[2]&&Fe>=Ee||R.segment===nt[1]&&!bt)return W[I];if(R.segment===nt[0]||R.segment===nt[1]&&bt)return k[I]},orthogonal:function(I,A,V,B,H){var R=e,he={x:R.so[0]===-1?Math.min(A,B):Math.max(A,B),y:R.so[1]===-1?Math.min(A,B):Math.max(A,B)}[I];return{x:[[he,V],[he,H],[B,H]],y:[[V,he],[H,he],[H,B]]}[I]},opposite:function(I,A,V,B,H){var R=e,he={x:"y",y:"x"}[I],U={x:"h",y:"w"}[I],J=R["is"+I.toUpperCase()+"GreaterThanStubTimes2"];if(t.sourceEndpoint.elementId===t.targetEndpoint.elementId){var T=V+(1-t.sourceEndpoint._anchor.computedPosition[he])*t.sourceInfo[U]+r.maxStub;return{x:[[A,T],[B,T]],y:[[T,A],[T,B]]}[I]}else{if(!J||R.so[d]===1&&A>B||R.so[d]===-1&&A<B)return{x:[[A,C],[B,C]],y:[[p,A],[p,B]]}[I];if(R.so[d]===1&&A<B||R.so[d]===-1&&A>B)return{x:[[p,R.sy],[p,R.ty]],y:[[R.sx,C],[R.tx,C]]}[I]}}},S=m[e.anchorOrientation](e.sourceAxis,f,g,y,_);if(S)for(var w=0;w<S.length;w++)this.addASegment(S[w][0],S[w][1],e);this.addASegment(u[2],u[3],e),this.addASegment(e.tx,e.ty,e),this.writeSegments(e)}},{key:"transformGeometry",value:function(e,t,r){return e}}]),n}(qr);c(Lo,"type","Flowchart");Xi.register(Lo.type,Lo);Zt.registerHandler(bf);Zt.registerHandler(Uf);Zt.registerHandler(qf);Xi.register(Lr.type,Lr);function vv(){var o=Math.floor(Math.random()*2e3),a=Math.floor(Math.random()*2e3);return{clientX:o,clientY:a,screenX:o,screenY:a,pageX:o,pageY:a}}var Un={clientX:5e4,clientY:5e4,screenX:5e4,screenY:5e4,pageX:5e4,pageY:5e4};for(var ur=0;ur<256;ur++)(ur<16?"0":"")+ur.toString(16);var pv=1e-11;(function(){function o(a,n,i){$(this,o),this._jsPlumb=a,this.ok=n,this.equal=i,c(this,"_divs",[]),c(this,"mottle",void 0),this.mottle=new ta}return Z(o,[{key:"_t",value:function(n,i,e,t){this.mottle.trigger(n,i,{pageX:e,pageY:t,screenX:e,screenY:t,clientX:e,clientY:t})}},{key:"addDiv",value:function(n,i,e,t,r,s,l){var u=document.createElement("div");return u.style.position="absolute",u.innerHTML=n,i?i.appendChild(u):this._jsPlumb.getContainer().appendChild(u),u.setAttribute("id",n),u.style.left=(t!=null?t:Math.floor(Math.random()*1e3))+"px",u.style.top=(r!=null?r:Math.floor(Math.random()*1e3))+"px",e&&(u.className=e),s&&(u.style.width=s+"px"),l&&(u.style.height=l+"px"),this._divs.push(n),u}},{key:"addDivs",value:function(n,i){for(var e=0;e<n.length;e++)this.addDiv(n[e],i)}},{key:"assertEndpointCount",value:function(n,i){var e=this._jsPlumb.getEndpoints(n),t=e?e.length:0;this.equal(t,i,n.getAttribute("data-jtk-managed")+" has "+i+(i>1||i==0?" endpoints":" endpoint"))}},{key:"_assertManagedEndpointCount",value:function(n,i){var e=this._jsPlumb.getId(n),t=this._jsPlumb._managedElements[e];this.equal(t.endpoints.length,i,e+" has "+i+" endpoints in managed record")}},{key:"_assertManagedConnectionCount",value:function(n,i){var e=this._jsPlumb.getId(n),t=this._jsPlumb._managedElements[e];this.equal(t.connections.length,i,e+" has "+i+" connections in managed record")}},{key:"_registerDiv",value:function(n){this._divs.push(n)}},{key:"makeDragStartEvt",value:function(n){var i=this.makeEvent(n),e=this._jsPlumb.getContainer();return i.clientX+=e.offsetLeft,i.screenX+=e.offsetLeft,i.pageX+=e.offsetLeft,i.clientY+=e.offsetTop,i.screenY+=e.offsetTop,i.pageY+=e.offsetTop,i}},{key:"getAttribute",value:function(n,i){return n.getAttribute(i)}},{key:"dragNodeBy",value:function(n,i,e,t){t=t||{},t.before&&t.before();var r=this.makeEvent(n);this._jsPlumb.trigger(n,ue,r),t.beforeMouseMove&&t.beforeMouseMove(),this._t(document,Ye,r.pageX+i,r.pageY+e),t.beforeMouseUp&&t.beforeMouseUp(),this.mottle.trigger(document,ce,null),t.after&&t.after()}},{key:"dragNodeTo",value:function(n,i,e,t){t=t||{};var r=this._jsPlumb.viewport.getPosition(this._jsPlumb.getId(n));t.before&&t.before();var s=this.makeEvent(n);this._jsPlumb.trigger(n,ue,s);var l=this._jsPlumb.getContainer().getBoundingClientRect();t.beforeMouseMove&&t.beforeMouseMove(),this._t(document,Ye,l.x+i+r.w/2,l.y+e+r.h/2),t.beforeMouseUp&&t.beforeMouseUp(),this.mottle.trigger(document,ce,null),t.after&&t.after()}},{key:"dragToGroup",value:function(n,i,e){var t=this._jsPlumb.getGroup(i),r=this._jsPlumb.viewport.getPosition(t.elId),s=r.x+r.w/2,l=r.y+r.h/2;this.dragNodeTo(n,s,l,e)}},{key:"aSyncDragNodeBy",value:function(n,i,e,t){var r=this;t=t||{},t.before&&t.before();var s=this.makeEvent(n);this._jsPlumb.trigger(n,ue,s),t.beforeMouseMove&&t.beforeMouseMove(),setTimeout(function(){r._t(document,Ye,s.pageX+i,s.pageY+e),t.beforeMouseUp&&t.beforeMouseUp(),setTimeout(function(){r.mottle.trigger(document,ce,null),t.after&&t.after()},45)},45)}},{key:"dragANodeAround",value:function(n,i,e){this._jsPlumb.trigger(n,ue,this.makeEvent(n));for(var t=Math.random()*50,r=0;r<t;r++){var s=vv();n.style.left=s.screenX+"px",n.style.top=s.screenY+"px",this._jsPlumb.trigger(document,Ye,s)}i&&this.ok(i(),e||"while dragging assert"),this._jsPlumb.trigger(document,ce,Un)}},{key:"dragConnection",value:function(n,i,e,t){var r=this.getCanvas(n),s=this.getCanvas(i),l=this.makeEvent(r),u=this.makeEvent(s);t=t||{};var d=this._jsPlumb.select().length;return this._jsPlumb.trigger(r,ue,l),t.beforeMouseMove&&t.beforeMouseMove(),this._jsPlumb.trigger(e?s:document,Ye,u),t.beforeMouseUp&&t.beforeMouseUp(),this._jsPlumb.trigger(e?s:document,ce,u),this._jsPlumb.select().get(d)}},{key:"aSyncDragConnection",value:function(n,i,e){var t=this;e=e||{};var r=this.getCanvas(n),s=this.getCanvas(i),l=this.makeEvent(r),u=this.makeEvent(s),d=this._jsPlumb.select().length;this._jsPlumb.trigger(r,ue,l),setTimeout(function(){e.beforeMouseMove&&e.beforeMouseMove(),t._jsPlumb.trigger(document,Ye,u),setTimeout(function(){e.beforeMouseUp&&e.beforeMouseUp(),t._jsPlumb.trigger(s,ce,u),e.after&&e.after(t._jsPlumb.select().get(d))},5)},5)}},{key:"dragAndAbortConnection",value:function(n){var i=this.getCanvas(n),e=this.makeEvent(i);this._jsPlumb.trigger(i,ue,e),this._jsPlumb.trigger(document,Ye,Un),this._jsPlumb.trigger(document,ce,Un)}},{key:"detachConnection",value:function(n,i){i=i||{};var e=this.getEndpointCanvas(n),t=this.makeEvent(e);i.before&&i.before(),this._jsPlumb.trigger(e,ue,t),i.beforeMouseMove&&i.beforeMouseMove(),this._jsPlumb.trigger(document,Ye,Un),i.beforeMouseUp&&i.beforeMouseUp(),this._jsPlumb.trigger(document,ce,Un),i.after&&i.after()}},{key:"detachAndReattachConnection",value:function(n,i){i=i||{};var e=this.getEndpointCanvas(n),t=this.makeEvent(e);i.before&&i.before(),this._jsPlumb.trigger(e,ue,t),i.beforeMouseMove&&i.beforeMouseMove(),this._jsPlumb.trigger(document,Ye,Un),this._jsPlumb.trigger(document,Ye,t),i.beforeMouseUp&&i.beforeMouseUp(),this._jsPlumb.trigger(document,ce,t),i.after&&i.after()}},{key:"detachConnectionByTarget",value:function(n,i){this.detachConnection(n.endpoints[1],i)}},{key:"relocateTarget",value:function(n,i,e){this.relocate(n,1,i,e)}},{key:"relocate",value:function(n,i,e,t){t=t||{},e=this.getCanvas(e);var r=this.getEndpointCanvas(n.endpoints[i]),s=this.makeEvent(r),l=this.makeEvent(e);t.before&&t.before(),this._jsPlumb.trigger(r,ue,s),t.beforeMouseMove&&t.beforeMouseMove(),this._jsPlumb.trigger(document,Ye,l),t.beforeMouseUp&&t.beforeMouseUp(),this._jsPlumb.trigger(e,ce,l),t.after&&t.after()}},{key:"relocateSource",value:function(n,i,e){this.relocate(n,0,i,e)}},{key:"makeEvent",value:function(n){var i=n.getBoundingClientRect(),e=i.x+i.width/2,t=i.y+i.height/2;return{clientX:e,clientY:t,screenX:e,screenY:t,pageX:e,pageY:t}}},{key:"getCanvas",value:function(n){return n.endpoint?this.getEndpointCanvas(n):n}},{key:"getEndpointCanvas",value:function(n){return n.endpoint.canvas}},{key:"getConnectionCanvas",value:function(n){return n.connector.canvas}},{key:"getEndpointCanvasPosition",value:function(n){var i=this.getEndpointCanvas(n);return{x:parseInt(i.style.left,10),y:parseInt(i.style.top,10),w:i.getAttribute("width"),h:i.getAttribute("height")}}},{key:"within",value:function(n,i,e){this.ok(Math.abs(n-i)<pv,e+"[expected: "+i+" got "+n+"] [diff:"+Math.abs(n-i)+"]")}},{key:"assertManagedEndpointCount",value:function(n,i){var e=this._jsPlumb.getId(n),t=this._jsPlumb._managedElements[e];this.equal(t.endpoints.length,i,e+" has "+i+" endpoints in managed record")}},{key:"assertManagedConnectionCount",value:function(n,i){var e=this._jsPlumb.getId(n),t=this._jsPlumb._managedElements[e];this.equal(t.connections.length,i,e+" has "+i+" connections in managed record")}},{key:"fireEventOnEndpoint",value:function(n){for(var i=this.getEndpointCanvas(n),e=0;e<(arguments.length<=1?0:arguments.length-1);e++)this._jsPlumb.trigger(i,e+1<1||arguments.length<=e+1?void 0:arguments[e+1])}},{key:"fireEventOnElement",value:function(n){for(var i=0;i<(arguments.length<=1?0:arguments.length-1);i++)this._jsPlumb.trigger(n,i+1<1||arguments.length<=i+1?void 0:arguments[i+1])}},{key:"fireEventOnConnection",value:function(n){for(var i=this.getConnectionCanvas(n),e=arguments.length,t=new Array(e>1?e-1:0),r=1;r<e;r++)t[r-1]=arguments[r];this.fireEventOnElement.apply(this,[i].concat(t))}},{key:"clickOnConnection",value:function(n){this.fireEventOnConnection(n,ot)}},{key:"dblClickOnConnection",value:function(n){this.fireEventOnConnection(n,ft)}},{key:"tapOnConnection",value:function(n){this.fireEventOnConnection(n,ue),this.fireEventOnConnection(n,ce)}},{key:"dblTapOnConnection",value:function(n){this.fireEventOnConnection(n,ue),this.fireEventOnConnection(n,ce),this.fireEventOnConnection(n,ue),this.fireEventOnConnection(n,ce)}},{key:"clickOnElement",value:function(n,i){this._jsPlumb.trigger(n,ot,null,null,i==null?1:i)}},{key:"dblClickOnElement",value:function(n){this._jsPlumb.trigger(n,ft)}},{key:"tapOnElement",value:function(n){this._jsPlumb.trigger(n,ue),this._jsPlumb.trigger(n,ce)}},{key:"dblTapOnElement",value:function(n){this._jsPlumb.trigger(n,ue),this._jsPlumb.trigger(n,ce),this._jsPlumb.trigger(n,ue),this._jsPlumb.trigger(n,ce)}},{key:"getOverlayCanvas",value:function(n){return n.canvas||n.path}},{key:"fireEventOnOverlay",value:function(n,i,e){var t=n.getOverlay(i),r=this.getOverlayCanvas(t);this._jsPlumb.trigger(r,e)}},{key:"clickOnOverlay",value:function(n,i){this.fireEventOnOverlay(n,i,ot)}},{key:"dblClickOnOverlay",value:function(n,i){this.fireEventOnOverlay(n,i,ft)}},{key:"tapOnOverlay",value:function(n,i){this.fireEventOnOverlay(n,i,ue),this.fireEventOnOverlay(n,i,ce)}},{key:"dblTapOnOverlay",value:function(n,i){this.fireEventOnOverlay(n,i,ue),this.fireEventOnOverlay(n,i,ce),this.fireEventOnOverlay(n,i,ue),this.fireEventOnOverlay(n,i,ce)}},{key:"cleanup",value:function(){var n=this._jsPlumb.getContainer();this._jsPlumb.destroy();for(var i in this._divs){var e=document.getElementById(this._divs[i]);e&&e.parentNode.removeChild(e)}this._divs.length=0;var t=this._jsPlumb.select().length,r=this._jsPlumb.selectEndpoints().length,s=n.querySelectorAll(".jtk-endpoint").length,l=n.querySelectorAll(".jtk-connector").length;for(var u in n.__ta)for(var d in n.__ta[u])throw"Container event bindings not empty for key "+u;if(t>0)throw"there are connections in the data model!";if(r>0)throw"there are endpoints in the data model!";if(s>0)throw"there are "+s+" endpoints left in the dom!";if(l>0)throw"there are "+l+" connections left in the dom!"}},{key:"makeContent",value:function(n){var i=document.createElement("div");return i.innerHTML=n,i.firstChild}},{key:"length",value:function(n){var i=0;for(var e in n)n.hasOwnProperty(e)&&i++;return i}},{key:"head",value:function(n){for(var i in n)return n[i]}},{key:"uuid",value:function(){return He()}}]),o})();var Rs=0;function gv(){var o=Rs+1;return Rs++,o}function yv(o){return new Ff(gv(),o)}const mv={class:"text-h6"},_v={__name:"NodeContextMenu",props:{modelValue:Boolean,nodeItem:Object},emits:["update:modelValue","rename","delete"],setup(o){return(a,n)=>(G(),ye(Yi,{"model-value":o.modelValue,"onUpdate:modelValue":n[2]||(n[2]=i=>a.$emit("update:modelValue",i))},{default:P(()=>[E(tt,null,{default:P(()=>[E(Ue,null,{default:P(()=>[oe("div",mv,Ce(o.nodeItem.name),1)]),_:1}),E(Ut,{bordered:"",separator:""},{default:P(()=>[Xe((G(),ye(Qe,{clickable:"",onClick:n[0]||(n[0]=i=>a.$emit("rename",o.nodeItem))},{default:P(()=>[E(be,null,{default:P(()=>n[3]||(n[3]=[de("Rename")])),_:1,__:[3]})]),_:1})),[[Qn]]),Xe((G(),ye(Qe,{clickable:"",onClick:n[1]||(n[1]=i=>a.$emit("delete",o.nodeItem))},{default:P(()=>[E(be,null,{default:P(()=>n[4]||(n[4]=[de("Delete")])),_:1,__:[4]})]),_:1})),[[Qn]])]),_:1}),E(Fr,{align:"right"},{default:P(()=>[Xe(E(ae,{flat:"",label:"Cancel",color:"primary"},null,512),[[St]])]),_:1})]),_:1})]),_:1},8,["model-value"]))}};var ai=rn({name:"QSpace",setup(){const o=le("div",{class:"q-space"});return()=>o}}),Ev=rn({name:"QBar",props:{...Go,dense:Boolean},setup(o,{slots:a}){const{proxy:{$q:n}}=si(),i=Fo(o,n),e=Y(()=>`q-bar row no-wrap items-center q-bar--${o.dense===!0?"dense":"standard"}  q-bar--${i.value===!0?"dark":"light"}`);return()=>le("div",{class:e.value,role:"toolbar"},li(a.default))}});/*! @license DOMPurify 3.2.6 | (c) Cure53 and other contributors | Released under the Apache license 2.0 and Mozilla Public License 2.0 | github.com/cure53/DOMPurify/blob/3.2.6/LICENSE */const{entries:eu,setPrototypeOf:Gs,isFrozen:bv,getPrototypeOf:Cv,getOwnPropertyDescriptor:kv}=Object;let{freeze:st,seal:Et,create:tu}=Object,{apply:No,construct:Ro}=typeof Reflect!="undefined"&&Reflect;st||(st=function(a){return a});Et||(Et=function(a){return a});No||(No=function(a,n,i){return a.apply(n,i)});Ro||(Ro=function(a,n){return new a(...n)});const cr=lt(Array.prototype.forEach),xv=lt(Array.prototype.lastIndexOf),Fs=lt(Array.prototype.pop),xi=lt(Array.prototype.push),Sv=lt(Array.prototype.splice),_r=lt(String.prototype.toLowerCase),lo=lt(String.prototype.toString),js=lt(String.prototype.match),Si=lt(String.prototype.replace),Tv=lt(String.prototype.indexOf),Pv=lt(String.prototype.trim),xt=lt(Object.prototype.hasOwnProperty),rt=lt(RegExp.prototype.test),Ti=Av(TypeError);function lt(o){return function(a){a instanceof RegExp&&(a.lastIndex=0);for(var n=arguments.length,i=new Array(n>1?n-1:0),e=1;e<n;e++)i[e-1]=arguments[e];return No(o,a,i)}}function Av(o){return function(){for(var a=arguments.length,n=new Array(a),i=0;i<a;i++)n[i]=arguments[i];return Ro(o,n)}}function se(o,a){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:_r;Gs&&Gs(o,null);let i=a.length;for(;i--;){let e=a[i];if(typeof e=="string"){const t=n(e);t!==e&&(bv(a)||(a[i]=t),e=t)}o[e]=!0}return o}function wv(o){for(let a=0;a<o.length;a++)xt(o,a)||(o[a]=null);return o}function Rt(o){const a=tu(null);for(const[n,i]of eu(o))xt(o,n)&&(Array.isArray(i)?a[n]=wv(i):i&&typeof i=="object"&&i.constructor===Object?a[n]=Rt(i):a[n]=i);return a}function Pi(o,a){for(;o!==null;){const i=kv(o,a);if(i){if(i.get)return lt(i.get);if(typeof i.value=="function")return lt(i.value)}o=Cv(o)}function n(){return null}return n}const Vs=st(["a","abbr","acronym","address","area","article","aside","audio","b","bdi","bdo","big","blink","blockquote","body","br","button","canvas","caption","center","cite","code","col","colgroup","content","data","datalist","dd","decorator","del","details","dfn","dialog","dir","div","dl","dt","element","em","fieldset","figcaption","figure","font","footer","form","h1","h2","h3","h4","h5","h6","head","header","hgroup","hr","html","i","img","input","ins","kbd","label","legend","li","main","map","mark","marquee","menu","menuitem","meter","nav","nobr","ol","optgroup","option","output","p","picture","pre","progress","q","rp","rt","ruby","s","samp","section","select","shadow","small","source","spacer","span","strike","strong","style","sub","summary","sup","table","tbody","td","template","textarea","tfoot","th","thead","time","tr","track","tt","u","ul","var","video","wbr"]),uo=st(["svg","a","altglyph","altglyphdef","altglyphitem","animatecolor","animatemotion","animatetransform","circle","clippath","defs","desc","ellipse","filter","font","g","glyph","glyphref","hkern","image","line","lineargradient","marker","mask","metadata","mpath","path","pattern","polygon","polyline","radialgradient","rect","stop","style","switch","symbol","text","textpath","title","tref","tspan","view","vkern"]),co=st(["feBlend","feColorMatrix","feComponentTransfer","feComposite","feConvolveMatrix","feDiffuseLighting","feDisplacementMap","feDistantLight","feDropShadow","feFlood","feFuncA","feFuncB","feFuncG","feFuncR","feGaussianBlur","feImage","feMerge","feMergeNode","feMorphology","feOffset","fePointLight","feSpecularLighting","feSpotLight","feTile","feTurbulence"]),Dv=st(["animate","color-profile","cursor","discard","font-face","font-face-format","font-face-name","font-face-src","font-face-uri","foreignobject","hatch","hatchpath","mesh","meshgradient","meshpatch","meshrow","missing-glyph","script","set","solidcolor","unknown","use"]),ho=st(["math","menclose","merror","mfenced","mfrac","mglyph","mi","mlabeledtr","mmultiscripts","mn","mo","mover","mpadded","mphantom","mroot","mrow","ms","mspace","msqrt","mstyle","msub","msup","msubsup","mtable","mtd","mtext","mtr","munder","munderover","mprescripts"]),Ov=st(["maction","maligngroup","malignmark","mlongdiv","mscarries","mscarry","msgroup","mstack","msline","msrow","semantics","annotation","annotation-xml","mprescripts","none"]),Us=st(["#text"]),Bs=st(["accept","action","align","alt","autocapitalize","autocomplete","autopictureinpicture","autoplay","background","bgcolor","border","capture","cellpadding","cellspacing","checked","cite","class","clear","color","cols","colspan","controls","controlslist","coords","crossorigin","datetime","decoding","default","dir","disabled","disablepictureinpicture","disableremoteplayback","download","draggable","enctype","enterkeyhint","face","for","headers","height","hidden","high","href","hreflang","id","inputmode","integrity","ismap","kind","label","lang","list","loading","loop","low","max","maxlength","media","method","min","minlength","multiple","muted","name","nonce","noshade","novalidate","nowrap","open","optimum","pattern","placeholder","playsinline","popover","popovertarget","popovertargetaction","poster","preload","pubdate","radiogroup","readonly","rel","required","rev","reversed","role","rows","rowspan","spellcheck","scope","selected","shape","size","sizes","span","srclang","start","src","srcset","step","style","summary","tabindex","title","translate","type","usemap","valign","value","width","wrap","xmlns","slot"]),fo=st(["accent-height","accumulate","additive","alignment-baseline","amplitude","ascent","attributename","attributetype","azimuth","basefrequency","baseline-shift","begin","bias","by","class","clip","clippathunits","clip-path","clip-rule","color","color-interpolation","color-interpolation-filters","color-profile","color-rendering","cx","cy","d","dx","dy","diffuseconstant","direction","display","divisor","dur","edgemode","elevation","end","exponent","fill","fill-opacity","fill-rule","filter","filterunits","flood-color","flood-opacity","font-family","font-size","font-size-adjust","font-stretch","font-style","font-variant","font-weight","fx","fy","g1","g2","glyph-name","glyphref","gradientunits","gradienttransform","height","href","id","image-rendering","in","in2","intercept","k","k1","k2","k3","k4","kerning","keypoints","keysplines","keytimes","lang","lengthadjust","letter-spacing","kernelmatrix","kernelunitlength","lighting-color","local","marker-end","marker-mid","marker-start","markerheight","markerunits","markerwidth","maskcontentunits","maskunits","max","mask","media","method","mode","min","name","numoctaves","offset","operator","opacity","order","orient","orientation","origin","overflow","paint-order","path","pathlength","patterncontentunits","patterntransform","patternunits","points","preservealpha","preserveaspectratio","primitiveunits","r","rx","ry","radius","refx","refy","repeatcount","repeatdur","restart","result","rotate","scale","seed","shape-rendering","slope","specularconstant","specularexponent","spreadmethod","startoffset","stddeviation","stitchtiles","stop-color","stop-opacity","stroke-dasharray","stroke-dashoffset","stroke-linecap","stroke-linejoin","stroke-miterlimit","stroke-opacity","stroke","stroke-width","style","surfacescale","systemlanguage","tabindex","tablevalues","targetx","targety","transform","transform-origin","text-anchor","text-decoration","text-rendering","textlength","type","u1","u2","unicode","values","viewbox","visibility","version","vert-adv-y","vert-origin-x","vert-origin-y","width","word-spacing","wrap","writing-mode","xchannelselector","ychannelselector","x","x1","x2","xmlns","y","y1","y2","z","zoomandpan"]),Hs=st(["accent","accentunder","align","bevelled","close","columnsalign","columnlines","columnspan","denomalign","depth","dir","display","displaystyle","encoding","fence","frame","height","href","id","largeop","length","linethickness","lspace","lquote","mathbackground","mathcolor","mathsize","mathvariant","maxsize","minsize","movablelimits","notation","numalign","open","rowalign","rowlines","rowspacing","rowspan","rspace","rquote","scriptlevel","scriptminsize","scriptsizemultiplier","selection","separator","separators","stretchy","subscriptshift","supscriptshift","symmetric","voffset","width","xmlns"]),dr=st(["xlink:href","xml:id","xlink:title","xml:space","xmlns:xlink"]),Mv=Et(/\{\{[\w\W]*|[\w\W]*\}\}/gm),Iv=Et(/<%[\w\W]*|[\w\W]*%>/gm),Lv=Et(/\$\{[\w\W]*/gm),Nv=Et(/^data-[\-\w.\u00B7-\uFFFF]+$/),Rv=Et(/^aria-[\-\w]+$/),nu=Et(/^(?:(?:(?:f|ht)tps?|mailto|tel|callto|sms|cid|xmpp|matrix):|[^a-z]|[a-z+.\-]+(?:[^a-z+.\-:]|$))/i),Gv=Et(/^(?:\w+script|data):/i),Fv=Et(/[\u0000-\u0020\u00A0\u1680\u180E\u2000-\u2029\u205F\u3000]/g),iu=Et(/^html$/i),jv=Et(/^[a-z][.\w]*(-[.\w]+)+$/i);var qs=Object.freeze({__proto__:null,ARIA_ATTR:Rv,ATTR_WHITESPACE:Fv,CUSTOM_ELEMENT:jv,DATA_ATTR:Nv,DOCTYPE_NAME:iu,ERB_EXPR:Iv,IS_ALLOWED_URI:nu,IS_SCRIPT_OR_DATA:Gv,MUSTACHE_EXPR:Mv,TMPLIT_EXPR:Lv});const Ai={element:1,attribute:2,text:3,cdataSection:4,entityReference:5,entityNode:6,progressingInstruction:7,comment:8,document:9,documentType:10,documentFragment:11,notation:12},Vv=function(){return typeof window=="undefined"?null:window},Uv=function(a,n){if(typeof a!="object"||typeof a.createPolicy!="function")return null;let i=null;const e="data-tt-policy-suffix";n&&n.hasAttribute(e)&&(i=n.getAttribute(e));const t="dompurify"+(i?"#"+i:"");try{return a.createPolicy(t,{createHTML(r){return r},createScriptURL(r){return r}})}catch{return console.warn("TrustedTypes policy "+t+" could not be created."),null}},Ys=function(){return{afterSanitizeAttributes:[],afterSanitizeElements:[],afterSanitizeShadowDOM:[],beforeSanitizeAttributes:[],beforeSanitizeElements:[],beforeSanitizeShadowDOM:[],uponSanitizeAttribute:[],uponSanitizeElement:[],uponSanitizeShadowNode:[]}};function ru(){let o=arguments.length>0&&arguments[0]!==void 0?arguments[0]:Vv();const a=X=>ru(X);if(a.version="3.2.6",a.removed=[],!o||!o.document||o.document.nodeType!==Ai.document||!o.Element)return a.isSupported=!1,a;let{document:n}=o;const i=n,e=i.currentScript,{DocumentFragment:t,HTMLTemplateElement:r,Node:s,Element:l,NodeFilter:u,NamedNodeMap:d=o.NamedNodeMap||o.MozNamedAttrMap,HTMLFormElement:h,DOMParser:f,trustedTypes:g}=o,y=l.prototype,_=Pi(y,"cloneNode"),p=Pi(y,"remove"),C=Pi(y,"nextSibling"),b=Pi(y,"childNodes"),m=Pi(y,"parentNode");if(typeof r=="function"){const X=n.createElement("template");X.content&&X.content.ownerDocument&&(n=X.content.ownerDocument)}let S,w="";const{implementation:O,createNodeIterator:I,createDocumentFragment:A,getElementsByTagName:V}=n,{importNode:B}=i;let H=Ys();a.isSupported=typeof eu=="function"&&typeof m=="function"&&O&&O.createHTMLDocument!==void 0;const{MUSTACHE_EXPR:R,ERB_EXPR:he,TMPLIT_EXPR:U,DATA_ATTR:J,ARIA_ATTR:T,IS_SCRIPT_OR_DATA:k,ATTR_WHITESPACE:W,CUSTOM_ELEMENT:ne}=qs;let{IS_ALLOWED_URI:j}=qs,ie=null;const Pe=se({},[...Vs,...uo,...co,...ho,...Us]);let we=null;const bt=se({},[...Bs,...fo,...Hs,...dr]);let Ee=Object.seal(tu(null,{tagNameCheck:{writable:!0,configurable:!1,enumerable:!0,value:null},attributeNameCheck:{writable:!0,configurable:!1,enumerable:!0,value:null},allowCustomizedBuiltInElements:{writable:!0,configurable:!1,enumerable:!0,value:!1}})),Fe=null,nt=null,Tn=!0,on=!0,N=!1,D=!0,M=!1,Ae=!0,fe=!1,Pn=!1,di=!1,Yt=!1,an=!1,sn=!1,hi=!0,ln=!1;const F="user-content-";let z=!0,re=!1,xe={},Se=null;const ge=se({},["annotation-xml","audio","colgroup","desc","foreignobject","head","iframe","math","mi","mn","mo","ms","mtext","noembed","noframes","noscript","plaintext","script","style","svg","template","thead","title","video","xmp"]);let ve=null;const Ne=se({},["audio","video","img","source","image","track"]);let ct=null;const An=se({},["alt","class","for","id","label","name","pattern","placeholder","role","summary","title","value","style","xmlns"]),wn="http://www.w3.org/1998/Math/MathML",Dn="http://www.w3.org/2000/svg",dt="http://www.w3.org/1999/xhtml";let it=dt,Yr=!1,zr=null;const ou=se({},[wn,Dn,dt],lo);let Wi=se({},["mi","mo","mn","ms","mtext"]),Ki=se({},["annotation-xml"]);const au=se({},["title","style","font","a","script"]);let fi=null;const su=["application/xhtml+xml","text/html"],lu="text/html";let qe=null,On=null;const uu=n.createElement("form"),ya=function(x){return x instanceof RegExp||x instanceof Function},$r=function(){let x=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};if(!(On&&On===x)){if((!x||typeof x!="object")&&(x={}),x=Rt(x),fi=su.indexOf(x.PARSER_MEDIA_TYPE)===-1?lu:x.PARSER_MEDIA_TYPE,qe=fi==="application/xhtml+xml"?lo:_r,ie=xt(x,"ALLOWED_TAGS")?se({},x.ALLOWED_TAGS,qe):Pe,we=xt(x,"ALLOWED_ATTR")?se({},x.ALLOWED_ATTR,qe):bt,zr=xt(x,"ALLOWED_NAMESPACES")?se({},x.ALLOWED_NAMESPACES,lo):ou,ct=xt(x,"ADD_URI_SAFE_ATTR")?se(Rt(An),x.ADD_URI_SAFE_ATTR,qe):An,ve=xt(x,"ADD_DATA_URI_TAGS")?se(Rt(Ne),x.ADD_DATA_URI_TAGS,qe):Ne,Se=xt(x,"FORBID_CONTENTS")?se({},x.FORBID_CONTENTS,qe):ge,Fe=xt(x,"FORBID_TAGS")?se({},x.FORBID_TAGS,qe):Rt({}),nt=xt(x,"FORBID_ATTR")?se({},x.FORBID_ATTR,qe):Rt({}),xe=xt(x,"USE_PROFILES")?x.USE_PROFILES:!1,Tn=x.ALLOW_ARIA_ATTR!==!1,on=x.ALLOW_DATA_ATTR!==!1,N=x.ALLOW_UNKNOWN_PROTOCOLS||!1,D=x.ALLOW_SELF_CLOSE_IN_ATTR!==!1,M=x.SAFE_FOR_TEMPLATES||!1,Ae=x.SAFE_FOR_XML!==!1,fe=x.WHOLE_DOCUMENT||!1,Yt=x.RETURN_DOM||!1,an=x.RETURN_DOM_FRAGMENT||!1,sn=x.RETURN_TRUSTED_TYPE||!1,di=x.FORCE_BODY||!1,hi=x.SANITIZE_DOM!==!1,ln=x.SANITIZE_NAMED_PROPS||!1,z=x.KEEP_CONTENT!==!1,re=x.IN_PLACE||!1,j=x.ALLOWED_URI_REGEXP||nu,it=x.NAMESPACE||dt,Wi=x.MATHML_TEXT_INTEGRATION_POINTS||Wi,Ki=x.HTML_INTEGRATION_POINTS||Ki,Ee=x.CUSTOM_ELEMENT_HANDLING||{},x.CUSTOM_ELEMENT_HANDLING&&ya(x.CUSTOM_ELEMENT_HANDLING.tagNameCheck)&&(Ee.tagNameCheck=x.CUSTOM_ELEMENT_HANDLING.tagNameCheck),x.CUSTOM_ELEMENT_HANDLING&&ya(x.CUSTOM_ELEMENT_HANDLING.attributeNameCheck)&&(Ee.attributeNameCheck=x.CUSTOM_ELEMENT_HANDLING.attributeNameCheck),x.CUSTOM_ELEMENT_HANDLING&&typeof x.CUSTOM_ELEMENT_HANDLING.allowCustomizedBuiltInElements=="boolean"&&(Ee.allowCustomizedBuiltInElements=x.CUSTOM_ELEMENT_HANDLING.allowCustomizedBuiltInElements),M&&(on=!1),an&&(Yt=!0),xe&&(ie=se({},Us),we=[],xe.html===!0&&(se(ie,Vs),se(we,Bs)),xe.svg===!0&&(se(ie,uo),se(we,fo),se(we,dr)),xe.svgFilters===!0&&(se(ie,co),se(we,fo),se(we,dr)),xe.mathMl===!0&&(se(ie,ho),se(we,Hs),se(we,dr))),x.ADD_TAGS&&(ie===Pe&&(ie=Rt(ie)),se(ie,x.ADD_TAGS,qe)),x.ADD_ATTR&&(we===bt&&(we=Rt(we)),se(we,x.ADD_ATTR,qe)),x.ADD_URI_SAFE_ATTR&&se(ct,x.ADD_URI_SAFE_ATTR,qe),x.FORBID_CONTENTS&&(Se===ge&&(Se=Rt(Se)),se(Se,x.FORBID_CONTENTS,qe)),z&&(ie["#text"]=!0),fe&&se(ie,["html","head","body"]),ie.table&&(se(ie,["tbody"]),delete Fe.tbody),x.TRUSTED_TYPES_POLICY){if(typeof x.TRUSTED_TYPES_POLICY.createHTML!="function")throw Ti('TRUSTED_TYPES_POLICY configuration option must provide a "createHTML" hook.');if(typeof x.TRUSTED_TYPES_POLICY.createScriptURL!="function")throw Ti('TRUSTED_TYPES_POLICY configuration option must provide a "createScriptURL" hook.');S=x.TRUSTED_TYPES_POLICY,w=S.createHTML("")}else S===void 0&&(S=Uv(g,e)),S!==null&&typeof w=="string"&&(w=S.createHTML(""));st&&st(x),On=x}},ma=se({},[...uo,...co,...Dv]),_a=se({},[...ho,...Ov]),cu=function(x){let L=m(x);(!L||!L.tagName)&&(L={namespaceURI:it,tagName:"template"});const q=_r(x.tagName),De=_r(L.tagName);return zr[x.namespaceURI]?x.namespaceURI===Dn?L.namespaceURI===dt?q==="svg":L.namespaceURI===wn?q==="svg"&&(De==="annotation-xml"||Wi[De]):Boolean(ma[q]):x.namespaceURI===wn?L.namespaceURI===dt?q==="math":L.namespaceURI===Dn?q==="math"&&Ki[De]:Boolean(_a[q]):x.namespaceURI===dt?L.namespaceURI===Dn&&!Ki[De]||L.namespaceURI===wn&&!Wi[De]?!1:!_a[q]&&(au[q]||!ma[q]):!!(fi==="application/xhtml+xml"&&zr[x.namespaceURI]):!1},Pt=function(x){xi(a.removed,{element:x});try{m(x).removeChild(x)}catch{p(x)}},Mn=function(x,L){try{xi(a.removed,{attribute:L.getAttributeNode(x),from:L})}catch{xi(a.removed,{attribute:null,from:L})}if(L.removeAttribute(x),x==="is")if(Yt||an)try{Pt(L)}catch{}else try{L.setAttribute(x,"")}catch{}},Ea=function(x){let L=null,q=null;if(di)x="<remove></remove>"+x;else{const je=js(x,/^[\r\n\t ]+/);q=je&&je[0]}fi==="application/xhtml+xml"&&it===dt&&(x='<html xmlns="http://www.w3.org/1999/xhtml"><head></head><body>'+x+"</body></html>");const De=S?S.createHTML(x):x;if(it===dt)try{L=new f().parseFromString(De,fi)}catch{}if(!L||!L.documentElement){L=O.createDocument(it,"template",null);try{L.documentElement.innerHTML=Yr?w:De}catch{}}const Je=L.body||L.documentElement;return x&&q&&Je.insertBefore(n.createTextNode(q),Je.childNodes[0]||null),it===dt?V.call(L,fe?"html":"body")[0]:fe?L.documentElement:Je},ba=function(x){return I.call(x.ownerDocument||x,x,u.SHOW_ELEMENT|u.SHOW_COMMENT|u.SHOW_TEXT|u.SHOW_PROCESSING_INSTRUCTION|u.SHOW_CDATA_SECTION,null)},Xr=function(x){return x instanceof h&&(typeof x.nodeName!="string"||typeof x.textContent!="string"||typeof x.removeChild!="function"||!(x.attributes instanceof d)||typeof x.removeAttribute!="function"||typeof x.setAttribute!="function"||typeof x.namespaceURI!="string"||typeof x.insertBefore!="function"||typeof x.hasChildNodes!="function")},Ca=function(x){return typeof s=="function"&&x instanceof s};function It(X,x,L){cr(X,q=>{q.call(a,x,L,On)})}const ka=function(x){let L=null;if(It(H.beforeSanitizeElements,x,null),Xr(x))return Pt(x),!0;const q=qe(x.nodeName);if(It(H.uponSanitizeElement,x,{tagName:q,allowedTags:ie}),Ae&&x.hasChildNodes()&&!Ca(x.firstElementChild)&&rt(/<[/\w!]/g,x.innerHTML)&&rt(/<[/\w!]/g,x.textContent)||x.nodeType===Ai.progressingInstruction||Ae&&x.nodeType===Ai.comment&&rt(/<[/\w]/g,x.data))return Pt(x),!0;if(!ie[q]||Fe[q]){if(!Fe[q]&&Sa(q)&&(Ee.tagNameCheck instanceof RegExp&&rt(Ee.tagNameCheck,q)||Ee.tagNameCheck instanceof Function&&Ee.tagNameCheck(q)))return!1;if(z&&!Se[q]){const De=m(x)||x.parentNode,Je=b(x)||x.childNodes;if(Je&&De){const je=Je.length;for(let ut=je-1;ut>=0;--ut){const Lt=_(Je[ut],!0);Lt.__removalCount=(x.__removalCount||0)+1,De.insertBefore(Lt,C(x))}}}return Pt(x),!0}return x instanceof l&&!cu(x)||(q==="noscript"||q==="noembed"||q==="noframes")&&rt(/<\/no(script|embed|frames)/i,x.innerHTML)?(Pt(x),!0):(M&&x.nodeType===Ai.text&&(L=x.textContent,cr([R,he,U],De=>{L=Si(L,De," ")}),x.textContent!==L&&(xi(a.removed,{element:x.cloneNode()}),x.textContent=L)),It(H.afterSanitizeElements,x,null),!1)},xa=function(x,L,q){if(hi&&(L==="id"||L==="name")&&(q in n||q in uu))return!1;if(!(on&&!nt[L]&&rt(J,L))){if(!(Tn&&rt(T,L))){if(!we[L]||nt[L]){if(!(Sa(x)&&(Ee.tagNameCheck instanceof RegExp&&rt(Ee.tagNameCheck,x)||Ee.tagNameCheck instanceof Function&&Ee.tagNameCheck(x))&&(Ee.attributeNameCheck instanceof RegExp&&rt(Ee.attributeNameCheck,L)||Ee.attributeNameCheck instanceof Function&&Ee.attributeNameCheck(L))||L==="is"&&Ee.allowCustomizedBuiltInElements&&(Ee.tagNameCheck instanceof RegExp&&rt(Ee.tagNameCheck,q)||Ee.tagNameCheck instanceof Function&&Ee.tagNameCheck(q))))return!1}else if(!ct[L]){if(!rt(j,Si(q,W,""))){if(!((L==="src"||L==="xlink:href"||L==="href")&&x!=="script"&&Tv(q,"data:")===0&&ve[x])){if(!(N&&!rt(k,Si(q,W,"")))){if(q)return!1}}}}}}return!0},Sa=function(x){return x!=="annotation-xml"&&js(x,ne)},Ta=function(x){It(H.beforeSanitizeAttributes,x,null);const{attributes:L}=x;if(!L||Xr(x))return;const q={attrName:"",attrValue:"",keepAttr:!0,allowedAttributes:we,forceKeepAttr:void 0};let De=L.length;for(;De--;){const Je=L[De],{name:je,namespaceURI:ut,value:Lt}=Je,vi=qe(je),Wr=Lt;let Ze=je==="value"?Wr:Pv(Wr);if(q.attrName=vi,q.attrValue=Ze,q.keepAttr=!0,q.forceKeepAttr=void 0,It(H.uponSanitizeAttribute,x,q),Ze=q.attrValue,ln&&(vi==="id"||vi==="name")&&(Mn(je,x),Ze=F+Ze),Ae&&rt(/((--!?|])>)|<\/(style|title)/i,Ze)){Mn(je,x);continue}if(q.forceKeepAttr)continue;if(!q.keepAttr){Mn(je,x);continue}if(!D&&rt(/\/>/i,Ze)){Mn(je,x);continue}M&&cr([R,he,U],Aa=>{Ze=Si(Ze,Aa," ")});const Pa=qe(x.nodeName);if(!xa(Pa,vi,Ze)){Mn(je,x);continue}if(S&&typeof g=="object"&&typeof g.getAttributeType=="function"&&!ut)switch(g.getAttributeType(Pa,vi)){case"TrustedHTML":{Ze=S.createHTML(Ze);break}case"TrustedScriptURL":{Ze=S.createScriptURL(Ze);break}}if(Ze!==Wr)try{ut?x.setAttributeNS(ut,je,Ze):x.setAttribute(je,Ze),Xr(x)?Pt(x):Fs(a.removed)}catch{Mn(je,x)}}It(H.afterSanitizeAttributes,x,null)},du=function X(x){let L=null;const q=ba(x);for(It(H.beforeSanitizeShadowDOM,x,null);L=q.nextNode();)It(H.uponSanitizeShadowNode,L,null),ka(L),Ta(L),L.content instanceof t&&X(L.content);It(H.afterSanitizeShadowDOM,x,null)};return a.sanitize=function(X){let x=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},L=null,q=null,De=null,Je=null;if(Yr=!X,Yr&&(X="<!-->"),typeof X!="string"&&!Ca(X))if(typeof X.toString=="function"){if(X=X.toString(),typeof X!="string")throw Ti("dirty is not a string, aborting")}else throw Ti("toString is not a function");if(!a.isSupported)return X;if(Pn||$r(x),a.removed=[],typeof X=="string"&&(re=!1),re){if(X.nodeName){const Lt=qe(X.nodeName);if(!ie[Lt]||Fe[Lt])throw Ti("root node is forbidden and cannot be sanitized in-place")}}else if(X instanceof s)L=Ea("<!---->"),q=L.ownerDocument.importNode(X,!0),q.nodeType===Ai.element&&q.nodeName==="BODY"||q.nodeName==="HTML"?L=q:L.appendChild(q);else{if(!Yt&&!M&&!fe&&X.indexOf("<")===-1)return S&&sn?S.createHTML(X):X;if(L=Ea(X),!L)return Yt?null:sn?w:""}L&&di&&Pt(L.firstChild);const je=ba(re?X:L);for(;De=je.nextNode();)ka(De),Ta(De),De.content instanceof t&&du(De.content);if(re)return X;if(Yt){if(an)for(Je=A.call(L.ownerDocument);L.firstChild;)Je.appendChild(L.firstChild);else Je=L;return(we.shadowroot||we.shadowrootmode)&&(Je=B.call(i,Je,!0)),Je}let ut=fe?L.outerHTML:L.innerHTML;return fe&&ie["!doctype"]&&L.ownerDocument&&L.ownerDocument.doctype&&L.ownerDocument.doctype.name&&rt(iu,L.ownerDocument.doctype.name)&&(ut="<!DOCTYPE "+L.ownerDocument.doctype.name+`>
`+ut),M&&cr([R,he,U],Lt=>{ut=Si(ut,Lt," ")}),S&&sn?S.createHTML(ut):ut},a.setConfig=function(){let X=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};$r(X),Pn=!0},a.clearConfig=function(){On=null,Pn=!1},a.isValidAttribute=function(X,x,L){On||$r({});const q=qe(X),De=qe(x);return xa(q,De,L)},a.addHook=function(X,x){typeof x=="function"&&xi(H[X],x)},a.removeHook=function(X,x){if(x!==void 0){const L=xv(H[X],x);return L===-1?void 0:Sv(H[X],L,1)[0]}return Fs(H[X])},a.removeHooks=function(X){H[X]=[]},a.removeAllHooks=function(){H=Ys()},a}var ga=ru();const Bv={class:"read-csv-container"},Hv={class:"row items-center q-gutter-sm q-mb-sm"},qv={key:0,class:"file-metadata q-mb-sm"},Yv={key:1,class:"text-center q-pa-lg"},zv={key:2,class:"text-center q-pa-lg text-grey-5"},$v={key:1,class:"table-container q-mt-sm"},Xv=["innerHTML"],Wv={key:2,class:"stats-container q-mt-sm"},Kv={__name:"ReadCSV",props:{nodeItemId:Number},setup(o){var U,J;const a=o,n=jr(),i=zi(),e=jo(),t=Vo(),r=te(!1),s=te(null),l=te(""),u=te(!1),d=te(!1),h=te({file_id:null,node_item_id:a.nodeItemId}),f=Y(()=>i.node_items.find(T=>T.id===a.nodeItemId));(J=(U=f.value)==null?void 0:U.formData)!=null&&J.file_id&&(h.value.file_id=f.value.formData.file_id);const g=Y(()=>t.userId),y=Y(()=>e.documents),_=Y(()=>Number(g.value)),p=T=>{if(!T)return"";const k=T.split(".");return k.length>1?k.pop().toLowerCase():""},C=Y(()=>y.value.filter(T=>{const k=p(T.file);return T.uploaded_by_user===_.value&&T.collection===4&&k==="csv"}));$e(s,T=>{T?(h.value.file_id=T.id,l.value=T.title):(h.value.file_id=null,l.value="")}),$e(()=>{var T,k;return(k=(T=f.value)==null?void 0:T.formData)==null?void 0:k.file_id},T=>{if(T&&C.value.length>0){const k=C.value.find(W=>W.id===T);k&&(s.value=k,l.value=k.title)}},{immediate:!0});const b=Y(()=>{var T,k;return(k=(T=f.value)==null?void 0:T.response_data)!=null&&k.html_table?ga.sanitize(f.value.response_data.html_table):""}),m=T=>T?Ho.formatDate(T,"MMM DD, YYYY HH:mm"):"",S=T=>{if(!T||T===0)return"0 Bytes";const k=1024,W=["Bytes","KB","MB","GB"],ne=Math.floor(Math.log(T)/Math.log(k));return`${parseFloat((T/k**ne).toFixed(2))} ${W[ne]}`},w=T=>{const k=p(T);return{json:"mdi-code-json",csv:"mdi-file-delimited",xls:"mdi-file-excel",xlsx:"mdi-file-excel"}[k]||"mdi-file-document-outline"},O=async()=>{u.value=!0;try{await e.fetchDocuments()}catch{n.notify({type:"negative",message:"Failed to load documents"})}finally{u.value=!1}},I=T=>{s.value=T},A=()=>{s.value&&(h.value.file_id=s.value.id,l.value=s.value.title)},V=()=>{s.value=null,h.value.file_id=null,l.value=""},B=()=>({url:`${yn.defaults.baseURL}content_api/documents/`,method:"POST",fieldName:"file",formFields:[{name:"collection",value:4}],headers:[{name:"Authorization",value:`Bearer ${t.token.access}`},{name:"Accept",value:"application/json"}]}),H=T=>{n.notify({type:"positive",message:"File uploaded successfully"}),O().then(()=>{var W,ne;const k=(W=T==null?void 0:T.xhr)!=null&&W.response?(ne=JSON.parse(T.xhr.response))==null?void 0:ne.id:null;if(k){const j=C.value.find(ie=>ie.id===k);j&&(s.value=j,A())}})},R=()=>{n.notify({type:"negative",message:"Upload failed. Please try again."})};$e(r,T=>{T&&O()});async function he(){if(!s.value){n.notify({type:"warning",message:"Please select a file first"});return}d.value=!0;try{f.value.formData=h.value,await i.editNodeItemFormData(f.value),n.notify({type:"positive",message:"File sent successfully"})}catch{n.notify({type:"negative",message:"Failed to send file"})}finally{d.value=!1}}return ui(()=>{O()}),(T,k)=>{var W,ne;return G(),ee("div",Bv,[oe("div",Hv,[E(Ve,{modelValue:l.value,"onUpdate:modelValue":k[0]||(k[0]=j=>l.value=j),label:"CSV File",readonly:"",filled:"",dense:"",class:"col",placeholder:s.value?l.value:"Select CSV file"},{prepend:P(()=>[E(Ge,{name:s.value?w(s.value.file):"mdi-file-document-outline"},null,8,["name"])]),append:P(()=>[s.value?(G(),ye(ae,{key:0,flat:"",dense:"",round:"",icon:"close",onClick:V,size:"sm"})):ke("",!0)]),_:1},8,["modelValue","placeholder"]),E(ae,{color:"primary",label:"Select File",icon:"folder",onClick:k[1]||(k[1]=j=>r.value=!0),dense:"",unelevated:""}),E(ae,{color:"positive",label:"Send",icon:"send",disable:!s.value,onClick:he,dense:"",unelevated:"",loading:d.value},null,8,["disable","loading"])]),s.value?(G(),ee("div",qv,[E(Vt,{dense:"",icon:w(s.value.file),label:S(s.value.file_size),color:"grey-8","text-color":"white",size:"sm"},null,8,["icon","label"]),E(Vt,{dense:"",icon:"schedule",label:m(s.value.created_at),color:"grey-8","text-color":"white",size:"sm",class:"q-ml-xs"},null,8,["label"])])):ke("",!0),E(Yi,{modelValue:r.value,"onUpdate:modelValue":k[2]||(k[2]=j=>r.value=j),maximized:""},{default:P(()=>[E(tt,{dark:"",class:"file-picker-dialog"},{default:P(()=>[E(Ue,{class:"row items-center q-pb-none"},{default:P(()=>[k[3]||(k[3]=oe("div",{class:"text-h6"},"Select or Upload CSV File",-1)),E(ai),Xe(E(ae,{icon:"close",flat:"",round:"",dense:""},null,512),[[St]])]),_:1,__:[3]}),E(Ue,null,{default:P(()=>[E(tt,{flat:"",bordered:"",class:"q-mb-md"},{default:P(()=>[E(Ue,null,{default:P(()=>[k[4]||(k[4]=oe("div",{class:"text-subtitle2 q-mb-sm"},"Upload New File",-1)),E(Bo,{label:"Upload CSV file","auto-upload":"",accept:".csv","field-name":"file",factory:B,onUploaded:H,onFailed:R,flat:"",bordered:"",dark:"",class:"full-width"})]),_:1,__:[4]})]),_:1}),E(tt,{flat:"",bordered:""},{default:P(()=>[E(Ue,null,{default:P(()=>[k[7]||(k[7]=oe("div",{class:"text-subtitle2 q-mb-sm"},"Select Existing File",-1)),!u.value&&C.value.length>0?(G(),ye(Ut,{key:0,separator:"",dark:""},{default:P(()=>[(G(!0),ee(mt,null,_t(C.value,j=>{var ie;return Xe((G(),ye(Qe,{key:j.id,clickable:"",active:((ie=s.value)==null?void 0:ie.id)===j.id,"active-class":"bg-primary",onClick:Pe=>I(j)},{default:P(()=>[E(be,{avatar:""},{default:P(()=>[E(Ge,{name:w(j.file),size:"md"},null,8,["name"])]),_:2},1024),E(be,null,{default:P(()=>[E(pe,null,{default:P(()=>[de(Ce(j.title),1)]),_:2},1024),E(pe,{caption:""},{default:P(()=>[de(Ce(S(j.file_size))+" \u2022 "+Ce(m(j.created_at)),1)]),_:2},1024)]),_:2},1024),E(be,{side:""},{default:P(()=>{var Pe;return[((Pe=s.value)==null?void 0:Pe.id)===j.id?(G(),ye(Ge,{key:0,name:"check_circle",color:"positive"})):ke("",!0)]}),_:2},1024)]),_:2},1032,["active","onClick"])),[[Qn]])}),128))]),_:1})):u.value?(G(),ee("div",Yv,[E(Uo,{color:"primary",size:"3em"}),k[5]||(k[5]=oe("div",{class:"q-mt-md"},"Loading files...",-1))])):(G(),ee("div",zv,[E(Ge,{name:"folder_off",size:"3em"}),k[6]||(k[6]=oe("div",{class:"q-mt-md"},"No CSV files found. Upload one to get started.",-1))]))]),_:1,__:[7]})]),_:1})]),_:1}),E(Fr,{align:"right"},{default:P(()=>[Xe(E(ae,{flat:"",label:"Cancel"},null,512),[[St]]),Xe(E(ae,{color:"primary",label:"Select",disable:!s.value,onClick:A},null,8,["disable"]),[[St]])]),_:1})]),_:1})]),_:1},8,["modelValue"]),(W=f.value.response_data)!=null&&W.html_table?(G(),ee("div",$v,[oe("div",{innerHTML:b.value},null,8,Xv)])):ke("",!0),(ne=f.value.response_data)!=null&&ne.stats?(G(),ee("div",Wv,[E(Ut,{dense:"",bordered:"",separator:"",dark:""},{default:P(()=>{var j;return[E(Qe,null,{default:P(()=>[E(be,null,{default:P(()=>[E(pe,{class:"text-weight-bold"},{default:P(()=>k[8]||(k[8]=[de("Dataset Statistics")])),_:1,__:[8]})]),_:1})]),_:1}),E(Qe,null,{default:P(()=>[E(be,null,{default:P(()=>[E(pe,{caption:""},{default:P(()=>k[9]||(k[9]=[de("Rows")])),_:1,__:[9]}),E(pe,null,{default:P(()=>[de(Ce(f.value.response_data.stats.rows),1)]),_:1})]),_:1}),E(be,null,{default:P(()=>[E(pe,{caption:""},{default:P(()=>k[10]||(k[10]=[de("Columns")])),_:1,__:[10]}),E(pe,null,{default:P(()=>[de(Ce(f.value.response_data.stats.columns),1)]),_:1})]),_:1})]),_:1}),(j=f.value.response_data.stats.column_names)!=null&&j.length?(G(),ye(Qe,{key:0},{default:P(()=>[E(be,null,{default:P(()=>[E(pe,{caption:""},{default:P(()=>k[11]||(k[11]=[de("Column Names")])),_:1,__:[11]}),E(pe,{class:"text-caption"},{default:P(()=>[de(Ce(f.value.response_data.stats.column_names.join(", ")),1)]),_:1})]),_:1})]),_:1})):ke("",!0)]}),_:1})])):ke("",!0)])}}};var Qv=Vr(Kv,[["__scopeId","data-v-a6c0e05e"]]);const Jv={class:"read-excel-container"},Zv={class:"row items-center q-gutter-sm q-mb-sm"},ep={key:0,class:"file-metadata q-mb-sm"},tp={key:1,class:"text-center q-pa-lg"},np={key:2,class:"text-center q-pa-lg text-grey-5"},ip={key:1,class:"table-container q-mt-sm"},rp=["innerHTML"],op={key:2,class:"stats-container q-mt-sm"},ap={__name:"ReadExcel",props:{nodeItemId:Number},setup(o){var U,J;const a=o,n=jr(),i=zi(),e=jo(),t=Vo(),r=te(!1),s=te(null),l=te(""),u=te(!1),d=te(!1),h=te({file_id:null,node_item_id:a.nodeItemId}),f=Y(()=>i.node_items.find(T=>T.id===a.nodeItemId));(J=(U=f.value)==null?void 0:U.formData)!=null&&J.file_id&&(h.value.file_id=f.value.formData.file_id);const g=Y(()=>t.userId),y=Y(()=>e.documents),_=Y(()=>Number(g.value)),p=T=>{if(!T)return"";const k=T.split(".");return k.length>1?k.pop().toLowerCase():""},C=Y(()=>y.value.filter(T=>{const k=p(T.file);return T.uploaded_by_user===_.value&&T.collection===4&&(k==="xlsx"||k==="xls")}));$e(s,T=>{T?(h.value.file_id=T.id,l.value=T.title):(h.value.file_id=null,l.value="")}),$e(()=>{var T,k;return(k=(T=f.value)==null?void 0:T.formData)==null?void 0:k.file_id},T=>{if(T&&C.value.length>0){const k=C.value.find(W=>W.id===T);k&&(s.value=k,l.value=k.title)}},{immediate:!0});const b=Y(()=>{var T,k;return(k=(T=f.value)==null?void 0:T.response_data)!=null&&k.html_table?ga.sanitize(f.value.response_data.html_table):""}),m=T=>T?Ho.formatDate(T,"MMM DD, YYYY HH:mm"):"",S=T=>{if(!T||T===0)return"0 Bytes";const k=1024,W=["Bytes","KB","MB","GB"],ne=Math.floor(Math.log(T)/Math.log(k));return`${parseFloat((T/k**ne).toFixed(2))} ${W[ne]}`},w=T=>{const k=p(T);return{json:"mdi-code-json",csv:"mdi-file-delimited",xls:"mdi-file-excel",xlsx:"mdi-file-excel"}[k]||"mdi-file-document-outline"},O=async()=>{u.value=!0;try{await e.fetchDocuments()}catch{n.notify({type:"negative",message:"Failed to load documents"})}finally{u.value=!1}},I=T=>{s.value=T},A=()=>{s.value&&(h.value.file_id=s.value.id,l.value=s.value.title)},V=()=>{s.value=null,h.value.file_id=null,l.value=""},B=()=>({url:`${yn.defaults.baseURL}content_api/documents/`,method:"POST",fieldName:"file",formFields:[{name:"collection",value:4}],headers:[{name:"Authorization",value:`Bearer ${t.token.access}`},{name:"Accept",value:"application/json"}]}),H=T=>{n.notify({type:"positive",message:"File uploaded successfully"}),O().then(()=>{var W,ne;const k=(W=T==null?void 0:T.xhr)!=null&&W.response?(ne=JSON.parse(T.xhr.response))==null?void 0:ne.id:null;if(k){const j=C.value.find(ie=>ie.id===k);j&&(s.value=j,A())}})},R=()=>{n.notify({type:"negative",message:"Upload failed. Please try again."})};$e(r,T=>{T&&O()});async function he(){if(!s.value){n.notify({type:"warning",message:"Please select a file first"});return}d.value=!0;try{f.value.formData=h.value,await i.editNodeItemFormData(f.value),n.notify({type:"positive",message:"File sent successfully"})}catch{n.notify({type:"negative",message:"Failed to send file"})}finally{d.value=!1}}return ui(()=>{O()}),(T,k)=>{var W,ne;return G(),ee("div",Jv,[oe("div",Zv,[E(Ve,{modelValue:l.value,"onUpdate:modelValue":k[0]||(k[0]=j=>l.value=j),label:"Excel File",readonly:"",filled:"",dense:"",class:"col",placeholder:s.value?l.value:"Select Excel file"},{prepend:P(()=>[E(Ge,{name:s.value?w(s.value.file):"mdi-file-document-outline"},null,8,["name"])]),append:P(()=>[s.value?(G(),ye(ae,{key:0,flat:"",dense:"",round:"",icon:"close",onClick:V,size:"sm"})):ke("",!0)]),_:1},8,["modelValue","placeholder"]),E(ae,{color:"primary",label:"Select File",icon:"folder",onClick:k[1]||(k[1]=j=>r.value=!0),dense:"",unelevated:""}),E(ae,{color:"positive",label:"Send",icon:"send",disable:!s.value,onClick:he,dense:"",unelevated:"",loading:d.value},null,8,["disable","loading"])]),s.value?(G(),ee("div",ep,[E(Vt,{dense:"",icon:w(s.value.file),label:S(s.value.file_size),color:"grey-8","text-color":"white",size:"sm"},null,8,["icon","label"]),E(Vt,{dense:"",icon:"schedule",label:m(s.value.created_at),color:"grey-8","text-color":"white",size:"sm",class:"q-ml-xs"},null,8,["label"])])):ke("",!0),E(Yi,{modelValue:r.value,"onUpdate:modelValue":k[2]||(k[2]=j=>r.value=j),maximized:""},{default:P(()=>[E(tt,{dark:"",class:"file-picker-dialog"},{default:P(()=>[E(Ue,{class:"row items-center q-pb-none"},{default:P(()=>[k[3]||(k[3]=oe("div",{class:"text-h6"},"Select or Upload Excel File",-1)),E(ai),Xe(E(ae,{icon:"close",flat:"",round:"",dense:""},null,512),[[St]])]),_:1,__:[3]}),E(Ue,null,{default:P(()=>[E(tt,{flat:"",bordered:"",class:"q-mb-md"},{default:P(()=>[E(Ue,null,{default:P(()=>[k[4]||(k[4]=oe("div",{class:"text-subtitle2 q-mb-sm"},"Upload New File",-1)),E(Bo,{label:"Upload Excel file","auto-upload":"",accept:".xlsx,.xls","field-name":"file",factory:B,onUploaded:H,onFailed:R,flat:"",bordered:"",dark:"",class:"full-width"})]),_:1,__:[4]})]),_:1}),E(tt,{flat:"",bordered:""},{default:P(()=>[E(Ue,null,{default:P(()=>[k[7]||(k[7]=oe("div",{class:"text-subtitle2 q-mb-sm"},"Select Existing File",-1)),!u.value&&C.value.length>0?(G(),ye(Ut,{key:0,separator:"",dark:""},{default:P(()=>[(G(!0),ee(mt,null,_t(C.value,j=>{var ie;return Xe((G(),ye(Qe,{key:j.id,clickable:"",active:((ie=s.value)==null?void 0:ie.id)===j.id,"active-class":"bg-primary",onClick:Pe=>I(j)},{default:P(()=>[E(be,{avatar:""},{default:P(()=>[E(Ge,{name:w(j.file),size:"md"},null,8,["name"])]),_:2},1024),E(be,null,{default:P(()=>[E(pe,null,{default:P(()=>[de(Ce(j.title),1)]),_:2},1024),E(pe,{caption:""},{default:P(()=>[de(Ce(S(j.file_size))+" \u2022 "+Ce(m(j.created_at)),1)]),_:2},1024)]),_:2},1024),E(be,{side:""},{default:P(()=>{var Pe;return[((Pe=s.value)==null?void 0:Pe.id)===j.id?(G(),ye(Ge,{key:0,name:"check_circle",color:"positive"})):ke("",!0)]}),_:2},1024)]),_:2},1032,["active","onClick"])),[[Qn]])}),128))]),_:1})):u.value?(G(),ee("div",tp,[E(Uo,{color:"primary",size:"3em"}),k[5]||(k[5]=oe("div",{class:"q-mt-md"},"Loading files...",-1))])):(G(),ee("div",np,[E(Ge,{name:"folder_off",size:"3em"}),k[6]||(k[6]=oe("div",{class:"q-mt-md"},"No Excel files found. Upload one to get started.",-1))]))]),_:1,__:[7]})]),_:1})]),_:1}),E(Fr,{align:"right"},{default:P(()=>[Xe(E(ae,{flat:"",label:"Cancel"},null,512),[[St]]),Xe(E(ae,{color:"primary",label:"Select",disable:!s.value,onClick:A},null,8,["disable"]),[[St]])]),_:1})]),_:1})]),_:1},8,["modelValue"]),(W=f.value.response_data)!=null&&W.html_table?(G(),ee("div",ip,[oe("div",{innerHTML:b.value},null,8,rp)])):ke("",!0),(ne=f.value.response_data)!=null&&ne.stats?(G(),ee("div",op,[E(Ut,{dense:"",bordered:"",separator:"",dark:""},{default:P(()=>{var j;return[E(Qe,null,{default:P(()=>[E(be,null,{default:P(()=>[E(pe,{class:"text-weight-bold"},{default:P(()=>k[8]||(k[8]=[de("Dataset Statistics")])),_:1,__:[8]})]),_:1})]),_:1}),E(Qe,null,{default:P(()=>[E(be,null,{default:P(()=>[E(pe,{caption:""},{default:P(()=>k[9]||(k[9]=[de("Rows")])),_:1,__:[9]}),E(pe,null,{default:P(()=>[de(Ce(f.value.response_data.stats.rows),1)]),_:1})]),_:1}),E(be,null,{default:P(()=>[E(pe,{caption:""},{default:P(()=>k[10]||(k[10]=[de("Columns")])),_:1,__:[10]}),E(pe,null,{default:P(()=>[de(Ce(f.value.response_data.stats.columns),1)]),_:1})]),_:1})]),_:1}),(j=f.value.response_data.stats.column_names)!=null&&j.length?(G(),ye(Qe,{key:0},{default:P(()=>[E(be,null,{default:P(()=>[E(pe,{caption:""},{default:P(()=>k[11]||(k[11]=[de("Column Names")])),_:1,__:[11]}),E(pe,{class:"text-caption"},{default:P(()=>[de(Ce(f.value.response_data.stats.column_names.join(", ")),1)]),_:1})]),_:1})]),_:1})):ke("",!0)]}),_:1})])):ke("",!0)])}}};var sp=Vr(ap,[["__scopeId","data-v-4d4fad81"]]);const lp={class:"read-json-container"},up={class:"row items-center q-gutter-sm q-mb-sm"},cp={key:0,class:"file-metadata q-mb-sm"},dp={key:1,class:"text-center q-pa-lg"},hp={key:2,class:"text-center q-pa-lg text-grey-5"},fp={key:1,class:"table-container q-mt-sm"},vp=["innerHTML"],pp={key:2,class:"stats-container q-mt-sm"},gp={__name:"ReadJSON",props:{nodeItemId:Number},setup(o){var U,J;const a=o,n=jr(),i=zi(),e=jo(),t=Vo(),r=te(!1),s=te(null),l=te(""),u=te(!1),d=te(!1),h=te({file_id:null,node_item_id:a.nodeItemId}),f=Y(()=>i.node_items.find(T=>T.id===a.nodeItemId));(J=(U=f.value)==null?void 0:U.formData)!=null&&J.file_id&&(h.value.file_id=f.value.formData.file_id);const g=Y(()=>t.userId),y=Y(()=>e.documents),_=Y(()=>Number(g.value)),p=T=>{if(!T)return"";const k=T.split(".");return k.length>1?k.pop().toLowerCase():""},C=Y(()=>y.value.filter(T=>{const k=p(T.file);return T.uploaded_by_user===_.value&&T.collection===4&&k==="json"}));$e(s,T=>{T?(h.value.file_id=T.id,l.value=T.title):(h.value.file_id=null,l.value="")}),$e(()=>{var T,k;return(k=(T=f.value)==null?void 0:T.formData)==null?void 0:k.file_id},T=>{if(T&&C.value.length>0){const k=C.value.find(W=>W.id===T);k&&(s.value=k,l.value=k.title)}},{immediate:!0});const b=Y(()=>{var T,k;return(k=(T=f.value)==null?void 0:T.response_data)!=null&&k.html_table?ga.sanitize(f.value.response_data.html_table):""}),m=T=>T?Ho.formatDate(T,"MMM DD, YYYY HH:mm"):"",S=T=>{if(!T||T===0)return"0 Bytes";const k=1024,W=["Bytes","KB","MB","GB"],ne=Math.floor(Math.log(T)/Math.log(k));return`${parseFloat((T/k**ne).toFixed(2))} ${W[ne]}`},w=T=>{const k=p(T);return{json:"mdi-code-json",csv:"mdi-file-delimited",xls:"mdi-file-excel",xlsx:"mdi-file-excel"}[k]||"mdi-file-document-outline"},O=async()=>{u.value=!0;try{await e.fetchDocuments()}catch{n.notify({type:"negative",message:"Failed to load documents"})}finally{u.value=!1}},I=T=>{s.value=T},A=()=>{s.value&&(h.value.file_id=s.value.id,l.value=s.value.title)},V=()=>{s.value=null,h.value.file_id=null,l.value=""},B=()=>({url:`${yn.defaults.baseURL}content_api/documents/`,method:"POST",fieldName:"file",formFields:[{name:"collection",value:4}],headers:[{name:"Authorization",value:`Bearer ${t.token.access}`},{name:"Accept",value:"application/json"}]}),H=T=>{n.notify({type:"positive",message:"File uploaded successfully"}),O().then(()=>{var W,ne;const k=(W=T==null?void 0:T.xhr)!=null&&W.response?(ne=JSON.parse(T.xhr.response))==null?void 0:ne.id:null;if(k){const j=C.value.find(ie=>ie.id===k);j&&(s.value=j,A())}})},R=()=>{n.notify({type:"negative",message:"Upload failed. Please try again."})};$e(r,T=>{T&&O()});async function he(){if(!s.value){n.notify({type:"warning",message:"Please select a file first"});return}d.value=!0;try{f.value.formData=h.value,await i.editNodeItemFormData(f.value),n.notify({type:"positive",message:"File sent successfully"})}catch{n.notify({type:"negative",message:"Failed to send file"})}finally{d.value=!1}}return ui(()=>{O()}),(T,k)=>{var W,ne;return G(),ee("div",lp,[oe("div",up,[E(Ve,{modelValue:l.value,"onUpdate:modelValue":k[0]||(k[0]=j=>l.value=j),label:"JSON File",readonly:"",filled:"",dense:"",class:"col",placeholder:s.value?l.value:"Select JSON file"},{prepend:P(()=>[E(Ge,{name:s.value?w(s.value.file):"mdi-file-document-outline"},null,8,["name"])]),append:P(()=>[s.value?(G(),ye(ae,{key:0,flat:"",dense:"",round:"",icon:"close",onClick:V,size:"sm"})):ke("",!0)]),_:1},8,["modelValue","placeholder"]),E(ae,{color:"primary",label:"Select File",icon:"folder",onClick:k[1]||(k[1]=j=>r.value=!0),dense:"",unelevated:""}),E(ae,{color:"positive",label:"Send",icon:"send",disable:!s.value,onClick:he,dense:"",unelevated:"",loading:d.value},null,8,["disable","loading"])]),s.value?(G(),ee("div",cp,[E(Vt,{dense:"",icon:w(s.value.file),label:S(s.value.file_size),color:"grey-8","text-color":"white",size:"sm"},null,8,["icon","label"]),E(Vt,{dense:"",icon:"schedule",label:m(s.value.created_at),color:"grey-8","text-color":"white",size:"sm",class:"q-ml-xs"},null,8,["label"])])):ke("",!0),E(Yi,{modelValue:r.value,"onUpdate:modelValue":k[2]||(k[2]=j=>r.value=j),maximized:""},{default:P(()=>[E(tt,{dark:"",class:"file-picker-dialog"},{default:P(()=>[E(Ue,{class:"row items-center q-pb-none"},{default:P(()=>[k[3]||(k[3]=oe("div",{class:"text-h6"},"Select or Upload JSON File",-1)),E(ai),Xe(E(ae,{icon:"close",flat:"",round:"",dense:""},null,512),[[St]])]),_:1,__:[3]}),E(Ue,null,{default:P(()=>[E(tt,{flat:"",bordered:"",class:"q-mb-md"},{default:P(()=>[E(Ue,null,{default:P(()=>[k[4]||(k[4]=oe("div",{class:"text-subtitle2 q-mb-sm"},"Upload New File",-1)),E(Bo,{label:"Upload JSON file","auto-upload":"",accept:".json","field-name":"file",factory:B,onUploaded:H,onFailed:R,flat:"",bordered:"",dark:"",class:"full-width"})]),_:1,__:[4]})]),_:1}),E(tt,{flat:"",bordered:""},{default:P(()=>[E(Ue,null,{default:P(()=>[k[7]||(k[7]=oe("div",{class:"text-subtitle2 q-mb-sm"},"Select Existing File",-1)),!u.value&&C.value.length>0?(G(),ye(Ut,{key:0,separator:"",dark:""},{default:P(()=>[(G(!0),ee(mt,null,_t(C.value,j=>{var ie;return Xe((G(),ye(Qe,{key:j.id,clickable:"",active:((ie=s.value)==null?void 0:ie.id)===j.id,"active-class":"bg-primary",onClick:Pe=>I(j)},{default:P(()=>[E(be,{avatar:""},{default:P(()=>[E(Ge,{name:w(j.file),size:"md"},null,8,["name"])]),_:2},1024),E(be,null,{default:P(()=>[E(pe,null,{default:P(()=>[de(Ce(j.title),1)]),_:2},1024),E(pe,{caption:""},{default:P(()=>[de(Ce(S(j.file_size))+" \u2022 "+Ce(m(j.created_at)),1)]),_:2},1024)]),_:2},1024),E(be,{side:""},{default:P(()=>{var Pe;return[((Pe=s.value)==null?void 0:Pe.id)===j.id?(G(),ye(Ge,{key:0,name:"check_circle",color:"positive"})):ke("",!0)]}),_:2},1024)]),_:2},1032,["active","onClick"])),[[Qn]])}),128))]),_:1})):u.value?(G(),ee("div",dp,[E(Uo,{color:"primary",size:"3em"}),k[5]||(k[5]=oe("div",{class:"q-mt-md"},"Loading files...",-1))])):(G(),ee("div",hp,[E(Ge,{name:"folder_off",size:"3em"}),k[6]||(k[6]=oe("div",{class:"q-mt-md"},"No JSON files found. Upload one to get started.",-1))]))]),_:1,__:[7]})]),_:1})]),_:1}),E(Fr,{align:"right"},{default:P(()=>[Xe(E(ae,{flat:"",label:"Cancel"},null,512),[[St]]),Xe(E(ae,{color:"primary",label:"Select",disable:!s.value,onClick:A},null,8,["disable"]),[[St]])]),_:1})]),_:1})]),_:1},8,["modelValue"]),(W=f.value.response_data)!=null&&W.html_table?(G(),ee("div",fp,[oe("div",{innerHTML:b.value},null,8,vp)])):ke("",!0),(ne=f.value.response_data)!=null&&ne.stats?(G(),ee("div",pp,[E(Ut,{dense:"",bordered:"",separator:"",dark:""},{default:P(()=>{var j;return[E(Qe,null,{default:P(()=>[E(be,null,{default:P(()=>[E(pe,{class:"text-weight-bold"},{default:P(()=>k[8]||(k[8]=[de("Dataset Statistics")])),_:1,__:[8]})]),_:1})]),_:1}),E(Qe,null,{default:P(()=>[E(be,null,{default:P(()=>[E(pe,{caption:""},{default:P(()=>k[9]||(k[9]=[de("Rows")])),_:1,__:[9]}),E(pe,null,{default:P(()=>[de(Ce(f.value.response_data.stats.rows),1)]),_:1})]),_:1}),E(be,null,{default:P(()=>[E(pe,{caption:""},{default:P(()=>k[10]||(k[10]=[de("Columns")])),_:1,__:[10]}),E(pe,null,{default:P(()=>[de(Ce(f.value.response_data.stats.columns),1)]),_:1})]),_:1})]),_:1}),(j=f.value.response_data.stats.column_names)!=null&&j.length?(G(),ye(Qe,{key:0},{default:P(()=>[E(be,null,{default:P(()=>[E(pe,{caption:""},{default:P(()=>k[11]||(k[11]=[de("Column Names")])),_:1,__:[11]}),E(pe,{class:"text-caption"},{default:P(()=>[de(Ce(f.value.response_data.stats.column_names.join(", ")),1)]),_:1})]),_:1})]),_:1})):ke("",!0)]}),_:1})])):ke("",!0)])}}};var yp=Vr(gp,[["__scopeId","data-v-371ccdd2"]]);let mp=0;const _p=["click","keydown"],Ep={icon:String,label:[Number,String],alert:[Boolean,String],alertIcon:String,name:{type:[Number,String],default:()=>`t_${mp++}`},noCaps:Boolean,tabindex:[String,Number],disable:Boolean,contentClass:String,ripple:{type:[Boolean,Object],default:!0}};function bp(o,a,n,i){const e=mu(Js,Kr);if(e===Kr)return console.error("QTab/QRouteTab component needs to be child of QTabs"),Kr;const{proxy:t}=si(),r=te(null),s=te(null),l=te(null),u=Y(()=>o.disable===!0||o.ripple===!1?!1:Object.assign({keyCodes:[13,32],early:!0},o.ripple===!0?{}:o.ripple)),d=Y(()=>e.currentModel.value===o.name),h=Y(()=>"q-tab relative-position self-stretch flex flex-center text-center"+(d.value===!0?" q-tab--active"+(e.tabProps.value.activeClass?" "+e.tabProps.value.activeClass:"")+(e.tabProps.value.activeColor?` text-${e.tabProps.value.activeColor}`:"")+(e.tabProps.value.activeBgColor?` bg-${e.tabProps.value.activeBgColor}`:""):" q-tab--inactive")+(o.icon&&o.label&&e.tabProps.value.inlineLabel===!1?" q-tab--full":"")+(o.noCaps===!0||e.tabProps.value.noCaps===!0?" q-tab--no-caps":"")+(o.disable===!0?" disabled":" q-focusable q-hoverable cursor-pointer")+(i!==void 0?i.linkClass.value:"")),f=Y(()=>"q-tab__content self-stretch flex-center relative-position q-anchor--skip non-selectable "+(e.tabProps.value.inlineLabel===!0?"row no-wrap q-tab__content--inline":"column")+(o.contentClass!==void 0?` ${o.contentClass}`:"")),g=Y(()=>o.disable===!0||e.hasFocus.value===!0||d.value===!1&&e.hasActiveTab.value===!0?-1:o.tabindex||0);function y(m,S){var w;if(S!==!0&&(m==null?void 0:m.qAvoidFocus)!==!0&&((w=r.value)==null||w.focus()),o.disable===!0){(i==null?void 0:i.hasRouterLink.value)===!0&&$n(m);return}if(i===void 0){e.updateModel({name:o.name}),n("click",m);return}if(i.hasRouterLink.value===!0){const O=(I={})=>{let A;const V=I.to===void 0||Cu(I.to,o.to)===!0?e.avoidRouteWatcher=Qs():null;return i.navigateToRouterLink(m,{...I,returnRouterError:!0}).catch(B=>{A=B}).then(B=>{var H;if(V===e.avoidRouteWatcher&&(e.avoidRouteWatcher=!1,A===void 0&&(B===void 0||((H=B.message)==null?void 0:H.startsWith("Avoided redundant navigation"))===!0)&&e.updateModel({name:o.name})),I.returnRouterError===!0)return A!==void 0?Promise.reject(A):B})};n("click",m,O),m.defaultPrevented!==!0&&O();return}n("click",m)}function _(m){_u(m,[13,32])?y(m,!0):Eu(m)!==!0&&m.keyCode>=35&&m.keyCode<=40&&m.altKey!==!0&&m.metaKey!==!0&&e.onKbdNavigate(m.keyCode,t.$el)===!0&&$n(m),n("keydown",m)}function p(){const m=e.tabProps.value.narrowIndicator,S=[],w=le("div",{ref:l,class:["q-tab__indicator",e.tabProps.value.indicatorClass]});o.icon!==void 0&&S.push(le(Ge,{class:"q-tab__icon",name:o.icon})),o.label!==void 0&&S.push(le("div",{class:"q-tab__label"},o.label)),o.alert!==!1&&S.push(o.alertIcon!==void 0?le(Ge,{class:"q-tab__alert-icon",color:o.alert!==!0?o.alert:void 0,name:o.alertIcon}):le("div",{class:"q-tab__alert"+(o.alert!==!0?` text-${o.alert}`:"")})),m===!0&&S.push(w);const O=[le("div",{class:"q-focus-helper",tabindex:-1,ref:r}),le("div",{class:f.value},bu(a.default,S))];return m===!1&&O.push(w),O}const C={name:Y(()=>o.name),rootRef:s,tabIndicatorRef:l,routeData:i};Gr(()=>{e.unregisterTab(C)}),ui(()=>{e.registerTab(C)});function b(m,S){const w={ref:s,class:h.value,tabindex:g.value,role:"tab","aria-selected":d.value===!0?"true":"false","aria-disabled":o.disable===!0?"true":void 0,onClick:y,onKeydown:_,...S};return Xe(le(m,w,p()),[[Qn,u.value]])}return{renderTab:b,$tabs:e}}var Bn=rn({name:"QTab",props:Ep,emits:_p,setup(o,{slots:a,emit:n}){const{renderTab:i}=bp(o,a,n);return()=>i("div")}});function Cp(o,a,n){const i=n===!0?["left","right"]:["top","bottom"];return`absolute-${a===!0?i[0]:i[1]}${o?` text-${o}`:""}`}const kp=["left","center","right","justify"];var zs=rn({name:"QTabs",props:{modelValue:[Number,String],align:{type:String,default:"center",validator:o=>kp.includes(o)},breakpoint:{type:[String,Number],default:600},vertical:Boolean,shrink:Boolean,stretch:Boolean,activeClass:String,activeColor:String,activeBgColor:String,indicatorColor:String,leftIcon:String,rightIcon:String,outsideArrows:Boolean,mobileArrows:Boolean,switchIndicator:Boolean,narrowIndicator:Boolean,inlineLabel:Boolean,noCaps:Boolean,dense:Boolean,contentClass:String,"onUpdate:modelValue":[Function,Array]},setup(o,{slots:a,emit:n}){const{proxy:i}=si(),{$q:e}=i,{registerTick:t}=Qr(),{registerTick:r}=Qr(),{registerTick:s}=Qr(),{registerTimeout:l,removeTimeout:u}=vo(),{registerTimeout:d,removeTimeout:h}=vo(),f=te(null),g=te(null),y=te(o.modelValue),_=te(!1),p=te(!0),C=te(!1),b=te(!1),m=[],S=te(0),w=te(!1);let O=null,I=null,A;const V=Y(()=>({activeClass:o.activeClass,activeColor:o.activeColor,activeBgColor:o.activeBgColor,indicatorClass:Cp(o.indicatorColor,o.switchIndicator,o.vertical),narrowIndicator:o.narrowIndicator,inlineLabel:o.inlineLabel,noCaps:o.noCaps})),B=Y(()=>{const F=S.value,z=y.value;for(let re=0;re<F;re++)if(m[re].name.value===z)return!0;return!1}),H=Y(()=>`q-tabs__content--align-${_.value===!0?"left":b.value===!0?"justify":o.align}`),R=Y(()=>`q-tabs row no-wrap items-center q-tabs--${_.value===!0?"":"not-"}scrollable q-tabs--${o.vertical===!0?"vertical":"horizontal"} q-tabs__arrows--${o.outsideArrows===!0?"outside":"inside"} q-tabs--mobile-with${o.mobileArrows===!0?"":"out"}-arrows`+(o.dense===!0?" q-tabs--dense":"")+(o.shrink===!0?" col-shrink":"")+(o.stretch===!0?" self-stretch":"")),he=Y(()=>"q-tabs__content scroll--mobile row no-wrap items-center self-stretch hide-scrollbar relative-position "+H.value+(o.contentClass!==void 0?` ${o.contentClass}`:"")),U=Y(()=>o.vertical===!0?{container:"height",content:"offsetHeight",scroll:"scrollHeight"}:{container:"width",content:"offsetWidth",scroll:"scrollWidth"}),J=Y(()=>o.vertical!==!0&&e.lang.rtl===!0),T=Y(()=>qu===!1&&J.value===!0);$e(J,Pe),$e(()=>o.modelValue,F=>{k({name:F,setCurrent:!0,skipEmit:!0})}),$e(()=>o.outsideArrows,W);function k({name:F,setCurrent:z,skipEmit:re}){y.value!==F&&(re!==!0&&o["onUpdate:modelValue"]!==void 0&&n("update:modelValue",F),(z===!0||o["onUpdate:modelValue"]===void 0)&&(j(y.value,F),y.value=F))}function W(){t(()=>{f.value&&ne({width:f.value.offsetWidth,height:f.value.offsetHeight})})}function ne(F){if(U.value===void 0||g.value===null)return;const z=F[U.value.container],re=Math.min(g.value[U.value.scroll],Array.prototype.reduce.call(g.value.children,(Se,ge)=>Se+(ge[U.value.content]||0),0)),xe=z>0&&re>z;_.value=xe,xe===!0&&r(Pe),b.value=z<parseInt(o.breakpoint,10)}function j(F,z){const re=F!=null&&F!==""?m.find(Se=>Se.name.value===F):null,xe=z!=null&&z!==""?m.find(Se=>Se.name.value===z):null;if(ln===!0)ln=!1;else if(re&&xe){const Se=re.tabIndicatorRef.value,ge=xe.tabIndicatorRef.value;O!==null&&(clearTimeout(O),O=null),Se.style.transition="none",Se.style.transform="none",ge.style.transition="none",ge.style.transform="none";const ve=Se.getBoundingClientRect(),Ne=ge.getBoundingClientRect();ge.style.transform=o.vertical===!0?`translate3d(0,${ve.top-Ne.top}px,0) scale3d(1,${Ne.height?ve.height/Ne.height:1},1)`:`translate3d(${ve.left-Ne.left}px,0,0) scale3d(${Ne.width?ve.width/Ne.width:1},1,1)`,s(()=>{O=setTimeout(()=>{O=null,ge.style.transition="transform .25s cubic-bezier(.4, 0, .2, 1)",ge.style.transform="none"},70)})}xe&&_.value===!0&&ie(xe.rootRef.value)}function ie(F){const{left:z,width:re,top:xe,height:Se}=g.value.getBoundingClientRect(),ge=F.getBoundingClientRect();let ve=o.vertical===!0?ge.top-xe:ge.left-z;if(ve<0){g.value[o.vertical===!0?"scrollTop":"scrollLeft"]+=Math.floor(ve),Pe();return}ve+=o.vertical===!0?ge.height-Se:ge.width-re,ve>0&&(g.value[o.vertical===!0?"scrollTop":"scrollLeft"]+=Math.ceil(ve),Pe())}function Pe(){const F=g.value;if(F===null)return;const z=F.getBoundingClientRect(),re=o.vertical===!0?F.scrollTop:Math.abs(F.scrollLeft);J.value===!0?(p.value=Math.ceil(re+z.width)<F.scrollWidth-1,C.value=re>0):(p.value=re>0,C.value=o.vertical===!0?Math.ceil(re+z.height)<F.scrollHeight:Math.ceil(re+z.width)<F.scrollWidth)}function we(F){I!==null&&clearInterval(I),I=setInterval(()=>{on(F)===!0&&Fe()},5)}function bt(){we(T.value===!0?Number.MAX_SAFE_INTEGER:0)}function Ee(){we(T.value===!0?0:Number.MAX_SAFE_INTEGER)}function Fe(){I!==null&&(clearInterval(I),I=null)}function nt(F,z){const re=Array.prototype.filter.call(g.value.children,Ne=>Ne===z||Ne.matches&&Ne.matches(".q-tab.q-focusable")===!0),xe=re.length;if(xe===0)return;if(F===36)return ie(re[0]),re[0].focus(),!0;if(F===35)return ie(re[xe-1]),re[xe-1].focus(),!0;const Se=F===(o.vertical===!0?38:37),ge=F===(o.vertical===!0?40:39),ve=Se===!0?-1:ge===!0?1:void 0;if(ve!==void 0){const Ne=J.value===!0?-1:1,ct=re.indexOf(z)+ve*Ne;return ct>=0&&ct<xe&&(ie(re[ct]),re[ct].focus({preventScroll:!0})),!0}}const Tn=Y(()=>T.value===!0?{get:F=>Math.abs(F.scrollLeft),set:(F,z)=>{F.scrollLeft=-z}}:o.vertical===!0?{get:F=>F.scrollTop,set:(F,z)=>{F.scrollTop=z}}:{get:F=>F.scrollLeft,set:(F,z)=>{F.scrollLeft=z}});function on(F){const z=g.value,{get:re,set:xe}=Tn.value;let Se=!1,ge=re(z);const ve=F<ge?-1:1;return ge+=ve*5,ge<0?(Se=!0,ge=0):(ve===-1&&ge<=F||ve===1&&ge>=F)&&(Se=!0,ge=F),xe(z,ge),Pe(),Se}function N(F,z){for(const re in F)if(F[re]!==z[re])return!1;return!0}function D(){let F=null,z={matchedLen:0,queryDiff:9999,hrefLen:0};const re=m.filter(ve=>{var Ne;return((Ne=ve.routeData)==null?void 0:Ne.hasRouterLink.value)===!0}),{hash:xe,query:Se}=i.$route,ge=Object.keys(Se).length;for(const ve of re){const Ne=ve.routeData.exact.value===!0;if(ve.routeData[Ne===!0?"linkIsExactActive":"linkIsActive"].value!==!0)continue;const{hash:ct,query:An,matched:wn,href:Dn}=ve.routeData.resolvedLink.value,dt=Object.keys(An).length;if(Ne===!0){if(ct!==xe||dt!==ge||N(Se,An)===!1)continue;F=ve.name.value;break}if(ct!==""&&ct!==xe||dt!==0&&N(An,Se)===!1)continue;const it={matchedLen:wn.length,queryDiff:ge-dt,hrefLen:Dn.length-ct.length};if(it.matchedLen>z.matchedLen){F=ve.name.value,z=it;continue}else if(it.matchedLen!==z.matchedLen)continue;if(it.queryDiff<z.queryDiff)F=ve.name.value,z=it;else if(it.queryDiff!==z.queryDiff)continue;it.hrefLen>z.hrefLen&&(F=ve.name.value,z=it)}if(F===null&&m.some(ve=>ve.routeData===void 0&&ve.name.value===y.value)===!0){ln=!1;return}k({name:F,setCurrent:!0})}function M(F){if(u(),w.value!==!0&&f.value!==null&&F.target&&typeof F.target.closest=="function"){const z=F.target.closest(".q-tab");z&&f.value.contains(z)===!0&&(w.value=!0,_.value===!0&&ie(z))}}function Ae(){l(()=>{w.value=!1},30)}function fe(){an.avoidRouteWatcher===!1?d(D):h()}function Pn(){if(A===void 0){const F=$e(()=>i.$route.fullPath,fe);A=()=>{F(),A=void 0}}}function di(F){m.push(F),S.value++,W(),F.routeData===void 0||i.$route===void 0?d(()=>{if(_.value===!0){const z=y.value,re=z!=null&&z!==""?m.find(xe=>xe.name.value===z):null;re&&ie(re.rootRef.value)}}):(Pn(),F.routeData.hasRouterLink.value===!0&&fe())}function Yt(F){m.splice(m.indexOf(F),1),S.value--,W(),A!==void 0&&F.routeData!==void 0&&(m.every(z=>z.routeData===void 0)===!0&&A(),fe())}const an={currentModel:y,tabProps:V,hasFocus:w,hasActiveTab:B,registerTab:di,unregisterTab:Yt,verifyRouteModel:fe,updateModel:k,onKbdNavigate:nt,avoidRouteWatcher:!1};ku(Js,an);function sn(){O!==null&&clearTimeout(O),Fe(),A==null||A()}let hi,ln;return Gr(sn),xu(()=>{hi=A!==void 0,sn()}),Su(()=>{hi===!0&&(Pn(),ln=!0,fe()),W()}),()=>le("div",{ref:f,class:R.value,role:"tablist",onFocusin:M,onFocusout:Ae},[le(Tu,{onResize:ne}),le("div",{ref:g,class:he.value,onScroll:Pe},li(a.default)),le(Ge,{class:"q-tabs__arrow q-tabs__arrow--left absolute q-tab__icon"+(p.value===!0?"":" q-tabs__arrow--faded"),name:o.leftIcon||e.iconSet.tabs[o.vertical===!0?"up":"left"],onMousedownPassive:bt,onTouchstartPassive:bt,onMouseupPassive:Fe,onMouseleavePassive:Fe,onTouchendPassive:Fe}),le(Ge,{class:"q-tabs__arrow q-tabs__arrow--right absolute q-tab__icon"+(C.value===!0?"":" q-tabs__arrow--faded"),name:o.rightIcon||e.iconSet.tabs[o.vertical===!0?"down":"right"],onMousedownPassive:Ee,onTouchstartPassive:Ee,onMouseupPassive:Fe,onMouseleavePassive:Fe,onTouchendPassive:Fe})])}});function xp(o){const a=[.06,6,50];return typeof o=="string"&&o.length&&o.split(":").forEach((n,i)=>{const e=parseFloat(n);e&&(a[i]=e)}),a}var Sp=Pu({name:"touch-swipe",beforeMount(o,{value:a,arg:n,modifiers:i}){if(i.mouse!==!0&&pi.has.touch!==!0)return;const e=i.mouseCapture===!0?"Capture":"",t={handler:a,sensitivity:xp(n),direction:Oa(i),noop:Au,mouseStart(r){Ma(r,t)&&wu(r)&&(Qi(t,"temp",[[document,"mousemove","move",`notPassive${e}`],[document,"mouseup","end","notPassiveCapture"]]),t.start(r,!0))},touchStart(r){if(Ma(r,t)){const s=r.target;Qi(t,"temp",[[s,"touchmove","move","notPassiveCapture"],[s,"touchcancel","end","notPassiveCapture"],[s,"touchend","end","notPassiveCapture"]]),t.start(r)}},start(r,s){pi.is.firefox===!0&&Jr(o,!0);const l=wa(r);t.event={x:l.left,y:l.top,time:Date.now(),mouse:s===!0,dir:!1}},move(r){if(t.event===void 0)return;if(t.event.dir!==!1){$n(r);return}const s=Date.now()-t.event.time;if(s===0)return;const l=wa(r),u=l.left-t.event.x,d=Math.abs(u),h=l.top-t.event.y,f=Math.abs(h);if(t.event.mouse!==!0){if(d<t.sensitivity[1]&&f<t.sensitivity[1]){t.end(r);return}}else if(window.getSelection().toString()!==""){t.end(r);return}else if(d<t.sensitivity[2]&&f<t.sensitivity[2])return;const g=d/s,y=f/s;t.direction.vertical===!0&&d<f&&d<100&&y>t.sensitivity[0]&&(t.event.dir=h<0?"up":"down"),t.direction.horizontal===!0&&d>f&&f<100&&g>t.sensitivity[0]&&(t.event.dir=u<0?"left":"right"),t.direction.up===!0&&d<f&&h<0&&d<100&&y>t.sensitivity[0]&&(t.event.dir="up"),t.direction.down===!0&&d<f&&h>0&&d<100&&y>t.sensitivity[0]&&(t.event.dir="down"),t.direction.left===!0&&d>f&&u<0&&f<100&&g>t.sensitivity[0]&&(t.event.dir="left"),t.direction.right===!0&&d>f&&u>0&&f<100&&g>t.sensitivity[0]&&(t.event.dir="right"),t.event.dir!==!1?($n(r),t.event.mouse===!0&&(document.body.classList.add("no-pointer-events--children"),document.body.classList.add("non-selectable"),Yu(),t.styleCleanup=_=>{t.styleCleanup=void 0,document.body.classList.remove("non-selectable");const p=()=>{document.body.classList.remove("no-pointer-events--children")};_===!0?setTimeout(p,50):p()}),t.handler({evt:r,touch:t.event.mouse!==!0,mouse:t.event.mouse,direction:t.event.dir,duration:s,distance:{x:d,y:f}})):t.end(r)},end(r){var s;t.event!==void 0&&(Zr(t,"temp"),pi.is.firefox===!0&&Jr(o,!1),(s=t.styleCleanup)==null||s.call(t,!0),r!==void 0&&t.event.dir!==!1&&$n(r),t.event=void 0)}};if(o.__qtouchswipe=t,i.mouse===!0){const r=i.mouseCapture===!0||i.mousecapture===!0?"Capture":"";Qi(t,"main",[[o,"mousedown","mouseStart",`passive${r}`]])}pi.has.touch===!0&&Qi(t,"main",[[o,"touchstart","touchStart",`passive${i.capture===!0?"Capture":""}`],[o,"touchmove","noop","notPassiveCapture"]])},updated(o,a){const n=o.__qtouchswipe;n!==void 0&&(a.oldValue!==a.value&&(typeof a.value!="function"&&n.end(),n.handler=a.value),n.direction=Oa(a.modifiers))},beforeUnmount(o){var n;const a=o.__qtouchswipe;a!==void 0&&(Zr(a,"main"),Zr(a,"temp"),pi.is.firefox===!0&&Jr(o,!1),(n=a.styleCleanup)==null||n.call(a),delete o.__qtouchswipe)}});function Tp(){let o=Object.create(null);return{getCache:(a,n)=>o[a]===void 0?o[a]=typeof n=="function"?n():n:o[a],setCache(a,n){o[a]=n},hasCache(a){return Object.hasOwnProperty.call(o,a)},clearCache(a){a!==void 0?delete o[a]:o=Object.create(null)}}}const Pp={name:{required:!0},disable:Boolean},$s={setup(o,{slots:a}){return()=>le("div",{class:"q-panel scroll",role:"tabpanel"},li(a.default))}},Ap={modelValue:{required:!0},animated:Boolean,infinite:Boolean,swipeable:Boolean,vertical:Boolean,transitionPrev:String,transitionNext:String,transitionDuration:{type:[String,Number],default:300},keepAlive:Boolean,keepAliveInclude:[String,Array,RegExp],keepAliveExclude:[String,Array,RegExp],keepAliveMax:Number},wp=["update:modelValue","beforeTransition","transition"];function Dp(){const{props:o,emit:a,proxy:n}=si(),{getCache:i}=Tp(),{registerTimeout:e}=vo();let t,r;const s=te(null),l={value:null};function u(U){const J=o.vertical===!0?"up":"left";A((n.$q.lang.rtl===!0?-1:1)*(U.direction===J?1:-1))}const d=Y(()=>[[Sp,u,void 0,{horizontal:o.vertical!==!0,vertical:o.vertical,mouse:!0}]]),h=Y(()=>o.transitionPrev||`slide-${o.vertical===!0?"down":"right"}`),f=Y(()=>o.transitionNext||`slide-${o.vertical===!0?"up":"left"}`),g=Y(()=>`--q-transition-duration: ${o.transitionDuration}ms`),y=Y(()=>typeof o.modelValue=="string"||typeof o.modelValue=="number"?o.modelValue:String(o.modelValue)),_=Y(()=>({include:o.keepAliveInclude,exclude:o.keepAliveExclude,max:o.keepAliveMax})),p=Y(()=>o.keepAliveInclude!==void 0||o.keepAliveExclude!==void 0);$e(()=>o.modelValue,(U,J)=>{const T=S(U)===!0?w(U):-1;r!==!0&&I(T===-1?0:T<w(J)?-1:1),l.value!==T&&(l.value=T,a("beforeTransition",U,J),e(()=>{a("transition",U,J)},o.transitionDuration))});function C(){A(1)}function b(){A(-1)}function m(U){a("update:modelValue",U)}function S(U){return U!=null&&U!==""}function w(U){return t.findIndex(J=>J.props.name===U&&J.props.disable!==""&&J.props.disable!==!0)}function O(){return t.filter(U=>U.props.disable!==""&&U.props.disable!==!0)}function I(U){const J=U!==0&&o.animated===!0&&l.value!==-1?"q-transition--"+(U===-1?h.value:f.value):null;s.value!==J&&(s.value=J)}function A(U,J=l.value){let T=J+U;for(;T!==-1&&T<t.length;){const k=t[T];if(k!==void 0&&k.props.disable!==""&&k.props.disable!==!0){I(U),r=!0,a("update:modelValue",k.props.name),setTimeout(()=>{r=!1});return}T+=U}o.infinite===!0&&t.length!==0&&J!==-1&&J!==t.length&&A(U,U===-1?t.length:-1)}function V(){const U=w(o.modelValue);return l.value!==U&&(l.value=U),!0}function B(){const U=S(o.modelValue)===!0&&V()&&t[l.value];return o.keepAlive===!0?[le(Ou,_.value,[le(p.value===!0?i(y.value,()=>({...$s,name:y.value})):$s,{key:y.value,style:g.value},()=>U)])]:[le("div",{class:"q-panel scroll",style:g.value,key:y.value,role:"tabpanel"},[U])]}function H(){if(t.length!==0)return o.animated===!0?[le(Ws,{name:s.value},B)]:B()}function R(U){return t=Du(li(U.default,[])).filter(J=>J.props!==null&&J.props.slot===void 0&&S(J.props.name)===!0),t.length}function he(){return t}return Object.assign(n,{next:C,previous:b,goTo:m}),{panelIndex:l,panelDirectives:d,updatePanelsList:R,updatePanelIndex:V,getPanelContent:H,getEnabledPanels:O,getPanels:he,isValidPanelName:S,keepAliveProps:_,needsUniqueKeepAliveWrapper:p,goToPanelByOffset:A,goToPanel:m,nextPanel:C,previousPanel:b}}var Hn=rn({name:"QTabPanel",props:Pp,setup(o,{slots:a}){return()=>le("div",{class:"q-tab-panel",role:"tabpanel"},li(a.default))}}),Xs=rn({name:"QTabPanels",props:{...Ap,...Go},emits:wp,setup(o,{slots:a}){const n=si(),i=Fo(o,n.proxy.$q),{updatePanelsList:e,getPanelContent:t,panelDirectives:r}=Dp(),s=Y(()=>"q-tab-panels q-panel-parent"+(i.value===!0?" q-tab-panels--dark q-dark":""));return()=>(e(a),Mu("div",{class:s.value},t(),"pan",o.swipeable,()=>r.value))}});const Op={class:"rest-api-container"},Mp={class:"request-section"},Ip={class:"row q-gutter-sm q-mb-sm"},Lp={class:"row items-center"},Np={key:0},Rp={key:1},Gp={key:2},Fp={key:3},jp={class:"row q-gutter-sm q-mt-sm"},Vp={key:0,class:"response-section q-mt-md"},Up={class:"response-status-bar q-mb-sm"},Bp={class:"row q-mb-sm"},Hp={class:"response-body-container"},qp={key:0,class:"response-body-pretty"},Yp={key:1,class:"response-body-raw"},zp={__name:"API",props:{nodeItemId:Number},setup(o){const a=o,n=jr(),i=zi(),e=["GET","POST","PUT","PATCH","DELETE","HEAD","OPTIONS"],t=["none","bearer","basic","apikey","oauth"],r={none:"No Auth",bearer:"Bearer Token",basic:"Basic Auth",apikey:"API Key",oauth:"OAuth 2.0"},s=["header","query"],l={header:"Header",query:"Query Parameter"},u=["Content-Type","Accept","Authorization","User-Agent","X-API-Key","X-Requested-With","Cache-Control","Accept-Language"],d=te(!1),h=te(null),f=te("body"),g=te(!0),y=te(!1),_=te({auth:!1,headers:!1,body:!1,queryParams:!1}),p=te({method:"GET",url:"",auth:{type:"none",bearerToken:"",username:"",password:"",apiKey:{key:"",value:"",location:"header"},oauthToken:""},headers:[],queryParams:[],body:{type:"json",content:""}}),C=te([]),b=te([]),m=Y(()=>i.node_items.find(N=>N.id===a.nodeItemId)),S=Y(()=>["POST","PUT","PATCH","DELETE"].includes(p.value.method)),w=Y(()=>{var N;if(!((N=h.value)!=null&&N.data))return"";try{return JSON.stringify(h.value.data,null,2)}catch{return h.value.data}}),O=Y(()=>{var N;return(N=h.value)!=null&&N.data?typeof h.value.data=="string"?h.value.data:JSON.stringify(h.value.data):""}),I=Y(()=>{const{data:N}=h.value||{};if(!N)return"";const{size:D}=new Blob([O.value]);return D<1024?`${D} B`:D<1024*1024?`${(D/1024).toFixed(2)} KB`:`${(D/(1024*1024)).toFixed(2)} MB`}),A=N=>({GET:"mdi-arrow-down-bold",POST:"mdi-arrow-up-bold",PUT:"mdi-pencil",PATCH:"mdi-pencil-outline",DELETE:"mdi-delete",HEAD:"mdi-head",OPTIONS:"mdi-cog"})[N]||"mdi-help",V=N=>({GET:"green",POST:"blue",PUT:"orange",PATCH:"purple",DELETE:"red",HEAD:"grey",OPTIONS:"grey"})[N]||"grey",B=N=>N?N>=200&&N<300?"positive":N>=300&&N<400?"warning":N>=400?"negative":"grey":"grey",H=()=>{p.value.headers.push({key:"",value:""})},R=N=>{p.value.headers.splice(N,1)},he=(N,D)=>{N.length>0&&(u.includes(N)||u.push(N)),D(N)},U=()=>{p.value.queryParams.push({key:"",value:""})},J=N=>{p.value.queryParams.splice(N,1)},T=()=>{C.value.push({key:"",value:""})},k=N=>{C.value.splice(N,1)},W=()=>{b.value.push({key:"",value:""})},ne=N=>{b.value.splice(N,1)},j=()=>{try{const N=JSON.parse(p.value.body.content);p.value.body.content=JSON.stringify(N,null,2),n.notify({type:"positive",message:"JSON formatted successfully"})}catch{n.notify({type:"negative",message:"Invalid JSON format"})}},ie=()=>{navigator.clipboard.writeText(p.value.url),n.notify({type:"positive",message:"URL copied to clipboard"})},Pe=()=>{navigator.clipboard.writeText(O.value),n.notify({type:"positive",message:"Response copied to clipboard"})},we=()=>{const N=g.value?w.value:O.value;navigator.clipboard.writeText(N),n.notify({type:"positive",message:"Response body copied to clipboard"})},bt=()=>{p.value={method:"GET",url:"",auth:{type:"none",bearerToken:"",username:"",password:"",apiKey:{key:"",value:"",location:"header"},oauthToken:""},headers:[],queryParams:[],body:{type:"json",content:""}},C.value=[],b.value=[],h.value=null},Ee=()=>{const N={method:p.value.method.toLowerCase(),url:p.value.url,headers:{}};if(p.value.headers.forEach(D=>{D.key&&D.value&&(N.headers[D.key]=D.value)}),p.value.auth.type==="bearer"&&p.value.auth.bearerToken)N.headers.Authorization=`Bearer ${p.value.auth.bearerToken}`;else if(p.value.auth.type==="basic"){if(p.value.auth.username&&p.value.auth.password){const D=btoa(`${p.value.auth.username}:${p.value.auth.password}`);N.headers.Authorization=`Basic ${D}`}}else if(p.value.auth.type==="apikey"){const{key:D,value:M,location:Ae}=p.value.auth.apiKey||{};D&&M&&(Ae==="header"?N.headers[D]=M:(N.params||(N.params={}),N.params[D]=M))}else p.value.auth.type==="oauth"&&p.value.auth.oauthToken&&(N.headers.Authorization=`Bearer ${p.value.auth.oauthToken}`);if(p.value.queryParams.length>0&&(N.params||(N.params={}),p.value.queryParams.forEach(D=>{D.key&&D.value&&(N.params[D.key]=D.value)})),S.value)if(p.value.body.type==="json"){N.headers["Content-Type"]="application/json";try{N.data=JSON.parse(p.value.body.content||"{}")}catch{N.data=p.value.body.content}}else if(p.value.body.type==="form-data"){const D=new FormData;C.value.forEach(M=>{M.key&&D.append(M.key,M.value)}),N.data=D,delete N.headers["Content-Type"]}else if(p.value.body.type==="urlencoded"){N.headers["Content-Type"]="application/x-www-form-urlencoded";const D=new URLSearchParams;b.value.forEach(M=>{M.key&&M.value&&D.append(M.key,M.value)}),N.data=D.toString()}else p.value.body.type==="raw"&&(N.headers["Content-Type"]="text/plain",N.data=p.value.body.content);return N},Fe=async()=>{if(!p.value.url){n.notify({type:"warning",message:"Please enter a URL"});return}d.value=!0,h.value=null;const N=Date.now();try{const D=Ee(),M=await Ru(D),fe=Date.now()-N;h.value={status:M.status,statusText:M.statusText,headers:M.headers,data:M.data,time:fe},n.notify({type:"positive",message:`Request successful (${h.value.status})`})}catch(D){const Ae=Date.now()-N;D.response?(h.value={status:D.response.status,statusText:D.response.statusText,headers:D.response.headers,data:D.response.data,time:Ae},n.notify({type:"negative",message:`Request failed (${D.response.status})`})):(h.value={status:0,statusText:"Network Error",headers:{},data:D.message,time:Ae},n.notify({type:"negative",message:"Network error occurred"}))}finally{d.value=!1}},nt=async()=>{var N;if(!((N=h.value)!=null&&N.data)){n.notify({type:"warning",message:"No response data to save"});return}try{const D={...p.value,response:h.value,formDataFields:C.value,urlEncodedFields:b.value};m.value.formData=D,await i.editNodeItemFormData(m.value),n.notify({type:"positive",message:"Response saved successfully"})}catch{n.notify({type:"negative",message:"Failed to save response"})}},Tn=async()=>{try{const N={...p.value,formDataFields:C.value,urlEncodedFields:b.value};m.value.formData=N,await i.editNodeItemFormData(m.value),n.notify({type:"positive",message:"Configuration saved successfully"})}catch{n.notify({type:"negative",message:"Failed to save configuration"})}},on=()=>{var N;if((N=m.value)!=null&&N.formData){const D=m.value.formData;D.method&&(p.value.method=D.method),D.url&&(p.value.url=D.url),D.auth&&(p.value.auth={...p.value.auth,...D.auth}),D.headers&&(p.value.headers=D.headers),D.queryParams&&(p.value.queryParams=D.queryParams),D.body&&(p.value.body={...p.value.body,...D.body}),D.formDataFields&&(C.value=D.formDataFields),D.urlEncodedFields&&(b.value=D.urlEncodedFields),D.response&&(h.value=D.response)}};return $e(()=>p.value.body.type,N=>{const D=p.value.headers.find(M=>M.key.toLowerCase()==="content-type");if(D)N==="json"?D.value="application/json":N==="urlencoded"?D.value="application/x-www-form-urlencoded":N==="raw"&&(D.value="text/plain");else if(S.value&&N!=="form-data"){H();const M=p.value.headers[p.value.headers.length-1];M.key="Content-Type",N==="json"?M.value="application/json":N==="urlencoded"?M.value="application/x-www-form-urlencoded":N==="raw"&&(M.value="text/plain")}}),ui(()=>{on()}),(N,D)=>(G(),ee("div",Op,[oe("div",Mp,[oe("div",Ip,[E(Ji,{modelValue:p.value.method,"onUpdate:modelValue":D[0]||(D[0]=M=>p.value.method=M),options:e,dense:"",filled:"",style:{"min-width":"120px"},class:"col-auto"},{option:P(M=>[E(Qe,Iu(Lu(M.itemProps)),{default:P(()=>[E(be,{avatar:""},{default:P(()=>[E(Ge,{name:A(M.opt),color:V(M.opt)},null,8,["name","color"])]),_:2},1024),E(be,null,{default:P(()=>[E(pe,null,{default:P(()=>[de(Ce(M.opt),1)]),_:2},1024)]),_:2},1024)]),_:2},1040)]),selected:P(()=>[oe("div",Lp,[E(Ge,{name:A(p.value.method),color:V(p.value.method),class:"q-mr-sm"},null,8,["name","color"]),oe("span",null,Ce(p.value.method),1)])]),_:1},8,["modelValue"]),E(Ve,{modelValue:p.value.url,"onUpdate:modelValue":D[1]||(D[1]=M=>p.value.url=M),placeholder:"https://api.example.com/endpoint",filled:"",dense:"",class:"col",rules:[M=>!!M||"URL is required"]},{append:P(()=>[E(ae,{flat:"",dense:"",round:"",icon:"content_copy",size:"sm",onClick:ie},{default:P(()=>[E(hr,null,{default:P(()=>D[21]||(D[21]=[de("Copy URL")])),_:1,__:[21]})]),_:1})]),_:1},8,["modelValue","rules"]),E(ae,{color:"primary",label:"Send",icon:"send",disable:!p.value.url||d.value,loading:d.value,onClick:Fe,unelevated:"",dense:""},null,8,["disable","loading"])]),E(wi,{modelValue:_.value.auth,"onUpdate:modelValue":D[10]||(D[10]=M=>_.value.auth=M),label:"Authentication",icon:"lock",class:"q-mb-sm"},{default:P(()=>[E(tt,{flat:"",bordered:""},{default:P(()=>[E(Ue,null,{default:P(()=>[E(Ji,{modelValue:p.value.auth.type,"onUpdate:modelValue":D[2]||(D[2]=M=>p.value.auth.type=M),options:t,"option-label":M=>r[M],label:"Auth Type",dense:"",filled:"",class:"q-mb-md"},null,8,["modelValue","option-label"]),p.value.auth.type==="bearer"?(G(),ee("div",Np,[E(Ve,{modelValue:p.value.auth.bearerToken,"onUpdate:modelValue":D[3]||(D[3]=M=>p.value.auth.bearerToken=M),label:"Bearer Token",type:"password",filled:"",dense:"",placeholder:"Enter bearer token"},null,8,["modelValue"])])):p.value.auth.type==="basic"?(G(),ee("div",Rp,[E(Ve,{modelValue:p.value.auth.username,"onUpdate:modelValue":D[4]||(D[4]=M=>p.value.auth.username=M),label:"Username",filled:"",dense:"",class:"q-mb-sm"},null,8,["modelValue"]),E(Ve,{modelValue:p.value.auth.password,"onUpdate:modelValue":D[5]||(D[5]=M=>p.value.auth.password=M),label:"Password",type:"password",filled:"",dense:""},null,8,["modelValue"])])):p.value.auth.type==="apikey"?(G(),ee("div",Gp,[E(Ve,{modelValue:p.value.auth.apiKey.key,"onUpdate:modelValue":D[6]||(D[6]=M=>p.value.auth.apiKey.key=M),label:"Key Name",filled:"",dense:"",class:"q-mb-sm",placeholder:"e.g., X-API-Key"},null,8,["modelValue"]),E(Ve,{modelValue:p.value.auth.apiKey.value,"onUpdate:modelValue":D[7]||(D[7]=M=>p.value.auth.apiKey.value=M),label:"Key Value",type:"password",filled:"",dense:"",class:"q-mb-sm"},null,8,["modelValue"]),E(Ji,{modelValue:p.value.auth.apiKey.location,"onUpdate:modelValue":D[8]||(D[8]=M=>p.value.auth.apiKey.location=M),options:s,"option-label":M=>l[M],label:"Location",dense:"",filled:""},null,8,["modelValue","option-label"])])):p.value.auth.type==="oauth"?(G(),ee("div",Fp,[E(Ve,{modelValue:p.value.auth.oauthToken,"onUpdate:modelValue":D[9]||(D[9]=M=>p.value.auth.oauthToken=M),label:"OAuth Token",type:"password",filled:"",dense:"",placeholder:"Enter OAuth token"},null,8,["modelValue"])])):ke("",!0)]),_:1})]),_:1})]),_:1},8,["modelValue"]),E(wi,{modelValue:_.value.headers,"onUpdate:modelValue":D[11]||(D[11]=M=>_.value.headers=M),label:"Headers",icon:"list",class:"q-mb-sm"},{default:P(()=>[E(tt,{flat:"",bordered:""},{default:P(()=>[E(Ue,null,{default:P(()=>[(G(!0),ee(mt,null,_t(p.value.headers,(M,Ae)=>(G(),ee("div",{key:Ae,class:"row q-gutter-sm q-mb-sm"},[E(Ji,{modelValue:M.key,"onUpdate:modelValue":fe=>M.key=fe,options:u,"use-input":"","fill-input":"","input-debounce":"0",label:"Header Name",dense:"",filled:"",class:"col",onNewValue:he},null,8,["modelValue","onUpdate:modelValue"]),E(Ve,{modelValue:M.value,"onUpdate:modelValue":fe=>M.value=fe,label:"Value",filled:"",dense:"",class:"col"},null,8,["modelValue","onUpdate:modelValue"]),E(ae,{flat:"",dense:"",round:"",icon:"delete",color:"negative",onClick:fe=>R(Ae)},null,8,["onClick"])]))),128)),E(ae,{label:"Add Header",icon:"add",color:"primary",outline:"",dense:"",onClick:H})]),_:1})]),_:1})]),_:1},8,["modelValue"]),p.value.method==="GET"||y.value?(G(),ye(wi,{key:0,modelValue:_.value.queryParams,"onUpdate:modelValue":D[12]||(D[12]=M=>_.value.queryParams=M),label:"Query Parameters",icon:"link",class:"q-mb-sm"},{default:P(()=>[E(tt,{flat:"",bordered:""},{default:P(()=>[E(Ue,null,{default:P(()=>[(G(!0),ee(mt,null,_t(p.value.queryParams,(M,Ae)=>(G(),ee("div",{key:Ae,class:"row q-gutter-sm q-mb-sm"},[E(Ve,{modelValue:M.key,"onUpdate:modelValue":fe=>M.key=fe,label:"Parameter Name",filled:"",dense:"",class:"col"},null,8,["modelValue","onUpdate:modelValue"]),E(Ve,{modelValue:M.value,"onUpdate:modelValue":fe=>M.value=fe,label:"Value",filled:"",dense:"",class:"col"},null,8,["modelValue","onUpdate:modelValue"]),E(ae,{flat:"",dense:"",round:"",icon:"delete",color:"negative",onClick:fe=>J(Ae)},null,8,["onClick"])]))),128)),E(ae,{label:"Add Parameter",icon:"add",color:"primary",outline:"",dense:"",onClick:U})]),_:1})]),_:1})]),_:1},8,["modelValue"])):ke("",!0),S.value?(G(),ye(wi,{key:1,modelValue:_.value.body,"onUpdate:modelValue":D[17]||(D[17]=M=>_.value.body=M),label:"Body",icon:"code",class:"q-mb-sm"},{default:P(()=>[E(tt,{flat:"",bordered:""},{default:P(()=>[E(Ue,null,{default:P(()=>[E(zs,{modelValue:p.value.body.type,"onUpdate:modelValue":D[13]||(D[13]=M=>p.value.body.type=M),dense:"",class:"text-grey","active-color":"primary","indicator-color":"primary",align:"justify","narrow-indicator":""},{default:P(()=>[E(Bn,{name:"json",label:"JSON"}),E(Bn,{name:"form-data",label:"Form Data"}),E(Bn,{name:"urlencoded",label:"x-www-form-urlencoded"}),E(Bn,{name:"raw",label:"Raw"})]),_:1},8,["modelValue"]),E(Ni),E(Xs,{modelValue:p.value.body.type,"onUpdate:modelValue":D[16]||(D[16]=M=>p.value.body.type=M),animated:""},{default:P(()=>[E(Hn,{name:"json"},{default:P(()=>[E(Ve,{modelValue:p.value.body.content,"onUpdate:modelValue":D[14]||(D[14]=M=>p.value.body.content=M),type:"textarea",filled:"",rows:"10",placeholder:'{"key": "value"}',class:"json-editor"},null,8,["modelValue"]),E(ae,{label:"Format JSON",icon:"code",color:"primary",outline:"",dense:"",class:"q-mt-sm",onClick:j})]),_:1}),E(Hn,{name:"form-data"},{default:P(()=>[(G(!0),ee(mt,null,_t(C.value,(M,Ae)=>(G(),ee("div",{key:Ae,class:"row q-gutter-sm q-mb-sm"},[E(Ve,{modelValue:M.key,"onUpdate:modelValue":fe=>M.key=fe,label:"Key",filled:"",dense:"",class:"col"},null,8,["modelValue","onUpdate:modelValue"]),E(Ve,{modelValue:M.value,"onUpdate:modelValue":fe=>M.value=fe,label:"Value",filled:"",dense:"",class:"col"},null,8,["modelValue","onUpdate:modelValue"]),E(ae,{flat:"",dense:"",round:"",icon:"delete",color:"negative",onClick:fe=>k(Ae)},null,8,["onClick"])]))),128)),E(ae,{label:"Add Field",icon:"add",color:"primary",outline:"",dense:"",onClick:T})]),_:1}),E(Hn,{name:"urlencoded"},{default:P(()=>[(G(!0),ee(mt,null,_t(b.value,(M,Ae)=>(G(),ee("div",{key:Ae,class:"row q-gutter-sm q-mb-sm"},[E(Ve,{modelValue:M.key,"onUpdate:modelValue":fe=>M.key=fe,label:"Key",filled:"",dense:"",class:"col"},null,8,["modelValue","onUpdate:modelValue"]),E(Ve,{modelValue:M.value,"onUpdate:modelValue":fe=>M.value=fe,label:"Value",filled:"",dense:"",class:"col"},null,8,["modelValue","onUpdate:modelValue"]),E(ae,{flat:"",dense:"",round:"",icon:"delete",color:"negative",onClick:fe=>ne(Ae)},null,8,["onClick"])]))),128)),E(ae,{label:"Add Field",icon:"add",color:"primary",outline:"",dense:"",onClick:W})]),_:1}),E(Hn,{name:"raw"},{default:P(()=>[E(Ve,{modelValue:p.value.body.content,"onUpdate:modelValue":D[15]||(D[15]=M=>p.value.body.content=M),type:"textarea",filled:"",rows:"10",placeholder:"Enter raw body content"},null,8,["modelValue"])]),_:1})]),_:1},8,["modelValue"])]),_:1})]),_:1})]),_:1},8,["modelValue"])):ke("",!0),oe("div",jp,[E(ae,{label:"Save Configuration",icon:"save",color:"positive",outline:"",dense:"",onClick:Tn}),E(ae,{label:"Clear",icon:"clear_all",color:"grey",outline:"",dense:"",onClick:bt})])]),h.value?(G(),ee("div",Vp,[E(Ni,{class:"q-mb-sm"}),D[22]||(D[22]=oe("div",{class:"text-h6 q-mb-sm"},"Response",-1)),oe("div",Up,[E(Vt,{color:B(h.value.status),"text-color":"white",label:`${h.value.status} ${h.value.statusText||""}`,dense:""},null,8,["color","label"]),h.value.time?(G(),ye(Vt,{key:0,color:"grey-8","text-color":"white",label:`${h.value.time}ms`,dense:"",icon:"schedule"},null,8,["label"])):ke("",!0),I.value?(G(),ye(Vt,{key:1,color:"grey-8","text-color":"white",label:I.value,dense:"",icon:"storage"},null,8,["label"])):ke("",!0),E(ai),E(ae,{flat:"",dense:"",icon:"content_copy",label:"Copy Response",onClick:Pe}),E(ae,{flat:"",dense:"",icon:"download",label:"Save Response",onClick:nt})]),E(zs,{modelValue:f.value,"onUpdate:modelValue":D[18]||(D[18]=M=>f.value=M),dense:"",class:"text-grey","active-color":"primary","indicator-color":"primary",align:"justify","narrow-indicator":""},{default:P(()=>[E(Bn,{name:"body",label:"Body"}),E(Bn,{name:"headers",label:"Headers"})]),_:1},8,["modelValue"]),E(Ni),E(Xs,{modelValue:f.value,"onUpdate:modelValue":D[20]||(D[20]=M=>f.value=M),animated:""},{default:P(()=>[E(Hn,{name:"body"},{default:P(()=>[oe("div",Bp,[E(Nu,{modelValue:g.value,"onUpdate:modelValue":D[19]||(D[19]=M=>g.value=M),label:"Pretty Print",color:"primary"},null,8,["modelValue"]),E(ai),E(ae,{flat:"",dense:"",icon:"content_copy",label:"Copy",onClick:we})]),oe("div",Hp,[g.value?(G(),ee("pre",qp,Ce(w.value),1)):(G(),ee("pre",Yp,Ce(O.value),1))])]),_:1}),E(Hn,{name:"headers"},{default:P(()=>[E(Ut,{dense:"",bordered:"",separator:"",dark:""},{default:P(()=>[(G(!0),ee(mt,null,_t(h.value.headers,(M,Ae)=>(G(),ye(Qe,{key:Ae},{default:P(()=>[E(be,null,{default:P(()=>[E(pe,{class:"text-weight-bold"},{default:P(()=>[de(Ce(Ae),1)]),_:2},1024),E(pe,{caption:""},{default:P(()=>[de(Ce(M),1)]),_:2},1024)]),_:2},1024)]),_:2},1024))),128))]),_:1})]),_:1})]),_:1},8,["modelValue"])])):ke("",!0)]))}};var $p=Vr(zp,[["__scopeId","data-v-1a34aad8"]]);const Xp={class:"text-h6"},Wp={__name:"NodeInfoDialog",props:{modelValue:Boolean,nodeItem:Object},emits:["update:modelValue"],setup(o){const a=o,n=te(!1),i={"Read JSON":yp,"Read CSV":Qv,"Read Excel":sp,API:$p},e=()=>i[a.nodeItem.original_name]||null;return(t,r)=>(G(),ye(Yi,{"model-value":o.modelValue,"onUpdate:modelValue":r[2]||(r[2]=s=>t.$emit("update:modelValue",s)),maximized:n.value,"transition-show":"slide-up","transition-hide":"slide-down"},{default:P(()=>[E(tt,{class:"bg-grey-9 text-white"},{default:P(()=>[E(Ev,{class:"bg-dark-page text-white"},{default:P(()=>[E(ai),E(ae,{dense:"",flat:"",icon:"minimize",onClick:r[0]||(r[0]=s=>n.value=!1),disable:!n.value},{default:P(()=>[n.value?(G(),ye(hr,{key:0,class:"bg-white text-primary"},{default:P(()=>r[3]||(r[3]=[de("Minimize")])),_:1,__:[3]})):ke("",!0)]),_:1},8,["disable"]),E(ae,{dense:"",flat:"",icon:"crop_square",onClick:r[1]||(r[1]=s=>n.value=!0),disable:n.value},{default:P(()=>[n.value?ke("",!0):(G(),ye(hr,{key:0,class:"bg-white text-primary"},{default:P(()=>r[4]||(r[4]=[de("Maximize")])),_:1,__:[4]}))]),_:1},8,["disable"]),Xe((G(),ye(ae,{dense:"",flat:"",icon:"close"},{default:P(()=>[E(hr,{class:"bg-white text-primary"},{default:P(()=>r[5]||(r[5]=[de("Close")])),_:1,__:[5]})]),_:1})),[[St]])]),_:1}),E(Ue,null,{default:P(()=>[oe("div",Xp,Ce(o.nodeItem.name),1)]),_:1}),(G(),ye(Gu(e()),{nodeItemId:o.nodeItem.id},null,8,["nodeItemId"]))]),_:1})]),_:1},8,["model-value","maximized"]))}};const Kp={class:"row"},Qp={class:"col-md-3"},Jp={key:0,class:"text-h4 text-weight-bold text-blue-grey-3 q-pa-md"},Zp=["id"],eg=["src"],tg={class:"node-title"},ng={class:"col-md-9"},ig=["id","onDblclick","onContextmenu"],rg=["src"],og={class:"node-title"},_g={__name:"NodeEditor",setup(o){const a=zi(),n=te(null),i=te(!1),e=te({}),t=te(!1),r=te({}),s=Fu(),l=ju(),u=Y(()=>{if(!l.params.id||!a.workflow_node_items)return null;const b=JSON.parse(l.params.id);return a.workflow_node_items.find(w=>w.id===b)||null});function d(b,m){const S=n.value;switch(m){case"sourceAnchor":S.addEndpoint(b,{anchors:"Right",source:!0});break;case"targetAnchor":S.addEndpoint(b,{anchor:"Left",target:!0});break;case"sourceTargetAnchor":S.addEndpoint(b,{anchors:"Right",source:!0}),S.addEndpoint(b,{anchor:"Left",target:!0});break;default:alert("Something is wrong with the node, please contact the dev team")}}ui(async()=>{await Da();const b=document.getElementById("canvas");b||s.push({name:"workflows"}),n.value=yv({container:b,endpoint:"Dot",connector:"Bezier",maxConnections:3,dragOptions:{containment:"parentEnclosed"},endpointStyle:{fill:"#ff9800"},paintStyle:{strokeWidth:3,stroke:"#ff9800"}}),n.value.setSuspendDrawing(!0),u.value.node_items.forEach(m=>{const S=document.getElementById(m.html_id);d(S,m.type)}),u.value.connections.forEach(m=>{const S=document.getElementById(m.sourceId),w=document.getElementById(m.targetId);n.value.connect({source:S,target:w,anchors:["Right","Left"]})}),n.value.setSuspendDrawing(!1,!0),n.value.bind(Tl,m=>{m.elements.forEach(S=>{const{id:w}=S,O=S.pos.x,I=S.pos.y,A=u.value.node_items.find(V=>V.html_id===w);A&&yn.patch(`thedataeditor/node_item/${A.id}/`,{style_object:{top:`${I}px`,left:`${O}px`}}).then(V=>{a.editNodeItem(V.data)}).catch(V=>{console.error("Error saving position:",V)})})}),n.value.bind(Wo,m=>{yn.post("thedataeditor/connection/",{workflow:JSON.parse(l.params.id),sourceId:m.sourceId,targetId:m.targetId}).then(S=>{a.addConnection(S.data)})}),n.value.bind(vl,m=>{const S=u.value.connections.find(w=>w.sourceId===m.sourceId&&w.targetId===m.targetId);S&&yn.delete(`thedataeditor/connection/${S.id}/`).then(()=>{a.deleteConnection(S)})})});function h(b){b.dataTransfer.setData("text/plain",b.target.id)}function f(b){b.preventDefault()}async function g(b){const m=b.dataTransfer.getData("text"),S=a.nodes.find(O=>O.html_id===m),w={node:S.id,original_name:S.name,original_id:S.html_id,name:S.name,html_id:S.html_id+new Date().getTime(),icon:S.icon,icon_url:S.icon_url,type:S.type,style_object:{left:`${b.offsetX-20}px`,top:`${b.offsetY-20}px`},formData:{},response_data:{},workflow:JSON.parse(l.params.id)};try{const I=(await yn.post("thedataeditor/node_item/",w)).data;a.addNodeItem(I),await Da();const A=document.getElementById(I.html_id);d(A,I.type)}catch(O){console.log(O)}}function y(b){r.value=b,t.value=!0}function _(b,m){e.value=m,i.value=!0}function p(b){console.log("Rename clicked:",b)}async function C(b){n.value.setSuspendDrawing(!0);const{connections:m}=u.value;m.filter(O=>O.sourceId===b.html_id||O.targetId===b.html_id).forEach(O=>a.deleteConnection(O));const w=document.getElementById(b.html_id);n.value.removeAllEndpoints(w),n.value.unmanage(w),await a.deleteNodeItem(b),n.value.setSuspendDrawing(!1,!0),i.value=!1}return(b,m)=>(G(),ye(Hu,null,{default:P(()=>[oe("div",Kp,[oe("div",Qp,[u.value&&u.value.name?(G(),ee("div",Jp,Ce(u.value.name),1)):ke("",!0),E(Ut,{bordered:"",class:"rounded-borders bg-dark flowchart-demo"},{default:P(()=>[(G(!0),ee(mt,null,_t(Vu(a).node_categories_chunk,(S,w)=>(G(),ye(wi,{group:"somegroup","default-opened":w===0,"expand-separator":"",icon:S.icon,label:S.name,"header-class":S.header_class,key:S.id},{default:P(()=>[E(tt,null,{default:P(()=>[E(Ue,null,{default:P(()=>[(G(!0),ee(mt,null,_t(S.chunk_nodes,(O,I)=>(G(),ee("div",{key:I,class:"row q-mb-lg"},[(G(!0),ee(mt,null,_t(O,A=>(G(),ee("div",{key:A.id,class:"col-3"},[A.show?(G(),ee("div",{key:0,id:A.html_id,class:"window jtk-node relative",draggable:"true",onDragstart:m[0]||(m[0]=V=>h(V))},[oe("img",{ondragstart:"event.preventDefault();",draggable:"false",class:"node-icon",src:A.icon_url},null,8,eg),oe("span",tg,Ce(A.name),1)],40,Zp)):ke("",!0)]))),128))]))),128))]),_:2},1024)]),_:2},1024)]),_:2},1032,["default-opened","icon","label","header-class"]))),128))]),_:1})]),oe("div",ng,[u.value&&u.value.node_items?(G(),ee("div",{key:0,onDragover:m[1]||(m[1]=S=>f(S)),onDrop:m[2]||(m[2]=S=>g(S)),class:"jtk-demo-canvas canvas-wide flowchart-demo jtk-surface jtk-surface-nopan",id:"canvas"},[(G(!0),ee(mt,null,_t(u.value.node_items,(S,w)=>(G(),ee("div",{class:"window jtk-node absolute",key:w,id:S.html_id,style:Uu(S.style_object),onDblclick:O=>y(S),onContextmenu:Bu(O=>_(O,S),["prevent"])},[oe("img",{class:"node-icon",src:S.icon_url},null,8,rg),oe("span",og,Ce(S.name),1)],44,ig))),128))],32)):ke("",!0)])]),E(_v,{modelValue:i.value,"onUpdate:modelValue":m[3]||(m[3]=S=>i.value=S),nodeItem:e.value,onRename:p,onDelete:C},null,8,["modelValue","nodeItem"]),E(Wp,{modelValue:t.value,"onUpdate:modelValue":m[4]||(m[4]=S=>t.value=S),nodeItem:r.value},null,8,["modelValue","nodeItem"])]),_:1}))}};export{_g as default};
