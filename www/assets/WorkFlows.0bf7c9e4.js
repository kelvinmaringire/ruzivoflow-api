import{p as O,m as A,v as R,x as M,u as j,aL as H,r as c,c as J,d as L,w as t,f as s,i as f,e,Q as i,aM as h,al as P,am as g,g as z,ad as _,aN as W,ai as x,ag as v,j as C,ak as q}from"./index.3ad0f8e6.js";import{Q as D}from"./QForm.4b895c81.js";import{Q as G,a as w}from"./QTable.207f71c0.js";import{Q as K}from"./QPage.91ac43b6.js";import{C as Q}from"./ClosePopup.003978df.js";import{u as X}from"./use-quasar.749933be.js";import"./format.6f47d0b2.js";import"./QChip.9737646e.js";import"./QItemLabel.3f3d169e.js";import"./position-engine.28c7bc30.js";import"./selection.dbcb2d4f.js";var Y=O({name:"QTr",props:{props:Object,noHover:Boolean},setup(u,{slots:b}){const m=A(()=>"q-tr"+(u.props===void 0||u.props.header===!0?"":" "+u.props.__trClass)+(u.noHover===!0?" q-tr--no-hover":""));return()=>{var n;return R("tr",{style:(n=u.props)==null?void 0:n.__trStyle,class:m.value},M(b.default))}}});const Z={class:"row"},ee={class:"col"},le={class:"row q-col-gutter-md q-px-md"},oe={class:"col-12 col-md-6"},te={class:"col-12 col-md-6"},ae={class:"q-mt-md q-px-md"},se={class:"q-mt-md"},ie={class:"text-body1"},ne={class:"text-h6"},re={class:"row q-col-gutter-md q-px-md"},de={class:"col-12"},ue={class:"col-12"},me={class:"text-negative text-weight-bolder"},he={__name:"WorkFlows",setup(u){const b=j(),m=H(),n=X(),r=c({name:"",description:""}),p=c(!1),V=c(!1),y=c(!1),k=c(!1),d=c({}),T=[{name:"name",align:"center",label:"NAME",field:"name",sortable:!0},{name:"view",align:"center",label:"VIEW"},{name:"edit",align:"center",label:"EDIT"},{name:"delete",align:"center",label:"DELETE"},{name:"editor",align:"center",label:"NODE EDITOR"}];function E(){r.value.name="",r.value.description=""}async function N(){if(!r.value.name)n.notify({type:"negative",message:"Workflow name is required.",position:"top"});else if(r.value.name.length>20)n.notify({type:"negative",message:"The workflow name must have less than 20 characters.",position:"top"});else if(r.value.description.length>200)n.notify({type:"negative",message:"The workflow description must have less than 200 characters.",position:"top"});else try{const a=r.value;a.user=b.userId,await m.createWorkflow(r.value),n.notify({type:"positive",message:"Workflow created",position:"top"}),r.value={name:"",description:""},p.value=!1}catch(a){a.response.data.detail&&n.notify({type:"negative",message:a.response.data.detail,position:"top"})}}function U(a){d.value=a,V.value=!0}function $(a){d.value=JSON.parse(JSON.stringify(a)),y.value=!0}async function B(){try{await m.editWorkflow(d.value),n.notify({type:"positive",message:"Workflow edited",position:"top"}),y.value=!1}catch(a){console.log(a),a.response.data.detail&&n.notify({type:"negative",message:a.response.data.detail,position:"top"})}}function F(a){d.value=a,k.value=!0}async function I(){try{await m.deleteWorkflow(d.value),n.notify({type:"positive",message:"Workflow delete",position:"top"}),k.value=!1}catch(a){console.log(a),a.response.data.detail&&n.notify({type:"negative",message:a.response.data.detail,position:"top"})}}return(a,l)=>(J(),L(K,{padding:""},{default:t(()=>[s("div",Z,[l[9]||(l[9]=s("div",{class:"col"},[s("div",{class:"text-h4"},"Workflows")],-1)),s("div",ee,[f(e(i,{round:"",color:"positive",icon:"add",class:"q-mx-sm",onClick:l[0]||(l[0]=o=>p.value=!0)},null,512),[[h,!p.value]]),f(e(i,{round:"",color:"warning",icon:"remove",class:"q-mx-sm",onClick:l[1]||(l[1]=o=>p.value=!1)},null,512),[[h,p.value]])])]),f(e(D,{class:"q-my-lg",onSubmit:P(N,["prevent"]),onReset:E},{default:t(()=>[s("div",le,[s("div",oe,[e(g,{modelValue:r.value.name,"onUpdate:modelValue":l[2]||(l[2]=o=>r.value.name=o),label:"Name",class:"q-pr-xl"},null,8,["modelValue"])]),s("div",te,[e(g,{modelValue:r.value.description,"onUpdate:modelValue":l[3]||(l[3]=o=>r.value.description=o),label:"Description"},null,8,["modelValue"])])]),s("div",ae,[e(i,{label:"Submit",type:"submit",color:"primary"}),e(i,{label:"Reset",type:"reset",color:"primary",flat:"",class:"q-ml-sm"})])]),_:1},512),[[h,p.value]]),s("div",se,[e(G,{rows:z(m).workflows,columns:T,"row-key":"id"},{body:t(o=>[e(Y,{props:o},{default:t(()=>[e(w,{key:"name",props:o},{default:t(()=>[s("div",ie,_(o.row.name),1)]),_:2},1032,["props"]),e(w,{key:"view",props:o},{default:t(()=>[e(i,{onClick:S=>U(o.row),color:"secondary",flat:"",icon:"visibility"},null,8,["onClick"])]),_:2},1032,["props"]),e(w,{key:"edit",props:o},{default:t(()=>[e(i,{onClick:S=>$(o.row),color:"accent",flat:"",icon:"edit"},null,8,["onClick"])]),_:2},1032,["props"]),e(w,{key:"delete",props:o},{default:t(()=>[e(i,{onClick:S=>F(o.row),color:"negative",flat:"",icon:"delete"},null,8,["onClick"])]),_:2},1032,["props"]),e(w,{key:"editor",props:o},{default:t(()=>[e(i,{to:{name:"editor",params:{id:o.row.id}},color:"primary",flat:"",icon:"insights"},null,8,["to"])]),_:2},1032,["props"])]),_:2},1032,["props"])]),_:1},8,["rows"])]),e(W,{modelValue:V.value,"onUpdate:modelValue":l[4]||(l[4]=o=>V.value=o),"backdrop-filter":"blur(4px) saturate(150%)"},{default:t(()=>[e(x,null,{default:t(()=>[e(v,null,{default:t(()=>[s("div",ne,_(d.value.name),1)]),_:1}),e(v,{class:"q-pt-none"},{default:t(()=>[C(_(d.value.description),1)]),_:1}),e(q,{align:"right"},{default:t(()=>[f(e(i,{flat:"",label:"Close",color:"primary"},null,512),[[Q]])]),_:1})]),_:1})]),_:1},8,["modelValue"]),e(W,{modelValue:y.value,"onUpdate:modelValue":l[7]||(l[7]=o=>y.value=o),"backdrop-filter":"blur(4px) saturate(150%)",persistent:""},{default:t(()=>[e(x,null,{default:t(()=>[e(v,null,{default:t(()=>l[10]||(l[10]=[s("div",{class:"text-h6"},"Edit Workflow",-1)])),_:1,__:[10]}),e(v,{class:"q-pt-none"},{default:t(()=>[e(D,null,{default:t(()=>[s("div",re,[s("div",de,[e(g,{modelValue:d.value.name,"onUpdate:modelValue":l[5]||(l[5]=o=>d.value.name=o),label:"Name",class:"q-pr-xl"},null,8,["modelValue"])]),s("div",ue,[e(g,{modelValue:d.value.description,"onUpdate:modelValue":l[6]||(l[6]=o=>d.value.description=o),label:"Description"},null,8,["modelValue"])])])]),_:1})]),_:1}),e(q,{align:"right"},{default:t(()=>[e(i,{label:"Submit",type:"submit",color:"primary",onClick:B}),f(e(i,{flat:"",label:"Close",color:"primary"},null,512),[[Q]])]),_:1})]),_:1})]),_:1},8,["modelValue"]),e(W,{modelValue:k.value,"onUpdate:modelValue":l[8]||(l[8]=o=>k.value=o),"backdrop-filter":"blur(4px) saturate(150%)"},{default:t(()=>[e(x,null,{default:t(()=>[e(v,null,{default:t(()=>l[11]||(l[11]=[s("div",{class:"text-h6"},"Delete Workflow",-1)])),_:1,__:[11]}),e(v,null,{default:t(()=>[l[12]||(l[12]=C(" Are you sure you want to delete the workflow ")),s("span",me,_(d.value.name),1),l[13]||(l[13]=C("? This will permanently remove all associated nodes, data, and connections. This action is irreversible. "))]),_:1,__:[12,13]}),e(q,{align:"right"},{default:t(()=>[e(i,{label:"Delete",color:"negative",onClick:I}),f(e(i,{flat:"",label:"Close",color:"primary"},null,512),[[Q]])]),_:1})]),_:1})]),_:1},8,["modelValue"])]),_:1}))}};export{he as default};
